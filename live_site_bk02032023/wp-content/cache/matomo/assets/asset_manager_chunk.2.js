/* Matomo Javascript - cb=7a26bdd40ee02faf5a4cf66292925825*/

(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["ScheduledReports"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["ScheduledReports"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,r){return function(e){var t={};function r(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(o,n,function(t){return e[t]}.bind(null,n));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="plugins/ScheduledReports/vue/dist/",r(r.s="fae3")}({"19dc":function(t,r){t.exports=e},"8bbf":function(e,r){e.exports=t},a5a2:function(e,t){e.exports=r},fae3:function(e,t,r){"use strict";if(r.r(t),r.d(t,"ReportParameters",(function(){return d})),r.d(t,"ManageScheduledReport",(function(){return ot})),"undefined"!==typeof window){var o=window.document.currentScript,n=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);n&&(r.p=n[1])}var l=r("8bbf"),i={key:0};
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function c(e,t,r,o,n,c){var a=Object(l["resolveComponent"])("Field");return e.report?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",i,[Object(l["createElementVNode"])("div",null,[Object(l["withDirectives"])(Object(l["createVNode"])(a,{uicontrol:"checkbox",name:"report_email_me",introduction:e.translate("ScheduledReports_SendReportTo"),"model-value":e.report.emailMe,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.$emit("change","emailMe",t)}),title:"".concat(e.translate("ScheduledReports_SentToMe")," (").concat(e.currentUserEmail,")")},null,8,["introduction","model-value","title"]),[[l["vShow"],"email"===e.report.type]])]),Object(l["createElementVNode"])("div",null,[Object(l["withDirectives"])(Object(l["createVNode"])(a,{uicontrol:"textarea","var-type":"array","model-value":e.report.additionalEmails,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.$emit("change","additionalEmails",t)}),title:e.translate("ScheduledReports_AlsoSendReportToTheseEmails")},null,8,["model-value","title"]),[[l["vShow"],"email"===e.report.type]])])])):Object(l["createCommentVNode"])("",!0)}var a=r("a5a2"),p=Object(l["defineComponent"])({props:{report:{type:Object,required:!0},reportType:{type:String,required:!0},defaultDisplayFormat:{type:Number,required:!0},defaultEmailMe:{type:Boolean,required:!0},defaultEvolutionGraph:{type:Boolean,required:!0},currentUserEmail:{type:String,required:!0}},emits:["change"],components:{Field:a["Field"]},setup:function(e){var t=window,r=t.resetReportParametersFunctions,o=t.updateReportParametersFunctions,n=t.getReportParametersFunctions;r[e.reportType]||(r[e.reportType]=function(t){t.displayFormat=e.defaultDisplayFormat,t.emailMe=e.defaultEmailMe,t.evolutionGraph=e.defaultEvolutionGraph,t.additionalEmails=[]}),o[e.reportType]||(o[e.reportType]=function(e){null!==e&&void 0!==e&&e.parameters&&["displayFormat","emailMe","evolutionGraph","additionalEmails"].forEach((function(t){t in e.parameters&&(e[t]=e.parameters[t])}))}),n[e.reportType]||(n[e.reportType]=function(e){return{displayFormat:e.displayFormat,emailMe:e.emailMe,evolutionGraph:e.evolutionGraph,additionalEmails:e.additionalEmails||[]}})}});p.render=c;var d=p,s={class:"emailReports",ref:"root"},u={ref:"reportSentSuccess"},m={ref:"reportUpdatedSuccess"},b=Object(l["createElementVNode"])("div",{id:"ajaxError",style:{display:"none"}},null,-1),O={id:"ajaxLoadingDiv",style:{display:"none"}},y={class:"loadingPiwik"},j=["alt"],h={class:"loadingSegment"},f=Object(l["createElementVNode"])("a",{id:"bottom"},null,-1);function v(e,t,r,o,n,i){var c=Object(l["resolveComponent"])("ListReports"),a=Object(l["resolveComponent"])("AddReport");return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",s,[Object(l["createElementVNode"])("div",u,null,512),Object(l["createElementVNode"])("div",m,null,512),Object(l["createElementVNode"])("div",null,[b,Object(l["createElementVNode"])("div",O,[Object(l["createElementVNode"])("div",y,[Object(l["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif",alt:e.translate("General_LoadingData")},null,8,j),Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("General_LoadingData")),1)]),Object(l["createElementVNode"])("div",h,Object(l["toDisplayString"])(e.translate("SegmentEditor_LoadingSegmentedDataMayTakeSomeTime")),1)]),Object(l["withDirectives"])(Object(l["createVNode"])(c,{"content-title":e.contentTitle,"user-login":e.userLogin,"login-module":e.loginModule,reports:e.reports,"site-name":e.decodedSiteName,"segment-editor-activated":e.segmentEditorActivated,"saved-segments-by-id":e.savedSegmentsById,periods:e.periods,"report-types":e.reportTypes,"download-output-type":e.downloadOutputType,language:e.language,"report-formats-by-report-type":e.reportFormatsByReportType,onCreate:t[0]||(t[0]=function(t){return e.createReport()}),onEdit:t[1]||(t[1]=function(t){return e.editReport(t)}),onDelete:t[2]||(t[2]=function(t){return e.deleteReport(t)}),onSendnow:t[3]||(t[3]=function(t){return e.sendReportNow(t)})},null,8,["content-title","user-login","login-module","reports","site-name","segment-editor-activated","saved-segments-by-id","periods","report-types","download-output-type","language","report-formats-by-report-type"]),[[l["vShow"],e.showReportsList]]),e.showReportForm?(Object(l["openBlock"])(),Object(l["createBlock"])(a,{key:0,report:e.report,periods:e.periods,"param-periods":e.paramPeriods,"report-type-options":e.reportTypeOptions,"report-formats-by-report-type-options":e.reportFormatsByReportTypeOptions,"display-formats":e.displayFormats,"reports-by-category-by-report-type":e.reportsByCategoryByReportType,"allow-multiple-reports-by-report-type":e.allowMultipleReportsByReportType,"count-websites":e.countWebsites,"site-name":e.decodedSiteName,"selected-reports":e.selectedReports,"report-types":e.reportTypes,"segment-editor-activated":e.segmentEditorActivated,"saved-segments-by-id":e.savedSegmentsById,onToggleSelectedReport:t[4]||(t[4]=function(t){return e.toggleSelectedReport(t.reportType,t.uniqueId)}),onChange:t[5]||(t[5]=function(t){return e.onChangeProperty(t.prop,t.value)}),onSubmit:t[6]||(t[6]=function(t){return e.submitReport()})},{"report-parameters":Object(l["withCtx"])((function(){return[Object(l["renderSlot"])(e.$slots,"report-parameters")]})),_:3},8,["report","periods","param-periods","report-type-options","report-formats-by-report-type-options","display-formats","reports-by-category-by-report-type","allow-multiple-reports-by-report-type","count-websites","site-name","selected-reports","report-types","segment-editor-activated","saved-segments-by-id"])):Object(l["createCommentVNode"])("",!0),f])],512)}var g=r("19dc"),S=Object(l["createElementVNode"])("div",{class:"clear"},null,-1),R={key:0},E=["innerHTML"],N={id:"emailScheduleInlineHelp",class:"inline-help-node"},V=Object(l["createElementVNode"])("br",null,null,-1),k={id:"emailReportPeriodInlineHelp",class:"inline-help-node"},w=Object(l["createElementVNode"])("br",null,null,-1),_=Object(l["createElementVNode"])("br",null,null,-1),B={key:0,id:"reportHourHelpText",class:"inline-help-node"},T=["textContent"],C={ref:"reportParameters"},P={class:"email"},F={class:"report_evolution_graph"},D={class:"row evolution-graph-period"},x={class:"col s12"},M={for:"report_evolution_period_for_each"},q=["checked"],I=["innerHTML"],A={class:"col s12"},L={for:"report_evolution_period_for_prev"},H=["checked"],G=["value"],U={class:"row"},z={class:"col s12"},W={class:"reportCategory"},Z={class:"listReports"},K=["name","type","id","checked","onChange"],X={key:0,class:"entityInlineHelp"},J=Object(l["createElementVNode"])("br",null,null,-1),Q=["innerHTML"];function Y(e,t,r,o,n,i){var c=Object(l["resolveComponent"])("Field"),a=Object(l["resolveComponent"])("SaveButton"),p=Object(l["resolveComponent"])("ContentBlock"),d=Object(l["resolveDirective"])("form");return Object(l["openBlock"])(),Object(l["createBlock"])(p,{class:"entityAddContainer","content-title":e.translate("ScheduledReports_CreateAndScheduleReport")},{default:Object(l["withCtx"])((function(){return[S,Object(l["withDirectives"])(Object(l["createElementVNode"])("form",{id:"addEditReport",onSubmit:t[13]||(t[13]=function(t){return e.$emit("submit")})},[Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(c,{uicontrol:"text",name:"website",title:e.translate("General_Website"),disabled:!0,"model-value":e.siteName},null,8,["title","model-value"])]),Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(c,{uicontrol:"textarea",name:"report_description",title:e.translate("General_Description"),"model-value":e.report.description,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.$emit("change",{prop:"description",value:t})}),"inline-help":e.translate("ScheduledReports_DescriptionOnFirstPage")},null,8,["title","model-value","inline-help"])]),e.segmentEditorActivated?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",R,[Object(l["createVNode"])(c,{uicontrol:"select",name:"report_segment",title:e.translate("SegmentEditor_ChooseASegment"),"model-value":e.report.idsegment,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.$emit("change",{prop:"idsegment",value:t})}),options:e.savedSegmentsById},{"inline-help":Object(l["withCtx"])((function(){return[e.segmentEditorActivated?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",{key:0,id:"reportSegmentInlineHelp",class:"inline-help-node",innerHTML:e.$sanitize(e.reportSegmentInlineHelp)},null,8,E)):Object(l["createCommentVNode"])("",!0)]})),_:1},8,["title","model-value","options"])])):Object(l["createCommentVNode"])("",!0),Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(c,{uicontrol:"select",name:"report_schedule","model-value":e.report.period,"onUpdate:modelValue":t[2]||(t[2]=function(t){e.$emit("change",{prop:"period",value:t}),e.$emit("change",{prop:"periodParam",value:"never"===e.report.period?null:e.report.period})}),title:e.translate("ScheduledReports_EmailSchedule"),options:e.periods},{"inline-help":Object(l["withCtx"])((function(){return[Object(l["createElementVNode"])("div",N,[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.translate("ScheduledReports_WeeklyScheduleHelp"))+" ",1),V,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("ScheduledReports_MonthlyScheduleHelp")),1)])]})),_:1},8,["model-value","title","options"])]),Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(c,{uicontrol:"select",name:"report_period","model-value":e.report.periodParam,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.$emit("change",{prop:"periodParam",value:t})}),options:e.paramPeriods,title:e.translate("ScheduledReports_ReportPeriod")},{"inline-help":Object(l["withCtx"])((function(){return[Object(l["createElementVNode"])("div",k,[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.translate("ScheduledReports_ReportPeriodHelp"))+" ",1),w,_,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("ScheduledReports_ReportPeriodHelp2")),1)])]})),_:1},8,["model-value","options","title"])]),Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(c,{uicontrol:"select",name:"report_hour","model-value":e.report.hour,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.$emit("change",{prop:"hour",value:t})}),title:e.translate("ScheduledReports_ReportHour","X"),options:e.reportHours},{"inline-help":Object(l["withCtx"])((function(){return[0!==e.timezoneOffset&&"0"!==e.timezoneOffset?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",B,[Object(l["createElementVNode"])("span",{textContent:Object(l["toDisplayString"])(e.reportHourUtc)},null,8,T)])):Object(l["createCommentVNode"])("",!0)]})),_:1},8,["model-value","title","options"])]),Object(l["createElementVNode"])("div",null,[Object(l["createVNode"])(c,{uicontrol:"select",name:"report_type",disabled:1===e.reportTypes.length,"model-value":e.report.type,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.$emit("change",{prop:"type",value:t})}),title:e.translate("ScheduledReports_ReportType"),options:e.reportTypeOptions},null,8,["disabled","model-value","title","options"])]),(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e.reportFormatsByReportTypeOptions,(function(t,r){return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",{key:r},[Object(l["withDirectives"])(Object(l["createVNode"])(c,{uicontrol:"select",name:"report_format",title:e.translate("ScheduledReports_ReportFormat"),class:Object(l["normalizeClass"])(r),"model-value":e.report["format".concat(r)],"onUpdate:modelValue":function(t){return e.$emit("change",{prop:"format".concat(r),value:t})},options:t},null,8,["title","class","model-value","onUpdate:modelValue","options"]),[[l["vShow"],e.report.type===r]])])})),128)),Object(l["createElementVNode"])("div",C,[Object(l["renderSlot"])(e.$slots,"report-parameters")],512),Object(l["withDirectives"])(Object(l["createElementVNode"])("div",null,[Object(l["createElementVNode"])("div",P,[Object(l["createVNode"])(c,{uicontrol:"select",name:"display_format","model-value":e.report.displayFormat,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.$emit("change",{prop:"displayFormat",value:t})}),options:e.displayFormats,introduction:e.translate("ScheduledReports_AggregateReportsFormat")},null,8,["model-value","options","introduction"])]),Object(l["createElementVNode"])("div",F,[Object(l["withDirectives"])(Object(l["createVNode"])(c,{uicontrol:"checkbox",name:"report_evolution_graph",title:e.translate("ScheduledReports_EvolutionGraph",5),"model-value":e.report.evolutionGraph,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.$emit("change",{prop:"evolutionGraph",value:t})})},null,8,["title","model-value"]),[[l["vShow"],-1!==[2,"2",3,"3"].indexOf(e.report.displayFormat)]])]),Object(l["withDirectives"])(Object(l["createElementVNode"])("div",D,[Object(l["createElementVNode"])("div",x,[Object(l["createElementVNode"])("label",M,[Object(l["createElementVNode"])("input",{id:"report_evolution_period_for_each",name:"report_evolution_period_for",type:"radio",value:"each",checked:"each"===e.report.evolutionPeriodFor,onChange:t[8]||(t[8]=function(t){return e.$emit("change",{prop:"evolutionPeriodFor",value:t.target.value})})},null,40,q),Object(l["createElementVNode"])("span",{innerHTML:e.$sanitize(e.evolutionGraphsShowForEachInPeriod)},null,8,I)])]),Object(l["createElementVNode"])("div",A,[Object(l["createElementVNode"])("label",L,[Object(l["createElementVNode"])("input",{id:"report_evolution_period_for_prev",name:"report_evolution_period_for",type:"radio",value:"prev",checked:"prev"===e.report.evolutionPeriodFor,onChange:t[9]||(t[9]=function(t){return e.$emit("change",{prop:"evolutionPeriodFor",value:t.target.value})})},null,40,H),Object(l["createElementVNode"])("span",null,[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e.translate("ScheduledReports_EvolutionGraphsShowForPreviousN",e.frequencyPeriodPlural))+": ",1),Object(l["createElementVNode"])("input",{type:"number",name:"report_evolution_period_n",value:e.report.evolutionPeriodN,onKeydown:t[10]||(t[10]=function(t){return e.onEvolutionPeriodN(t)}),onChange:t[11]||(t[11]=function(t){return e.onEvolutionPeriodN(t)})},null,40,G)])])])],512),[[l["vShow"],-1!==[1,"1",2,"2",3,"3"].indexOf(e.report.displayFormat)]])],512),[[l["vShow"],"email"===e.report.type&&"csv"!==e.report.formatemail&&"tsv"!==e.report.formatemail]]),Object(l["createElementVNode"])("div",U,[Object(l["createElementVNode"])("h3",z,Object(l["toDisplayString"])(e.translate("ScheduledReports_ReportsIncluded")),1)]),(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e.reportsByCategoryByReportTypeInColumns,(function(t,r){return Object(l["withDirectives"])((Object(l["openBlock"])(),Object(l["createElementBlock"])("div",{name:"reportsList",class:Object(l["normalizeClass"])("row ".concat(r)),key:r},[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(t,(function(t,o){return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",{class:"col s12 m6",key:o},[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(t,(function(t,o){return Object(l["openBlock"])(),Object(l["createElementBlock"])("div",{key:o},[Object(l["createElementVNode"])("h3",W,Object(l["toDisplayString"])(o),1),Object(l["createElementVNode"])("ul",Z,[(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(t,(function(t){var o;return Object(l["openBlock"])(),Object(l["createElementBlock"])("li",{key:t.uniqueId},[Object(l["createElementVNode"])("label",null,[Object(l["createElementVNode"])("input",{name:"".concat(r,"Reports"),type:e.allowMultipleReportsByReportType[r]?"checkbox":"radio",id:"".concat(r).concat(t.uniqueId),checked:null===(o=e.selectedReports[r])||void 0===o?void 0:o[t.uniqueId],onChange:function(o){return e.$emit("toggleSelectedReport",{reportType:r,uniqueId:t.uniqueId})}},null,40,K),Object(l["createElementVNode"])("span",null,Object(l["toDisplayString"])(e.decode(t.name)),1),"MultiSites_getAll"===t.uniqueId?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",X,Object(l["toDisplayString"])(e.translate("ScheduledReports_ReportIncludeNWebsites",e.countWebsites)),1)):Object(l["createCommentVNode"])("",!0)])])})),128))]),J])})),128))])})),128))],2)),[[l["vShow"],e.report.type===r]])})),128)),Object(l["createVNode"])(a,{value:e.saveButtonTitle,onConfirm:t[12]||(t[12]=function(t){return e.$emit("submit")})},null,8,["value"]),Object(l["createElementVNode"])("div",{class:"entityCancel",innerHTML:e.$sanitize(e.entityCancelText)},null,8,Q)],544),[[d]])]})),_:3},8,["content-title"])}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function ee(e,t){return"".concat((24+parseFloat(e)+t)%24)}function te(e,t){return ie(e)||le(e,t)||oe(e,t)||re()}function re(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function oe(e,t){if(e){if("string"===typeof e)return ne(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ne(e,t):void 0}}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function le(e,t){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var o,n,l=[],i=!0,c=!1;try{for(r=r.call(e);!(i=(o=r.next()).done);i=!0)if(l.push(o.value),t&&l.length===t)break}catch(a){c=!0,n=a}finally{try{i||null==r["return"]||r["return"]()}finally{if(c)throw n}}return l}}function ie(e){if(Array.isArray(e))return e}var ce=Object(l["defineComponent"])({props:{report:{type:Object,required:!0},selectedReports:Object,paramPeriods:{type:Object,required:!0},reportTypeOptions:{type:Object,required:!0},reportFormatsByReportTypeOptions:{type:Object,required:!0},displayFormats:{type:Object,required:!0},reportsByCategoryByReportType:{type:Object,required:!0},allowMultipleReportsByReportType:{type:Object,required:!0},countWebsites:{type:Number,required:!0},siteName:{type:String,required:!0},reportTypes:{type:Object,required:!0},segmentEditorActivated:Boolean,savedSegmentsById:Object,periods:{type:Object,required:!0}},emits:["submit","change","toggleSelectedReport"],components:{ContentBlock:g["ContentBlock"],Field:a["Field"],SaveButton:a["SaveButton"]},directives:{Form:a["Form"]},created:function(){this.onEvolutionPeriodN=Object(g["debounce"])(this.onEvolutionPeriodN,50)},methods:{onEvolutionPeriodN:function(e){this.$emit("change",{prop:"evolutionPeriodN",value:e.target.value})},decode:function(e){return g["Matomo"].helper.htmlDecode(e)}},setup:function(e,t){var r=Object(l["ref"])(null),o=Object(l["reactive"])({report:Object.assign({},e.report)});return Object(l["watch"])((function(){return o.report}),(function(r){Object.keys(r).forEach((function(o){r[o]!==e.report[o]&&t.emit("change",{prop:o,value:r[o]})}))}),{deep:!0}),Object(l["watch"])((function(){return e.report}),(function(e){Object.assign(o.report,e),g["Matomo"].helper.getAngularDependency("$timeout")()}),{deep:!0}),Object(l["onMounted"])((function(){var e=r.value;g["Matomo"].helper.compileAngularComponents(e,{params:{manageScheduledReport:o}}),g["Matomo"].helper.compileVueEntryComponents(e,{report:o.report,onChange:function(e,r){t.emit("change",{prop:e,value:r})}})})),{reportParameters:r}},beforeUnmount:function(){var e=this.$refs.reportParameters;g["Matomo"].helper.destroyVueComponent(e)},computed:{reportsByCategoryByReportTypeInColumns:function(){var e=this.reportsByCategoryByReportType,t=Object.entries(e).map((function(e){var t=te(e,2),r=t[0],o=t[1],n=Math.floor((Object.keys(o).length+1)/2),l={},i={},c=l;return Object.entries(o).forEach((function(e){var t=te(e,2),r=t[0],o=t[1];c[r]=o,Object.keys(c).length>=n&&(c=i)})),[r,[l,i]]}));return Object.fromEntries(t)},entityCancelText:function(){return Object(g["translate"])("General_OrCancel",'<a class="entityCancelLink">',"</a>")},frequencyPeriodSingle:function(){if(!this.report||!this.report.period)return"";var e=window,t=e.ReportPlugin,r=t.periodTranslations[this.report.period];return r||(r=t.periodTranslations.day),r.single},frequencyPeriodPlural:function(){if(!this.report||!this.report.period)return"";var e=window,t=e.ReportPlugin,r=t.periodTranslations[this.report.period];return r||(r=t.periodTranslations.day),r.plural},evolutionGraphsShowForEachInPeriod:function(){return Object(g["translate"])("ScheduledReports_EvolutionGraphsShowForEachInPeriod","<strong>","</strong>",this.frequencyPeriodSingle)},reportSegmentInlineHelp:function(){return Object(g["translate"])("ScheduledReports_Segment_Help",'<a href="./" rel="noreferrer noopener" target="_blank">',"</a>",Object(g["translate"])("SegmentEditor_DefaultAllVisits"),Object(g["translate"])("SegmentEditor_AddNewSegment"))},timezoneOffset:function(){return g["Matomo"].timezoneOffset},timeZoneDifferenceInHours:function(){return g["Matomo"].timezoneOffset/3600},reportHours:function(){for(var e=[],t=0;t<24;t+=1)2*this.timeZoneDifferenceInHours%2!==0?e.push({key:"".concat(t,".5"),value:"".concat(t,":30")}):e.push({key:"".concat(t),value:"".concat(t)});return e},reportHourUtc:function(){var e=ee(this.report.hour,-this.timeZoneDifferenceInHours);return Object(g["translate"])("ScheduledReports_ReportHourWithUTC",[e])},saveButtonTitle:function(){var e=window,t=e.ReportPlugin,r=this.report.idreport>0;return r?t.updateReportString:t.createReportString}}});ce.render=Y;var ae=ce,pe={class:"first"},de={key:0},se={colspan:"7"},ue=Object(l["createElementVNode"])("br",null,null,-1),me=Object(l["createElementVNode"])("br",null,null,-1),be=Object(l["createTextVNode"])("â€º "),Oe=["href"],ye=Object(l["createElementVNode"])("br",null,null,-1),je=Object(l["createElementVNode"])("br",null,null,-1),he={key:1},fe={colspan:"7"},ve=Object(l["createElementVNode"])("br",null,null,-1),ge=Object(l["createElementVNode"])("br",null,null,-1),Se=Object(l["createElementVNode"])("br",null,null,-1),Re={class:"first"},Ee={key:0,class:"entityInlineHelp",style:{"font-size":"9pt"}},Ne={key:0},Ve={key:1},ke={key:0},we={key:0},_e=Object(l["createElementVNode"])("br",null,null,-1),Be=["onClick"],Te=["src"],Ce=["id","action"],Pe=["value"],Fe=Object(l["createElementVNode"])("input",{type:"hidden",name:"force_api_session",value:"1"},null,-1),De=["onClick","id"],xe=["src"],Me={style:{"text-align":"center","padding-top":"2px"}},qe=["onClick","title"],Ie=Object(l["createElementVNode"])("span",{class:"icon-edit"},null,-1),Ae=[Ie],Le={style:{"text-align":"center","padding-top":"2px"}},$e=["onClick","title"],He=Object(l["createElementVNode"])("span",{class:"icon-delete"},null,-1),Ge=[He],Ue={class:"tableActionBar"},ze=Object(l["createElementVNode"])("span",{class:"icon-add"},null,-1);function We(e,t,r,o,n,i){var c=Object(l["resolveComponent"])("ContentBlock"),a=Object(l["resolveDirective"])("content-table");return Object(l["openBlock"])(),Object(l["createBlock"])(c,{id:"entityEditContainer",class:"entityTableContainer","help-url":"https://matomo.org/docs/email-reports/",feature:"true","content-title":e.contentTitle},{default:Object(l["withCtx"])((function(){var r;return[Object(l["withDirectives"])(Object(l["createElementVNode"])("table",null,[Object(l["createElementVNode"])("thead",null,[Object(l["createElementVNode"])("tr",null,[Object(l["createElementVNode"])("th",pe,Object(l["toDisplayString"])(e.translate("General_Description")),1),Object(l["createElementVNode"])("th",null,Object(l["toDisplayString"])(e.translate("ScheduledReports_EmailSchedule")),1),Object(l["createElementVNode"])("th",null,Object(l["toDisplayString"])(e.translate("ScheduledReports_ReportFormat")),1),Object(l["createElementVNode"])("th",null,Object(l["toDisplayString"])(e.translate("ScheduledReports_SendReportTo")),1),Object(l["createElementVNode"])("th",null,Object(l["toDisplayString"])(e.translate("General_Download")),1),Object(l["createElementVNode"])("th",null,Object(l["toDisplayString"])(e.translate("General_Edit")),1),Object(l["createElementVNode"])("th",null,Object(l["toDisplayString"])(e.translate("General_Delete")),1)])]),Object(l["createElementVNode"])("tbody",null,["anonymous"===e.userLogin?(Object(l["openBlock"])(),Object(l["createElementBlock"])("tr",de,[Object(l["createElementVNode"])("td",se,[ue,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("ScheduledReports_MustBeLoggedIn"))+" ",1),me,be,Object(l["createElementVNode"])("a",{href:"index.php?module=".concat(e.loginModule)},Object(l["toDisplayString"])(e.translate("Login_LogIn")),9,Oe),ye,je])])):null!==(r=e.reports)&&void 0!==r&&r.length?Object(l["createCommentVNode"])("",!0):(Object(l["openBlock"])(),Object(l["createElementBlock"])("tr",he,[Object(l["createElementVNode"])("td",fe,[ve,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("ScheduledReports_ThereIsNoReportToManage",e.siteName))+". ",1),ge,Se])])),(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(e.decodedReports,(function(t){return Object(l["openBlock"])(),Object(l["createElementBlock"])("tr",{key:t.idreport},[Object(l["createElementVNode"])("td",Re,[Object(l["createTextVNode"])(Object(l["toDisplayString"])(t.description)+" ",1),e.segmentEditorActivated&&t.idsegment?(Object(l["openBlock"])(),Object(l["createElementBlock"])("div",Ee,[e.savedSegmentsById[t.idsegment]?(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",Ne,Object(l["toDisplayString"])(e.savedSegmentsById[t.idsegment]),1)):(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",Ve,Object(l["toDisplayString"])(e.translate("ScheduledReports_SegmentDeleted")),1))])):Object(l["createCommentVNode"])("",!0)]),Object(l["createElementVNode"])("td",null,Object(l["toDisplayString"])(e.periods[t.period]),1),Object(l["createElementVNode"])("td",null,[t.format?(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",ke,Object(l["toDisplayString"])(t.format.toUpperCase()),1)):Object(l["createCommentVNode"])("",!0)]),Object(l["createElementVNode"])("td",null,[0===t.recipients.length?(Object(l["openBlock"])(),Object(l["createElementBlock"])("span",we,Object(l["toDisplayString"])(e.translate("ScheduledReports_NoRecipients")),1)):Object(l["createCommentVNode"])("",!0),(Object(l["openBlock"])(!0),Object(l["createElementBlock"])(l["Fragment"],null,Object(l["renderList"])(t.recipients,(function(e,t){return Object(l["openBlock"])(),Object(l["createElementBlock"])("span",{key:t},[Object(l["createTextVNode"])(Object(l["toDisplayString"])(e)+" ",1),_e])})),128)),0!==t.recipients.length?(Object(l["openBlock"])(),Object(l["createElementBlock"])("a",{key:1,href:"#",name:"linkSendNow",class:"link_but withIcon",style:{"margin-top":"3px"},onClick:Object(l["withModifiers"])((function(r){return e.$emit("sendnow",t.idreport)}),["prevent"])},[Object(l["createElementVNode"])("img",{border:"0",src:e.reportTypes[t.type]},null,8,Te),Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("ScheduledReports_SendReportNow")),1)],8,Be)):Object(l["createCommentVNode"])("",!0)]),Object(l["createElementVNode"])("td",null,[Object(l["createElementVNode"])("form",{method:"POST",target:"_blank",id:"downloadReportForm_".concat(t.idreport),action:e.linkTo({module:"API",segment:null,method:"ScheduledReports.generateReport",idReport:t.idreport,outputType:e.downloadOutputType,language:e.language,format:-1!==["html","csv","tsv"].indexOf(t.format)?t.format:"original"})},[Object(l["createElementVNode"])("input",{type:"hidden",name:"token_auth",value:e.token_auth},null,8,Pe),Fe],8,Ce),Object(l["createElementVNode"])("a",{href:"",rel:"noreferrer noopener",name:"linkDownloadReport",class:"link_but withIcon",onClick:Object(l["withModifiers"])((function(r){return e.displayReport(t.idreport)}),["prevent"]),id:t.idreport},[Object(l["createElementVNode"])("img",{border:"0",width:16,height:16,src:e.reportFormatsByReportType[t.type][t.format]},null,8,xe),Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("General_Download")),1)],8,De)]),Object(l["createElementVNode"])("td",Me,[Object(l["createElementVNode"])("button",{class:"table-action",onClick:function(r){return e.$emit("edit",t.idreport)},title:e.translate("General_Edit")},Ae,8,qe)]),Object(l["createElementVNode"])("td",Le,[Object(l["createElementVNode"])("button",{class:"table-action",onClick:function(r){return e.$emit("delete",t.idreport)},title:e.translate("General_Delete")},Ge,8,$e)])])})),128))])],512),[[a]]),Object(l["createElementVNode"])("div",Ue,["anonymous"!==e.userLogin?(Object(l["openBlock"])(),Object(l["createElementBlock"])("button",{key:0,id:"add-report",onClick:t[0]||(t[0]=function(t){return e.$emit("create")})},[ze,Object(l["createTextVNode"])(" "+Object(l["toDisplayString"])(e.translate("ScheduledReports_CreateAndScheduleReport")),1)])):Object(l["createCommentVNode"])("",!0)])]})),_:1},8,["content-title"])}var Ze=Object(l["defineComponent"])({props:{contentTitle:{type:String,required:!0},userLogin:{type:String,required:!0},loginModule:{type:String,required:!0},reports:{type:Array,required:!0},siteName:{type:String,required:!0},segmentEditorActivated:Boolean,savedSegmentsById:Object,periods:{type:Object,required:!0},downloadOutputType:{type:Number,required:!0},language:{type:String,required:!0},reportFormatsByReportType:{type:Object,required:!0},reportTypes:{type:Object,required:!0}},components:{ContentBlock:g["ContentBlock"]},directives:{ContentTable:g["ContentTable"]},emits:["create","edit","delete","sendnow"],methods:{linkTo:function(e){return"?".concat(g["MatomoUrl"].stringify(Object.assign(Object.assign({},g["MatomoUrl"].urlParsed.value),e)))},displayReport:function(e){$("#downloadReportForm_".concat(e)).submit()}},computed:{token_auth:function(){return g["Matomo"].token_auth},decodedReports:function(){return this.reports.map((function(e){return Object.assign(Object.assign({},e),{},{description:g["Matomo"].helper.htmlDecode(e.description)})}))}}});Ze.render=We;var Ke=Ze;function Xe(){g["Matomo"].helper.lazyScrollTo(".emailReports",200)}function Je(e,t){var r;null!==(r=window.updateReportParametersFunctions)&&void 0!==r&&r[e]&&window.updateReportParametersFunctions[e](t)}function Qe(e,t){var r;null!==(r=window.resetReportParametersFunctions)&&void 0!==r&&r[e]&&window.resetReportParametersFunctions[e](t)}window.resetReportParametersFunctions=window.resetReportParametersFunctions||{},window.updateReportParametersFunctions=window.updateReportParametersFunctions||{},window.getReportParametersFunctions=window.getReportParametersFunctions||{};var Ye=window,et=Ye.$,tt=g["Matomo"].timezoneOffset/3600,rt=Object(l["defineComponent"])({props:{contentTitle:{type:String,required:!0},userLogin:{type:String,required:!0},loginModule:{type:String,required:!0},reports:{type:Array,required:!0},siteName:{type:String,required:!0},segmentEditorActivated:Boolean,savedSegmentsById:Object,periods:{type:Object,required:!0},downloadOutputType:{type:Number,required:!0},language:{type:String,required:!0},reportFormatsByReportType:{type:Object,required:!0},paramPeriods:{type:Object,required:!0},reportTypeOptions:{type:Object,required:!0},reportFormatsByReportTypeOptions:{type:Object,required:!0},displayFormats:{type:Object,required:!0},reportsByCategoryByReportType:{type:Object,required:!0},allowMultipleReportsByReportType:{type:Object,required:!0},countWebsites:{type:Number,required:!0},reportTypes:{type:Object,required:!0}},components:{AddReport:ae,ListReports:Ke},directives:{ContentTable:g["ContentTable"],Form:a["Form"]},mounted:function(){var e=this;et(this.$refs.root).on("click","a.entityCancelLink",(function(){e.showListOfReports()})),g["Matomo"].postEvent("ScheduledReports.ManageScheduledReport.mounted",{element:this.$refs.root})},unmounted:function(){g["Matomo"].postEvent("ScheduledReports.ManageScheduledReport.unmounted",{element:this.$refs.root})},data:function(){return{showReportsList:!0,report:{},selectedReports:{}}},methods:{sendReportNow:function(e){var t=this;Xe(),g["AjaxHelper"].post({method:"ScheduledReports.sendReport"},{idReport:e,force:!0}).then((function(){t.fadeInOutSuccessMessage(t.$refs.reportSentSuccess,Object(g["translate"])("ScheduledReports_ReportSent"),!1)}))},formSetEditReport:function(e){var t=this,r=window,o=r.ReportPlugin,n={idreport:e,type:o.defaultReportType,format:o.defaultReportFormat,description:"",period:o.defaultPeriod,hour:o.defaultHour,reports:[],idsegment:"",evolutionPeriodFor:"prev",evolutionPeriodN:o.defaultEvolutionPeriodN,periodParam:o.defaultPeriod};e>0?(n=o.reportList[e],Je(n.type,n)):Qe(n.type,n),n.hour=ee(n.hour,tt),this.selectedReports={},Object.values(n.reports).forEach((function(e){t.selectedReports[n.type]=t.selectedReports[n.type]||{},t.selectedReports[n.type][e]=!0})),n["format".concat(n.type)]=n.format,n.idsegment||(n.idsegment=""),this.report=n,this.report.description=g["Matomo"].helper.htmlDecode(n.description)},fadeInOutSuccessMessage:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];g["NotificationsStore"].show({message:t,placeat:e,context:"success",noclear:!0,type:"toast",style:{display:"inline-block",marginTop:"10px"},id:"scheduledReportSuccess"}),r&&g["Matomo"].helper.refreshAfter(2)},changedReportType:function(){Qe(this.report.type,this.report)},deleteReport:function(e){g["Matomo"].helper.modalConfirm("#confirm",{yes:function(){g["AjaxHelper"].post({method:"ScheduledReports.deleteReport"},{idReport:e},{redirectOnSuccess:!0})}})},showListOfReports:function(e){this.showReportsList=!0,g["Matomo"].helper.hideAjaxError(),("undefined"===typeof e||e)&&Xe()},createReport:function(){var e=this;this.showReportsList=!1,Object(l["nextTick"])((function(){e.formSetEditReport(0)}))},editReport:function(e){var t=this;this.showReportsList=!1,Object(l["nextTick"])((function(){t.formSetEditReport(e)}))},submitReport:function(){var e=this,t={idReport:this.report.idreport,description:this.report.description,idSegment:this.report.idsegment,reportType:this.report.type,reportFormat:this.report["format".concat(this.report.type)],periodParam:this.report.periodParam,evolutionPeriodFor:this.report.evolutionPeriodFor};"each"!==t.evolutionPeriodFor&&(t.evolutionPeriodN=this.report.evolutionPeriodN);var r=this.report.period,o=ee(this.report.hour,-tt),n=this.selectedReports[t.reportType]||{},l=Object.keys(n).filter((function(r){return e.selectedReports[t.reportType][r]}));l.length>0&&(t.reports=l);var i=window.getReportParametersFunctions[this.report.type](this.report);t.parameters=i;var c=this.report.idreport>0;return g["AjaxHelper"].post({method:c?"ScheduledReports.updateReport":"ScheduledReports.addReport",period:r,hour:o},t).then((function(){e.fadeInOutSuccessMessage(e.$refs.reportUpdatedSuccess,Object(g["translate"])("ScheduledReports_ReportUpdated"))})),!1},onChangeProperty:function(e,t){this.report[e]=t,"type"===e&&this.changedReportType()},toggleSelectedReport:function(e,t){this.selectedReports[e]=this.selectedReports[e]||{},this.selectedReports[e][t]=!this.selectedReports[e][t]}},computed:{showReportForm:function(){return!this.showReportsList},decodedSiteName:function(){return g["Matomo"].helper.htmlDecode(this.siteName)}}});rt.render=v;var ot=rt;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome")):"function"===typeof define&&define.amd?define(["CoreHome"],t):"object"===typeof exports?exports["Live"]=t(require("CoreHome")):e["Live"]=t(e["CoreHome"])})("undefined"!==typeof self?self:this,(function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/Live/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"LiveWidgetRefresh",(function(){return l})),"undefined"!==typeof window){var r=window.document.currentScript,i=r&&r.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);i&&(n.p=i[1])}var o=n("19dc"),u=window,f=u.$,l={mounted:function(e,t){setTimeout((function(){var n=o["MatomoUrl"].parsed.value.segment;f(e).find("#visitsLive").liveWidget({interval:t.value.liveRefreshAfterMs,onUpdate:function(){o["AjaxHelper"].fetch({module:"Live",action:"ajaxTotalVisitors",segment:n},{format:"html"}).then((function(t){f(e).find("#visitsTotal").replaceWith(t)}))},maxRows:10,fadeInSpeed:600,dataUrlParams:{module:"Live",action:"getLastVisitsStart",segment:n}})}))}};
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
function s(){return{restrict:"A",scope:{liveRefreshAfterMs:"@"},link:function(e,t){l.mounted(t[0],{instance:null,value:{liveRefreshAfterMs:parseInt(e.liveRefreshAfterMs,10)},oldValue:null,modifiers:{},dir:{}})}}}s.$inject=["piwik","$timeout"],window.angular.module("piwikApp").directive("piwikLiveWidgetRefresh",s)}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["SegmentEditor"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["SegmentEditor"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,n){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/SegmentEditor/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"8bbf":function(e,n){e.exports=t},a5a2:function(e,t){e.exports=n},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"SegmentGeneratorStore",(function(){return B})),n.d(t,"SegmentGenerator",(function(){return F})),"undefined"!==typeof window){var o=window.document.currentScript,i=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);i&&(n.p=i[1])}var a=n("8bbf"),r=n("19dc"),c={class:"segment-generator",ref:"root"},l={class:"segment-rows"},s={class:"segment-row"},d=["onClick"],u={href:"#",class:"segment-loading"},m={class:"segment-row-inputs valign-wrapper"},f={class:"segment-input metricListBlock valign-wrapper"},p={style:{width:"100%"}},g={class:"segment-input metricMatchBlock valign-wrapper"},v={style:{display:"inline-block"}},h={class:"segment-input metricValueBlock valign-wrapper"},O={class:"form-group row",style:{width:"100%"}},b={class:"input-field col s12"},j=Object(a["createElementVNode"])("span",{role:"status","aria-live":"polite",class:"ui-helper-hidden-accessible"},null,-1),S=Object(a["createElementVNode"])("div",{class:"clear"},null,-1),V={class:"segment-or"},y=["onClick"],C=["innerHTML"],w={class:"segment-and"},k=["innerHTML"];function A(e,t,n,o,i,r){var A=this,N=Object(a["resolveComponent"])("ActivityIndicator"),E=Object(a["resolveComponent"])("Field"),L=Object(a["resolveComponent"])("ValueInput");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",c,[Object(a["createVNode"])(N,{loading:e.isLoading},null,8,["loading"]),(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e.conditions,(function(t,n){return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{class:Object(a["normalizeClass"])("segmentRow".concat(n)),key:n},[Object(a["createElementVNode"])("div",l,[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(t.orConditions,(function(n,o){var i,r;return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{class:Object(a["normalizeClass"])("orCondId".concat(n.id)),key:o},[Object(a["createElementVNode"])("div",s,[Object(a["createElementVNode"])("a",{class:"segment-close",onClick:function(o){return e.removeOrCondition(t,n)}},null,8,d),Object(a["withDirectives"])(Object(a["createElementVNode"])("a",u,null,512),[[a["vShow"],e.conditionValuesLoading[n.id]]]),Object(a["createElementVNode"])("div",m,[Object(a["createElementVNode"])("div",f,[Object(a["createElementVNode"])("div",p,[Object(a["createVNode"])(E,{uicontrol:"expandable-select",name:"segments","model-value":n.segment,"onUpdate:modelValue":function(t){n.segment=t,e.updateAutocomplete(n),e.computeSegmentDefinition()},title:null===(i=e.segments[n.segment])||void 0===i?void 0:i.name,"full-width":!0,options:e.segmentList},null,8,["model-value","onUpdate:modelValue","title","options"])])]),Object(a["createElementVNode"])("div",g,[Object(a["createElementVNode"])("div",v,[Object(a["createVNode"])(E,{uicontrol:"select",name:"matchType","model-value":n.matches,"onUpdate:modelValue":function(t){n.matches=t,e.computeSegmentDefinition()},"full-width":!0,options:e.matches[null===(r=e.segments[n.segment])||void 0===r?void 0:r.type]},null,8,["model-value","onUpdate:modelValue","options"])])]),Object(a["createElementVNode"])("div",h,[Object(a["createElementVNode"])("div",O,[Object(a["createElementVNode"])("div",b,[j,Object(a["createVNode"])(L,{or:n,onUpdate:function(e){n.value=e,A.computeSegmentDefinition()}},null,8,["or","onUpdate"])])])]),S])]),Object(a["createElementVNode"])("div",V,Object(a["toDisplayString"])(e.translate("SegmentEditor_OperatorOR")),1)],2)})),128)),Object(a["createElementVNode"])("div",{class:"segment-add-or",onClick:function(n){return e.addNewOrCondition(t)}},[Object(a["createElementVNode"])("div",null,[Object(a["createElementVNode"])("a",{innerHTML:e.$sanitize(e.addNewOrConditionLinkText)},null,8,C)])],8,y)]),Object(a["createElementVNode"])("div",w,Object(a["toDisplayString"])(e.translate("SegmentEditor_OperatorAND")),1)],2)})),128)),Object(a["createElementVNode"])("div",{class:"segment-add-row initial",onClick:t[0]||(t[0]=function(t){return e.addNewAndCondition()})},[Object(a["createElementVNode"])("div",null,[Object(a["createElementVNode"])("a",{innerHTML:e.$sanitize(e.addNewAndConditionLinkText)},null,8,k)])])],512)}var N=n("a5a2");function E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _(e,t,n){return t&&L(e.prototype,t),n&&L(e,n),e}function D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var x=function(){function e(){var t=this;E(this,e),D(this,"privateState",Object(a["reactive"])({isLoading:!1,segments:[]})),D(this,"state",Object(a["computed"])((function(){return Object(a["readonly"])(t.privateState)}))),D(this,"loadSegmentsAbort",void 0),D(this,"loadSegmentsPromise",void 0),D(this,"fetchedSiteId",void 0)}return _(e,[{key:"loadSegments",value:function(e,t){var n=this;if(this.loadSegmentsAbort&&(this.loadSegmentsAbort.abort(),this.loadSegmentsAbort=void 0),this.privateState.isLoading=!0,this.fetchedSiteId!==e&&(this.loadSegmentsAbort=void 0,this.fetchedSiteId=e),!this.loadSegmentsPromise){var o=void 0,i=void 0;"all"!==e&&e?e&&(o=e,i=e):(o="all",i="all"),this.loadSegmentsAbort=new AbortController,this.loadSegmentsPromise=r["AjaxHelper"].fetch({method:"API.getSegmentsMetadata",filter_limit:"-1",_hideImplementationData:0,idSites:o,idSite:i})}return this.loadSegmentsPromise.then((function(e){return n.privateState.isLoading=!1,e&&(n.privateState.segments=t?e.filter((function(e){return e.sqlSegment&&e.sqlSegment.match(/log_visit\./)})):e),n.state.value.segments})).finally((function(){n.privateState.isLoading=!1}))}}]),e}(),B=new x,I=["placeholder","title","value"];function G(e,t,n,o,i,r){return Object(a["openBlock"])(),Object(a["createElementBlock"])("input",{placeholder:e.translate("General_Value"),type:"text",class:"autocomplete",title:e.translate("General_Value"),autocomplete:"off",value:e.or.value,onKeydown:t[0]||(t[0]=function(t){return e.onKeydownOrConditionValue(t)}),onChange:t[1]||(t[1]=function(t){return e.onKeydownOrConditionValue(t)})},null,40,I)}var P=Object(a["defineComponent"])({props:{or:Object},created:function(){this.onKeydownOrConditionValue=Object(r["debounce"])(this.onKeydownOrConditionValue,50)},emits:["update"],methods:{onKeydownOrConditionValue:function(e){this.$emit("update",e.target.value)}}});P.render=G;var $=P;function T(){return{metric:[{key:"==",value:Object(r["translate"])("General_OperationEquals")},{key:"!=",value:Object(r["translate"])("General_OperationNotEquals")},{key:"<=",value:Object(r["translate"])("General_OperationAtMost")},{key:">=",value:Object(r["translate"])("General_OperationAtLeast")},{key:"<",value:Object(r["translate"])("General_OperationLessThan")},{key:">",value:Object(r["translate"])("General_OperationGreaterThan")}],dimension:[{key:"==",value:Object(r["translate"])("General_OperationIs")},{key:"!=",value:Object(r["translate"])("General_OperationIsNot")},{key:"=@",value:Object(r["translate"])("General_OperationContains")},{key:"!@",value:Object(r["translate"])("General_OperationDoesNotContain")},{key:"=^",value:Object(r["translate"])("General_OperationStartsWith")},{key:"=$",value:Object(r["translate"])("General_OperationEndsWith")}]}}function q(){for(var e="",t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",n=1;n<=10;n+=1)e+=t.charAt(Math.floor(Math.random()*t.length));return e}function M(e){for(var t,n,o=["==","!=","<=",">=","=@","!@","<",">","=^","=$"],i={},a=e.length,r=!1,c=0;c<o.length;c+=1)t=o[c],n=e.indexOf(t),-1!==n&&n<a&&(a=n,1===t.length&&(r=!0));a<e.length&&(!0===r?(i.segment=e.slice(0,a),i.matches=e.slice(a,a+1),i.value=decodeURIComponent(e.slice(a+1))):(i.segment=e.slice(0,a),i.matches=e.slice(a,a+2),i.value=decodeURIComponent(e.slice(a+2))),'""'===i.value&&(i.value=""));try{i.value=decodeURIComponent(i.value)}catch(l){}return i}function U(e){return e?"".concat(e).replace(/(<([^>]+)>)/gi,""):e}var H=window,R=H.$,J=Object(a["defineComponent"])({props:{addInitialCondition:Boolean,visitSegmentsOnly:Boolean,idsite:{type:[String,Number],default:function(){return r["Matomo"].idSite}},modelValue:{type:String,default:""}},components:{ActivityIndicator:r["ActivityIndicator"],Field:N["Field"],ValueInput:$},data:function(){return{conditions:[],queriedSegments:[],matches:T(),conditionValuesLoading:{},segmentDefinition:""}},emits:["update:modelValue"],watch:{modelValue:function(e){e!==this.segmentDefinition&&this.setSegmentString(e)},conditions:{deep:!0,handler:function(){this.computeSegmentDefinition()}},segmentDefinition:function(e){e!==this.modelValue&&(this.setSegmentString(this.modelValue),this.$emit("update:modelValue",e))},idsite:function(e){this.reloadSegments(e,this.visitSegmentsOnly)}},created:function(){this.matches[""]=this.matches.dimension,this.setSegmentString(this.modelValue),this.segmentDefinition=this.modelValue,this.reloadSegments(this.idsite,this.visitSegmentsOnly)},methods:{reloadSegments:function(e,t){var n=this;B.loadSegments(e,t).then((function(e){n.queriedSegments=e.map((function(e){return Object.assign(Object.assign({},e),{},{category:e.category||"Others"})})),n.addInitialCondition&&0===n.conditions.length&&n.addNewAndCondition()}))},addAndCondition:function(e){this.conditions.push(e)},addNewOrCondition:function(e){var t={segment:this.firstSegment,matches:this.firstMatch,value:""};this.addOrCondition(e,t)},addOrCondition:function(e,t){var n=this;this.conditionValuesLoading[t.id]=!1,t.id=q(),e.orConditions.push(t),Object(a["nextTick"])((function(){n.updateAutocomplete(t)}))},updateAutocomplete:function(e){var t=this;this.conditionValuesLoading[e.id]=!0,R(".orCondId".concat(e.id," .metricValueBlock input"),this.$refs.root).autocomplete({source:[],minLength:0});var n=new AbortController,o=!1;r["AjaxHelper"].fetch({module:"API",format:"json",method:"API.getSuggestedValuesForSegment",segmentName:e.segment}).then((function(n){t.conditionValuesLoading[e.id]=!1,o=!0;var i=R(".orCondId".concat(e.id," .metricValueBlock input")).autocomplete({source:n,minLength:0,select:function(n,o){n.preventDefault(),e.value=o.item.value,t.computeSegmentDefinition(),t.$forceUpdate()}}).off("click").click((function(){R(i).autocomplete("search",e.value)}))})).catch((function(){o=!0,t.conditionValuesLoading[e.id]=!1,R(".orCondId".concat(e.id," .metricValueBlock input")).autocomplete({source:[],minLength:0}).autocomplete("search",e.value)})),setTimeout((function(){o||n.abort()}),2e4)},removeOrCondition:function(e,t){var n=e.orConditions.indexOf(t);if(n>-1&&e.orConditions.splice(n,1),0===e.orConditions.length){var o=this.conditions.indexOf(e);n>-1&&this.conditions.splice(o,1)}},setSegmentString:function(e){var t=this;if(this.conditions=[],e){var n=e.split(";").map((function(e){return e.split(",")}));this.conditions=n.map((function(e){var n={orConditions:[]};return e.forEach((function(e){var o=M(e);t.addOrCondition(n,o)})),n}))}},addNewAndCondition:function(){var e={orConditions:[]};return this.addAndCondition(e),this.addNewOrCondition(e),e},computeSegmentDefinition:function(){var e="";this.conditions.forEach((function(t){if(t.orConditions.length){var n="";t.orConditions.forEach((function(e){if(e.value||e.segment||e.matches){""!==n&&(n+=",");var t=encodeURIComponent(encodeURIComponent(e.value));n+="".concat(e.segment).concat(e.matches).concat(t)}})),""!==e&&(e+=";"),e+=n}})),this.segmentDefinition=e}},computed:{firstSegment:function(){return this.queriedSegments[0].segment},firstMatch:function(){var e=this.queriedSegments[0];return e?e.type&&this.matches[e.type]?this.matches[e.type][0].key:this.matches[""][0].key:null},segments:function(){var e={};return this.queriedSegments.forEach((function(t){e[t.segment]=t})),e},segmentList:function(){return this.queriedSegments.map((function(e){return{group:e.category,key:e.segment,value:e.name,tooltip:e.acceptedValues?U(e.acceptedValues):void 0}}))},addNewOrConditionLinkText:function(){return"+".concat(Object(r["translate"])("SegmentEditor_AddANDorORCondition","<span>".concat(Object(r["translate"])("SegmentEditor_OperatorOR"),"</span>")))},andConditionLabel:function(){return this.conditions.length?Object(r["translate"])("SegmentEditor_OperatorAND"):""},addNewAndConditionLinkText:function(){return"+".concat(Object(r["translate"])("SegmentEditor_AddANDorORCondition","<span>".concat(this.andConditionLabel,"</span>")))},isLoading:function(){return B.state.value.isLoading}}});J.render=A;var F=J;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */Object(r["createAngularJsAdapter"])({component:F,require:"?ngModel",scope:{segmentDefinition:{angularJsBind:"@",vue:"modelValue"},addInitialCondition:{angularJsBind:"=",transform:r["transformAngularJsBoolAttr"]},visitSegmentsOnly:{angularJsBind:"=",transform:r["transformAngularJsBoolAttr"]},idsite:{angularJsBind:"="}},directiveName:"piwikSegmentGenerator",$inject:["$timeout"],events:{"update:modelValue":function(e,t,n,o,i,a,r){var c=a?a.$viewValue:n.segmentDefinition;e!==c&&r((function(){a?(a.$setViewValue(e),a.$render()):n.segmentDefinition=e}))}},postCreate:function(e,t,n,o,i){n.scope().segmentGenerator={getSegmentString:function(){return e.modelValue}};var c=i;c?(c.$render=function(){Object(a["nextTick"])((function(){e.modelValue=Object(r["removeAngularJsSpecificProperties"])(c.$viewValue)}))},"undefined"!==typeof t.segmentDefinition?c.$setViewValue(t.segmentDefinition):c.$setViewValue(e.modelValue)):t.$watch("segmentDefinition",(function(t){t!==e.modelValue&&Object(a["nextTick"])((function(){e.modelValue=t}))}))}})}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin"),require("SegmentEditor")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin","SegmentEditor"],t):"object"===typeof exports?exports["PrivacyManager"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin"),require("SegmentEditor")):e["PrivacyManager"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"],e["SegmentEditor"])})("undefined"!==typeof self?self:this,(function(e,t,n,a){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/PrivacyManager/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"8bbf":function(e,n){e.exports=t},a5a2:function(e,t){e.exports=n},f06f:function(e,t){e.exports=a},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"ManageGdpr",(function(){return ne})),n.d(t,"AnonymizeIp",(function(){return pe})),n.d(t,"OptOutCustomizer",(function(){return _e})),n.d(t,"AnonymizeLogData",(function(){return vt})),n.d(t,"DoNotTrackPreference",(function(){return jt})),n.d(t,"ReportDeletionSettings",(function(){return Nt})),n.d(t,"DeleteOldLogs",(function(){return It})),n.d(t,"DeleteOldReports",(function(){return Wt})),n.d(t,"ScheduleReportDeletion",(function(){return mn})),"undefined"!==typeof window){var a=window.document.currentScript,o=a&&a.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);o&&(n.p=o[1])}var i=n("8bbf"),l={class:"manageGdpr"},r={class:"intro"},c=Object(i["createElementVNode"])("br",null,null,-1),s=Object(i["createElementVNode"])("br",null,null,-1),d=Object(i["createElementVNode"])("br",null,null,-1),u=Object(i["createElementVNode"])("br",null,null,-1),m=["innerHTML"],b={class:"form-group row"},p={class:"col s12 input-field"},g={for:"gdprsite",class:"siteSelectorLabel"},v={class:"sites_autocomplete"},h={class:"form-group row segmentFilterGroup"},O={class:"col s12"},j={style:{margin:"8px 0",display:"inline-block"}},f=Object(i["createElementVNode"])("br",null,null,-1),y=Object(i["createTextVNode"])(),V=Object(i["createElementVNode"])("br",null,null,-1),S=Object(i["createElementVNode"])("br",null,null,-1),D=Object(i["createElementVNode"])("br",null,null,-1),N={class:"checkInclude"},E={colspan:"8"},C=["title"],k={class:"checkInclude"},_=["title"],P={class:"visitId"},w={class:"visitorId"},M=["title","onClick"],A={class:"visitorIp"},z=["title","onClick"],I={class:"userId"},F=["title","onClick"],T=["title"],x=["src"],L=["title"],B=["src"],U=["title"],R=["src"],H=["title"],G=["src"],q=["onClick"],K=Object(i["createElementVNode"])("img",{src:"plugins/Live/images/visitorProfileLaunch.png",style:{"margin-right":"3.5px"}},null,-1),W={class:"ui-confirm",id:"confirmDeleteDataSubject",ref:"confirmDeleteDataSubject"},Y=["value"],J=["value"];function Q(e,t,n,a,o,$){var Q=Object(i["resolveComponent"])("SiteSelector"),X=Object(i["resolveComponent"])("SegmentGenerator"),Z=Object(i["resolveComponent"])("SaveButton"),ee=Object(i["resolveComponent"])("ContentBlock"),te=Object(i["resolveComponent"])("Field"),ne=Object(i["resolveDirective"])("content-table");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",l,[Object(i["createVNode"])(ee,{"content-title":e.translate("PrivacyManager_GdprTools")},{default:Object(i["withCtx"])((function(){return[Object(i["createElementVNode"])("div",r,[Object(i["createElementVNode"])("p",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("PrivacyManager_GdprToolsPageIntro1"))+" ",1),c,s,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("PrivacyManager_GdprToolsPageIntro2"))+" ",1),d]),Object(i["createElementVNode"])("ol",null,[Object(i["createElementVNode"])("li",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_GdprToolsPageIntroAccessRight")),1),Object(i["createElementVNode"])("li",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_GdprToolsPageIntroEraseRight")),1)]),Object(i["createElementVNode"])("p",null,[u,Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(e.overviewHintText)},null,8,m)])]),Object(i["createElementVNode"])("h3",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_SearchForDataSubject")),1),Object(i["createElementVNode"])("div",b,[Object(i["createElementVNode"])("div",p,[Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("label",g,Object(i["toDisplayString"])(e.translate("PrivacyManager_SelectWebsite")),1),Object(i["createElementVNode"])("div",v,[Object(i["createVNode"])(Q,{id:"gdprsite",modelValue:e.site,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.site=t}),"show-all-sites-item":!0,"switch-site-on-select":!1,"show-selected-site":!0},null,8,["modelValue"])])])])]),Object(i["createElementVNode"])("div",h,[Object(i["createElementVNode"])("div",O,[Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("label",j,Object(i["toDisplayString"])(e.translate("PrivacyManager_FindDataSubjectsBy")),1),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(X,{modelValue:e.segment_filter,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.segment_filter=t}),"visit-segments-only":!0,idsite:e.site.id},null,8,["modelValue","idsite"])])])])]),Object(i["createVNode"])(Z,{class:"findDataSubjects",value:e.translate("PrivacyManager_FindMatchingDataSubjects"),onConfirm:t[2]||(t[2]=function(t){return e.findDataSubjects()}),disabled:!e.segment_filter,saving:e.isLoading},null,8,["value","disabled","saving"])]})),_:1},8,["content-title"]),Object(i["withDirectives"])(Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_NoDataSubjectsFound")),1)],512),[[i["vShow"],!e.dataSubjects.length&&e.hasSearched]]),Object(i["withDirectives"])(Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_MatchingDataSubjects")),1),Object(i["createElementVNode"])("p",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("PrivacyManager_VisitsMatchedCriteria"))+" "+Object(i["toDisplayString"])(e.translate("PrivacyManager_ExportingNote"))+" ",1),f,y,V,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("PrivacyManager_DeletionFromMatomoOnly"))+" ",1),S,D,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("PrivacyManager_ResultIncludesAllVisits")),1)]),Object(i["withDirectives"])(Object(i["createElementVNode"])("table",null,[Object(i["createElementVNode"])("thead",null,[Object(i["createElementVNode"])("tr",null,[Object(i["createElementVNode"])("th",N,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(te,{uicontrol:"checkbox",name:"activateAll","model-value":e.toggleAll,"onUpdate:modelValue":t[3]||(t[3]=function(t){e.toggleAll=t,e.toggleActivateAll()}),"full-width":!0},null,8,["model-value"])])]),Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("General_Website")),1),Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("General_VisitId")),1),Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("General_VisitorID")),1),Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("General_VisitorIP")),1),Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("General_UserId")),1),Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("General_Details")),1),Object(i["withDirectives"])(Object(i["createElementVNode"])("th",null,Object(i["toDisplayString"])(e.translate("General_Action")),513),[[i["vShow"],e.profileEnabled]])])]),Object(i["createElementVNode"])("tbody",null,[Object(i["withDirectives"])(Object(i["createElementVNode"])("tr",null,[Object(i["createElementVNode"])("td",E,Object(i["toDisplayString"])(e.translate("PrivacyManager_ResultTruncated","400")),1)],512),[[i["vShow"],e.dataSubjects.length>400]]),(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.dataSubjects,(function(t,n){return Object(i["openBlock"])(),Object(i["createElementBlock"])("tr",{title:"".concat(e.translate("PrivacyManager_LastAction"),": ").concat(t.lastActionDateTime),key:n},[Object(i["createElementVNode"])("td",k,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(te,{uicontrol:"checkbox",name:"subject".concat(t.idVisit),modelValue:e.dataSubjectsActive[n],"onUpdate:modelValue":function(t){return e.dataSubjectsActive[n]=t},"full-width":!0},null,8,["name","modelValue","onUpdate:modelValue"])])]),Object(i["createElementVNode"])("td",{class:"site",title:"(".concat(e.translate("General_Id")," ").concat(t.idSite,")")},Object(i["toDisplayString"])(t.siteName),9,_),Object(i["createElementVNode"])("td",P,Object(i["toDisplayString"])(t.idVisit),1),Object(i["createElementVNode"])("td",w,[Object(i["createElementVNode"])("a",{title:e.translate("PrivacyManager_AddVisitorIdToSearch"),onClick:function(n){return e.addFilter("visitorId",t.visitorId)}},Object(i["toDisplayString"])(t.visitorId),9,M)]),Object(i["createElementVNode"])("td",A,[Object(i["createElementVNode"])("a",{title:e.translate("PrivacyManager_AddVisitorIPToSearch"),onClick:function(n){return e.addFilter("visitIp",t.visitIp)}},Object(i["toDisplayString"])(t.visitIp),9,z)]),Object(i["createElementVNode"])("td",I,[Object(i["createElementVNode"])("a",{title:e.translate("PrivacyManager_AddUserIdToSearch"),onClick:function(n){return e.addFilter("userId",t.userId)}},Object(i["toDisplayString"])(t.userId),9,F)]),Object(i["createElementVNode"])("td",null,[Object(i["createElementVNode"])("span",{title:"".concat(t.deviceType," ").concat(t.deviceModel),style:{"margin-right":"3.5px"}},[Object(i["createElementVNode"])("img",{height:"16",src:t.deviceTypeIcon},null,8,x)],8,T),Object(i["createElementVNode"])("span",{title:t.operatingSystem,style:{"margin-right":"3.5px"}},[Object(i["createElementVNode"])("img",{height:"16",src:t.operatingSystemIcon},null,8,B)],8,L),Object(i["createElementVNode"])("span",{title:"".concat(t.browser," ").concat(t.browserFamilyDescription),style:{"margin-right":"3.5px"}},[Object(i["createElementVNode"])("img",{height:"16",src:t.browserIcon},null,8,R)],8,U),Object(i["createElementVNode"])("span",{title:"".concat(t.country," ").concat(t.region||"")},[Object(i["createElementVNode"])("img",{height:"16",src:t.countryFlag},null,8,G)],8,H)]),Object(i["withDirectives"])(Object(i["createElementVNode"])("td",null,[Object(i["createElementVNode"])("a",{class:"visitorLogTooltip",title:"View visitor profile",onClick:function(n){return e.showProfile(t.visitorId,t.idSite)}},[K,Object(i["createElementVNode"])("span",null,Object(i["toDisplayString"])(e.translate("Live_ViewVisitorProfile")),1)],8,q)],512),[[i["vShow"],e.profileEnabled]])],8,C)})),128))])],512),[[ne]]),Object(i["createVNode"])(Z,{class:"exportDataSubjects",style:{"margin-right":"3.5px"},onConfirm:t[4]||(t[4]=function(t){return e.exportDataSubject()}),disabled:!e.hasActiveDataSubjects,value:e.translate("PrivacyManager_ExportSelectedVisits")},null,8,["disabled","value"]),Object(i["createVNode"])(Z,{class:"deleteDataSubjects",onConfirm:t[5]||(t[5]=function(t){return e.deleteDataSubject()}),disabled:!e.hasActiveDataSubjects||e.isDeleting,value:e.translate("PrivacyManager_DeleteSelectedVisits")},null,8,["disabled","value"])],512),[[i["vShow"],e.dataSubjects.length]]),Object(i["createElementVNode"])("div",W,[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_DeleteVisitsConfirm")),1),Object(i["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,Y),Object(i["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,J)],512)])}var X=n("19dc"),Z=n("f06f"),ee=n("a5a2"),te=Object(i["defineComponent"])({components:{ContentBlock:X["ContentBlock"],SiteSelector:X["SiteSelector"],SegmentGenerator:Z["SegmentGenerator"],SaveButton:ee["SaveButton"],Field:ee["Field"]},directives:{ContentTable:X["ContentTable"]},data:function(){return{isLoading:!1,isDeleting:!1,site:{id:"all",name:Object(X["translate"])("UsersManager_AllWebsites")},segment_filter:"userId==",dataSubjects:[],toggleAll:!0,hasSearched:!1,profileEnabled:X["Matomo"].visitorProfileEnabled,dataSubjectsActive:[]}},setup:function(){var e=X["AjaxHelper"].fetch({method:"SitesManager.getSitesIdWithAdminAccess",filter_limit:"-1"});return{getSites:function(){return e}}},methods:{showSuccessNotification:function(e){var t=X["NotificationsStore"].show({message:e,context:"success",id:"manageGdpr",type:"transient"});setTimeout((function(){X["NotificationsStore"].scrollToNotification(t)}),200)},linkTo:function(e){return"?".concat(X["MatomoUrl"].stringify(Object.assign(Object.assign({},X["MatomoUrl"].urlParsed.value),{},{module:"PrivacyManager",action:e})))},toggleActivateAll:function(){this.dataSubjectsActive.fill(this.toggleAll)},showProfile:function(e,t){X["Matomo"].helper.showVisitorProfilePopup(e,t)},exportDataSubject:function(){var e=this,t=this.activatedDataSubjects;X["AjaxHelper"].post({module:"API",method:"PrivacyManager.exportDataSubjects",format:"json",filter_limit:-1},{visits:t}).then((function(t){e.showSuccessNotification(Object(X["translate"])("PrivacyManager_VisitsSuccessfullyExported")),X["Matomo"].helper.sendContentAsDownload("exported_data_subjects.json",JSON.stringify(t))}))},deleteDataSubject:function(){var e=this;X["Matomo"].helper.modalConfirm(this.$refs.confirmDeleteDataSubject,{yes:function(){e.isDeleting=!0;var t=e.activatedDataSubjects;X["AjaxHelper"].post({module:"API",method:"PrivacyManager.deleteDataSubjects",filter_limit:-1},{visits:t}).then((function(){e.dataSubjects=[],e.showSuccessNotification(Object(X["translate"])("PrivacyManager_VisitsSuccessfullyDeleted")),e.findDataSubjects()})).finally((function(){e.isDeleting=!1}))}})},addFilter:function(e,t){this.segment_filter+=",".concat(e,"==").concat(t),this.findDataSubjects()},findDataSubjects:function(){var e=this;this.dataSubjects=[],this.dataSubjectsActive=[],this.isLoading=!0,this.toggleAll=!0,this.hasSearched=!1,this.getSites().then((function(t){var n=e.site.id;"all"!==n||X["Matomo"].hasSuperUserAccess||(n=t,Array.isArray(t)&&(n=t.join(","))),X["AjaxHelper"].fetch({idSite:n,module:"API",method:"PrivacyManager.findDataSubjects",segment:e.segment_filter}).then((function(t){e.hasSearched=!0,e.dataSubjectsActive=t.map((function(){return!0})),e.dataSubjects=t})).finally((function(){e.isLoading=!1}))}))}},computed:{hasActiveDataSubjects:function(){return!!this.activatedDataSubjects.length},activatedDataSubjects:function(){var e=this;return this.dataSubjects.filter((function(t,n){return e.dataSubjectsActive[n]})).map((function(e){return{idsite:e.idSite,idvisit:e.idVisit}}))},overviewHintText:function(){return Object(X["translate"])("PrivacyManager_GdprToolsOverviewHint",'<a href="'.concat(this.linkTo("gdprOverview"),'">'),"</a>")}}});te.render=Q;var ne=te,ae=Object(i["createElementVNode"])("br",null,null,-1),oe=Object(i["createElementVNode"])("br",null,null,-1),ie=Object(i["createElementVNode"])("br",null,null,-1),le=Object(i["createElementVNode"])("br",null,null,-1),re={key:0},ce=Object(i["createElementVNode"])("br",null,null,-1),se=Object(i["createElementVNode"])("br",null,null,-1),de={class:"alert-warning alert"};function ue(e,t,n,a,o,l){var r=Object(i["resolveComponent"])("Field"),c=Object(i["resolveComponent"])("SaveButton"),s=Object(i["resolveDirective"])("form");return Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"anonymizeIpSettings",title:e.translate("PrivacyManager_UseAnonymizeIp"),modelValue:e.actualEnabled,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.actualEnabled=t}),"inline-help":e.anonymizeIpEnabledHelp},null,8,["title","modelValue","inline-help"])]),Object(i["withDirectives"])(Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"radio",name:"maskLength",title:e.translate("PrivacyManager_AnonymizeIpMaskLengtDescription"),modelValue:e.actualMaskLength,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.actualMaskLength=t}),options:e.maskLengthOptions,"inline-help":e.translate("PrivacyManager_GeolocationAnonymizeIpNote")},null,8,["title","modelValue","options","inline-help"])]),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"radio",name:"useAnonymizedIpForVisitEnrichment",title:e.translate("PrivacyManager_UseAnonymizedIpForVisitEnrichment"),modelValue:e.actualUseAnonymizedIpForVisitEnrichment,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.actualUseAnonymizedIpForVisitEnrichment=t}),options:e.useAnonymizedIpForVisitEnrichmentOptions,"inline-help":e.translate("PrivacyManager_UseAnonymizedIpForVisitEnrichmentNote")},null,8,["title","modelValue","options","inline-help"])])],512),[[i["vShow"],e.actualEnabled]]),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"anonymizeUserId",title:e.translate("PrivacyManager_PseudonymizeUserId"),modelValue:e.actualAnonymizeUserId,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.actualAnonymizeUserId=t})},{"inline-help":Object(i["withCtx"])((function(){return[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("PrivacyManager_PseudonymizeUserIdNote"))+" ",1),ae,oe,Object(i["createElementVNode"])("em",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_PseudonymizeUserIdNote2")),1)]})),_:1},8,["title","modelValue"])]),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"anonymizeOrderId",title:e.translate("PrivacyManager_UseAnonymizeOrderId"),modelValue:e.actualAnonymizeOrderId,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.actualAnonymizeOrderId=t}),"inline-help":e.translate("PrivacyManager_AnonymizeOrderIdNote")},null,8,["title","modelValue","inline-help"])]),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"forceCookielessTracking",title:e.translate("PrivacyManager_ForceCookielessTracking"),modelValue:e.actualForceCookielessTracking,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.actualForceCookielessTracking=t})},{"inline-help":Object(i["withCtx"])((function(){return[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("PrivacyManager_ForceCookielessTrackingDescription",e.trackerFileName))+" ",1),ie,le,Object(i["createElementVNode"])("em",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_ForceCookielessTrackingDescription2")),1),e.trackerWritable?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",re,[ce,se,Object(i["createElementVNode"])("p",de,Object(i["toDisplayString"])(e.translate("PrivacyManager_ForceCookielessTrackingDescriptionNotWritable",e.trackerFileName)),1)]))]})),_:1},8,["title","modelValue"])]),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"select",name:"anonymizeReferrer",title:e.translate("PrivacyManager_AnonymizeReferrer"),modelValue:e.actualAnonymizeReferrer,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.actualAnonymizeReferrer=t}),options:e.referrerAnonymizationOptions,"inline-help":e.translate("PrivacyManager_AnonymizeReferrerNote")},null,8,["title","modelValue","options","inline-help"])]),Object(i["createVNode"])(c,{onConfirm:t[7]||(t[7]=function(t){return e.save()}),saving:e.isLoading},null,8,["saving"])],512)),[[s]])}function me(e){return!0===e||1===e||"1"===e?1:0}var be=Object(i["defineComponent"])({props:{anonymizeIpEnabled:Boolean,anonymizeUserId:Boolean,maskLength:{type:Number,required:!0},useAnonymizedIpForVisitEnrichment:[Boolean,String,Number],anonymizeOrderId:Boolean,forceCookielessTracking:Boolean,anonymizeReferrer:String,maskLengthOptions:{type:Array,required:!0},useAnonymizedIpForVisitEnrichmentOptions:{type:Array,required:!0},trackerFileName:{type:String,required:!0},trackerWritable:{type:Boolean,required:!0},referrerAnonymizationOptions:{type:Object,required:!0}},components:{Field:ee["Field"],SaveButton:ee["SaveButton"]},directives:{Form:ee["Form"]},data:function(){return{isLoading:!1,actualEnabled:this.anonymizeIpEnabled,actualMaskLength:this.maskLength,actualUseAnonymizedIpForVisitEnrichment:me(this.useAnonymizedIpForVisitEnrichment),actualAnonymizeUserId:!!this.anonymizeUserId,actualAnonymizeOrderId:!!this.anonymizeOrderId,actualForceCookielessTracking:!!this.forceCookielessTracking,actualAnonymizeReferrer:this.anonymizeReferrer}},methods:{save:function(){var e=this;this.isLoading=!0,X["AjaxHelper"].post({module:"API",method:"PrivacyManager.setAnonymizeIpSettings"},{anonymizeIPEnable:this.actualEnabled?"1":"0",anonymizeUserId:this.actualAnonymizeUserId?"1":"0",anonymizeOrderId:this.actualAnonymizeOrderId?"1":"0",forceCookielessTracking:this.actualForceCookielessTracking?"1":"0",anonymizeReferrer:this.actualAnonymizeReferrer?this.actualAnonymizeReferrer:"",maskLength:this.actualMaskLength,useAnonymizedIpForVisitEnrichment:this.actualUseAnonymizedIpForVisitEnrichment}).then((function(){var e=X["NotificationsStore"].show({message:Object(X["translate"])("CoreAdminHome_SettingsSaveSuccess"),context:"success",id:"privacyManagerSettings",type:"toast"});X["NotificationsStore"].scrollToNotification(e)})).finally((function(){e.isLoading=!1}))}},computed:{anonymizeIpEnabledHelp:function(){var e=Object(X["translate"])("PrivacyManager_AnonymizeIpInlineHelp"),t=Object(X["translate"])("PrivacyManager_AnonymizeIpDescription");return"".concat(e," ").concat(t)}}});be.render=ue;var pe=be,ge={class:"optOutCustomizer"},ve=["innerHTML"],he=["value"],Oe=["value"],je=Object(i["createStaticVNode"])('<option value="px">px</option><option value="pt">pt</option><option value="em">em</option><option value="rem">rem</option><option value="%">%</option>',5),fe=[je],ye={ref:"pre"},Ve=["innerHTML"],Se=["src"];function De(e,t,n,a,o,l){var r=Object(i["resolveDirective"])("select-on-focus");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",ge,[Object(i["createElementVNode"])("p",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("CoreAdminHome_OptOutExplanation"))+" ",1),Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(e.readThisToLearnMore)},null,8,ve)]),Object(i["createElementVNode"])("h3",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_OptOutCustomize")),1),Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("p",null,[Object(i["createElementVNode"])("span",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("PrivacyManager_FontColor"))+": ",1),Object(i["createElementVNode"])("input",{type:"color",value:e.fontColor,onKeydown:t[0]||(t[0]=function(t){return e.onFontColorChange(t)}),onChange:t[1]||(t[1]=function(t){return e.onFontColorChange(t)})},null,40,he)]),Object(i["createElementVNode"])("span",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("PrivacyManager_BackgroundColor"))+": ",1),Object(i["createElementVNode"])("input",{type:"color",value:e.backgroundColor,onKeydown:t[2]||(t[2]=function(t){return e.onBgColorChange(t)}),onChange:t[3]||(t[3]=function(t){return e.onBgColorChange(t)})},null,40,Oe)]),Object(i["createElementVNode"])("span",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("PrivacyManager_FontSize"))+": ",1),Object(i["createElementVNode"])("input",{id:"FontSizeInput",type:"number",min:"1",max:"100",onKeydown:t[4]||(t[4]=function(t){return e.onFontSizeChange(t)}),onChange:t[5]||(t[5]=function(t){return e.onFontSizeChange(t)})},null,32)]),Object(i["createElementVNode"])("span",null,[Object(i["createElementVNode"])("select",{class:"browser-default",onKeydown:t[6]||(t[6]=function(t){return e.onFontSizeUnitChange(t)}),onChange:t[7]||(t[7]=function(t){return e.onFontSizeUnitChange(t)})},fe,32)]),Object(i["createElementVNode"])("span",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("PrivacyManager_FontFamily"))+": ",1),Object(i["createElementVNode"])("input",{id:"FontFamilyInput",type:"text",onKeydown:t[8]||(t[8]=function(t){return e.onFontFamilyChange(t)}),onChange:t[9]||(t[9]=function(t){return e.onFontFamilyChange(t)})},null,32)])])]),Object(i["createElementVNode"])("h3",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_OptOutHtmlCode")),1),Object(i["withDirectives"])(Object(i["createElementVNode"])("pre",ye,[Object(i["createTextVNode"])('<iframe\n      style="border: 0; height: 200px; width: 600px;"\n      src="'+Object(i["toDisplayString"])(e.iframeUrl)+'"\n      ></iframe>',1)],512),[[r,{}]]),Object(i["createElementVNode"])("p",{innerHTML:e.$sanitize(e.optOutExplanationIntro)},null,8,Ve),Object(i["createElementVNode"])("h3",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_OptOutPreview")),1),Object(i["createElementVNode"])("iframe",{id:"previewIframe",style:{border:"1px solid #333",height:"200px",width:"600px"},src:e.iframeUrl,class:Object(i["normalizeClass"])({withBg:e.withBg})},null,10,Se)])}function Ne(e){var t=parseInt(e,16),n=t>>16&255,a=t>>8&255,o=255&t;return n>=225&&a>=225&&o>=225}var Ee=window,Ce=Ee.$,ke=Object(i["defineComponent"])({props:{language:{type:String,required:!0},piwikurl:String},directives:{SelectOnFocus:X["SelectOnFocus"]},data:function(){return{fontSizeUnit:"px",backgroundColor:"",fontColor:"",fontSize:"",fontFamily:""}},created:function(){this.onFontColorChange=Object(X["debounce"])(this.onFontColorChange,50),this.onBgColorChange=Object(X["debounce"])(this.onBgColorChange,50),this.onFontSizeChange=Object(X["debounce"])(this.onFontSizeChange,50),this.onFontSizeUnitChange=Object(X["debounce"])(this.onFontSizeUnitChange,50),this.onFontFamilyChange=Object(X["debounce"])(this.onFontFamilyChange,50)},methods:{onFontColorChange:function(e){this.fontColor=e.target.value},onBgColorChange:function(e){this.backgroundColor=e.target.value},onFontSizeChange:function(e){this.fontSize=e.target.value},onFontSizeUnitChange:function(e){this.fontSizeUnit=e.target.value},onFontFamilyChange:function(e){this.fontFamily=e.target.value}},watch:{iframeUrl:function(){var e=this.$refs.pre,t=Ce(e).queue("fx").length>0;t||Ce(e).effect("highlight",{},1500)}},computed:{fontSizeWithUnit:function(){return this.fontSize?"".concat(this.fontSize).concat(this.fontSizeUnit):""},withBg:function(){return!!this.piwikurl&&""===this.backgroundColor&&""!==this.fontColor&&Ne(this.fontColor.slice(1))},iframeUrl:function(){if(this.piwikurl){var e=X["MatomoUrl"].stringify({module:"CoreAdminHome",action:"optOut",language:this.language,backgroundColor:this.backgroundColor.slice(1),fontColor:this.fontColor.slice(1),fontSize:this.fontSizeWithUnit,fontFamily:this.fontFamily});return"".concat(this.piwikurl,"index.php?").concat(e)}return""},readThisToLearnMore:function(){var e="https://matomo.org/faq/how-to/faq_25918/";return Object(X["translate"])("General_ReadThisToLearnMore","<a rel='noreferrer noopener' target='_blank' href='".concat(e,"'>"),"</a>")},optOutExplanationIntro:function(){return Object(X["translate"])("CoreAdminHome_OptOutExplanationIntro",'<a href="'.concat(this.iframeUrl,'" rel="noreferrer noopener" target="_blank">'),"</a>")}}});ke.render=De;var _e=ke,Pe={class:"anonymizeLogData"},we={class:"form-group row"},Me={class:"col s12 input-field"},Ae={for:"anonymizeSite",class:"siteSelectorLabel"},ze={class:"sites_autocomplete"},Ie={class:"form-group row"},Fe={class:"col s6 input-field"},Te={for:"anonymizeStartDate",class:"active"},xe=["value"],Le={class:"col s6 input-field"},Be={for:"anonymizeEndDate",class:"active"},Ue=["value"],Re={name:"anonymizeIp"},He={name:"anonymizeLocation"},Ge={name:"anonymizeTheUserId"},qe={class:"form-group row"},Ke={class:"col s12 m6"},We={for:"visit_columns"},$e={class:"innerFormField",name:"visit_columns"},Ye=["onClick","title"],Je={class:"col s12 m6"},Qe={class:"form-help"},Xe={class:"inline-help"},Ze={class:"form-group row"},et={class:"col s12"},tt={class:"form-group row"},nt={class:"col s12 m6"},at={for:"action_columns"},ot={class:"innerFormField",name:"action_columns"},it=["onClick","title"],lt={class:"col s12 m6"},rt={class:"form-help"},ct={class:"inline-help"},st=Object(i["createElementVNode"])("span",{class:"icon-info"},null,-1),dt={class:"ui-confirm",id:"confirmAnonymizeLogData",ref:"confirmAnonymizeLogData"},ut=["value"],mt=["value"];function bt(e,t,n,a,o,l){var r=Object(i["resolveComponent"])("SiteSelector"),c=Object(i["resolveComponent"])("Field"),s=Object(i["resolveComponent"])("SaveButton");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Pe,[Object(i["createElementVNode"])("div",we,[Object(i["createElementVNode"])("div",Me,[Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("label",Ae,Object(i["toDisplayString"])(e.translate("PrivacyManager_AnonymizeSites")),1),Object(i["createElementVNode"])("div",ze,[Object(i["createVNode"])(r,{id:"anonymizeSite",modelValue:e.site,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.site=t}),"show-all-sites-item":!0,"switch-site-on-select":!1,"show-selected-site":!0},null,8,["modelValue"])])])])]),Object(i["createElementVNode"])("div",Ie,[Object(i["createElementVNode"])("div",Fe,[Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("label",Te,Object(i["toDisplayString"])(e.translate("PrivacyManager_AnonymizeRowDataFrom")),1),Object(i["createElementVNode"])("input",{type:"text",id:"anonymizeStartDate",class:"anonymizeStartDate",ref:"anonymizeStartDate",name:"anonymizeStartDate",value:e.startDate,onKeydown:t[1]||(t[1]=function(t){return e.onKeydownStartDate(t)}),onChange:t[2]||(t[2]=function(t){return e.onKeydownStartDate(t)})},null,40,xe)])]),Object(i["createElementVNode"])("div",Le,[Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("label",Be,Object(i["toDisplayString"])(e.translate("PrivacyManager_AnonymizeRowDataTo")),1),Object(i["createElementVNode"])("input",{type:"text",class:"anonymizeEndDate",id:"anonymizeEndDate",ref:"anonymizeEndDate",name:"anonymizeEndDate",value:e.endDate,onKeydown:t[3]||(t[3]=function(t){return e.onKeydownEndDate(t)}),onChange:t[4]||(t[4]=function(t){return e.onKeydownEndDate(t)})},null,40,Ue)])])]),Object(i["createElementVNode"])("div",Re,[Object(i["createVNode"])(c,{uicontrol:"checkbox",name:"anonymizeIp",title:e.translate("PrivacyManager_AnonymizeIp"),modelValue:e.anonymizeIp,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.anonymizeIp=t}),introduction:e.translate("General_Visit"),"inline-help":e.translate("PrivacyManager_AnonymizeIpHelp")},null,8,["title","modelValue","introduction","inline-help"])]),Object(i["createElementVNode"])("div",He,[Object(i["createVNode"])(c,{uicontrol:"checkbox",name:"anonymizeLocation",title:e.translate("PrivacyManager_AnonymizeLocation"),modelValue:e.anonymizeLocation,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.anonymizeLocation=t}),"inline-help":e.translate("PrivacyManager_AnonymizeLocationHelp")},null,8,["title","modelValue","inline-help"])]),Object(i["createElementVNode"])("div",Ge,[Object(i["createVNode"])(c,{uicontrol:"checkbox",name:"anonymizeTheUserId",title:e.translate("PrivacyManager_AnonymizeUserId"),modelValue:e.anonymizeUserId,"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.anonymizeUserId=t}),"inline-help":e.translate("PrivacyManager_AnonymizeUserIdHelp")},null,8,["title","modelValue","inline-help"])]),Object(i["createElementVNode"])("div",qe,[Object(i["createElementVNode"])("div",Ke,[Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("label",We,Object(i["toDisplayString"])(e.translate("PrivacyManager_UnsetVisitColumns")),1),(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.selectedVisitColumns,(function(t,n){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:Object(i["normalizeClass"])("selectedVisitColumns selectedVisitColumns".concat(n," multiple valign-wrapper")),key:n},[Object(i["createElementVNode"])("div",$e,[Object(i["createVNode"])(c,{uicontrol:"select",name:"visit_columns","model-value":t.column,"onUpdate:modelValue":function(n){t.column=n,e.onVisitColumnChange()},"full-width":!0,options:e.availableVisitColumns},null,8,["model-value","onUpdate:modelValue","options"])]),Object(i["withDirectives"])(Object(i["createElementVNode"])("span",{class:"icon-minus valign",onClick:function(t){return e.removeVisitColumn(n)},title:e.translate("General_Remove")},null,8,Ye),[[i["vShow"],n+1!==e.selectedVisitColumns.length]])],2)})),128))])]),Object(i["createElementVNode"])("div",Je,[Object(i["createElementVNode"])("div",Qe,[Object(i["createElementVNode"])("span",Xe,Object(i["toDisplayString"])(e.translate("PrivacyManager_UnsetVisitColumnsHelp")),1)])])]),Object(i["createElementVNode"])("div",Ze,[Object(i["createElementVNode"])("div",et,[Object(i["createElementVNode"])("h3",null,Object(i["toDisplayString"])(e.translate("General_Action")),1)])]),Object(i["createElementVNode"])("div",tt,[Object(i["createElementVNode"])("div",nt,[Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("label",at,Object(i["toDisplayString"])(e.translate("PrivacyManager_UnsetActionColumns")),1),(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.selectedActionColumns,(function(t,n){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:Object(i["normalizeClass"])("selectedActionColumns selectedActionColumns".concat(n," multiple valign-wrapper")),key:n},[Object(i["createElementVNode"])("div",ot,[Object(i["createVNode"])(c,{uicontrol:"select",name:"action_columns","model-value":t.column,"onUpdate:modelValue":function(n){t.column=n,e.onActionColumnChange()},"full-width":!0,options:e.availableActionColumns},null,8,["model-value","onUpdate:modelValue","options"])]),Object(i["withDirectives"])(Object(i["createElementVNode"])("span",{class:"icon-minus valign",onClick:function(t){return e.removeActionColumn(n)},title:e.translate("General_Remove")},null,8,it),[[i["vShow"],n+1!==e.selectedActionColumns.length]])],2)})),128))])]),Object(i["createElementVNode"])("div",lt,[Object(i["createElementVNode"])("div",rt,[Object(i["createElementVNode"])("span",ct,Object(i["toDisplayString"])(e.translate("PrivacyManager_UnsetActionColumnsHelp")),1)])])]),Object(i["createElementVNode"])("p",null,[st,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("PrivacyManager_AnonymizeProcessInfo")),1)]),Object(i["createVNode"])(s,{class:"anonymizePastData",onConfirm:t[8]||(t[8]=function(t){return e.scheduleAnonymization()}),disabled:e.isAnonymizePastDataDisabled,value:e.translate("PrivacyManager_AnonymizeDataNow")},null,8,["disabled","value"]),Object(i["createElementVNode"])("div",dt,[Object(i["createElementVNode"])("h2",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_AnonymizeDataConfirm")),1),Object(i["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,ut),Object(i["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,mt)],512)])}function pt(e){return e<10?"0".concat(e):e}var gt=Object(i["defineComponent"])({components:{SiteSelector:X["SiteSelector"],Field:ee["Field"],SaveButton:ee["SaveButton"]},data:function(){var e=new Date,t="".concat(e.getFullYear(),"-").concat(pt(e.getMonth()+1),"-").concat(pt(e.getDay()+1));return{isLoading:!1,isDeleting:!1,anonymizeIp:!1,anonymizeLocation:!1,anonymizeUserId:!1,site:{id:"all",name:"All Websites"},availableVisitColumns:[],availableActionColumns:[],selectedVisitColumns:[{column:""}],selectedActionColumns:[{column:""}],startDate:t,endDate:t}},created:function(){var e=this;this.onKeydownStartDate=Object(X["debounce"])(this.onKeydownStartDate,50),this.onKeydownEndDate=Object(X["debounce"])(this.onKeydownEndDate,50),X["AjaxHelper"].fetch({method:"PrivacyManager.getAvailableVisitColumnsToAnonymize"}).then((function(t){e.availableVisitColumns=[],t.forEach((function(t){e.availableVisitColumns.push({key:t.column_name,value:t.column_name})}))})),X["AjaxHelper"].fetch({method:"PrivacyManager.getAvailableLinkVisitActionColumnsToAnonymize"}).then((function(t){e.availableActionColumns=[],t.forEach((function(t){e.availableActionColumns.push({key:t.column_name,value:t.column_name})}))})),setTimeout((function(){var t=X["Matomo"].getBaseDatePickerOptions(null),n=X["Matomo"].getBaseDatePickerOptions(null);$(e.$refs.anonymizeStartDate).datepicker(t),$(e.$refs.anonymizeEndDate).datepicker(n)}))},methods:{onVisitColumnChange:function(){var e=this.selectedVisitColumns.every((function(e){return!(null===e||void 0===e||!e.column)}));e&&this.addVisitColumn()},addVisitColumn:function(){this.selectedVisitColumns.push({column:""})},removeVisitColumn:function(e){if(e>-1){var t=this.selectedVisitColumns.length-1;t===e?this.selectedVisitColumns[e]={column:""}:this.selectedVisitColumns.splice(e,1)}},onActionColumnChange:function(){var e=this.selectedActionColumns.every((function(e){return!(null===e||void 0===e||!e.column)}));e&&this.addActionColumn()},addActionColumn:function(){this.selectedActionColumns.push({column:""})},removeActionColumn:function(e){if(e>-1){var t=this.selectedActionColumns.length-1;t===e?this.selectedActionColumns[e]={column:""}:this.selectedActionColumns.splice(e,1)}},scheduleAnonymization:function(){var e="".concat(this.startDate,",").concat(this.endDate);this.startDate===this.endDate&&(e=this.startDate);var t={date:e};t.idSites=this.site.id,t.anonymizeIp=this.anonymizeIp?"1":"0",t.anonymizeLocation=this.anonymizeLocation?"1":"0",t.anonymizeUserId=this.anonymizeUserId?"1":"0",t.unsetVisitColumns=this.selectedVisitColumns.filter((function(e){return!(null===e||void 0===e||!e.column)})).map((function(e){return e.column})),t.unsetLinkVisitActionColumns=this.selectedActionColumns.filter((function(e){return!(null===e||void 0===e||!e.column)})).map((function(e){return e.column})),X["Matomo"].helper.modalConfirm(this.$refs.confirmAnonymizeLogData,{yes:function(){X["AjaxHelper"].post({method:"PrivacyManager.anonymizeSomeRawData"},t).then((function(){window.location.reload(!0)}))}})},onKeydownStartDate:function(e){this.startDate=e.target.value},onKeydownEndDate:function(e){this.endDate=e.target.value}},computed:{isAnonymizePastDataDisabled:function(){return!this.anonymizeIp&&!this.anonymizeLocation&&!this.selectedVisitColumns&&!this.selectedActionColumns}}});gt.render=bt;var vt=gt;function ht(e,t,n,a,o,l){var r=Object(i["resolveComponent"])("Field"),c=Object(i["resolveComponent"])("SaveButton"),s=Object(i["resolveDirective"])("form");return Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"radio",name:"doNotTrack",modelValue:e.enabled,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.enabled=t}),options:e.doNotTrackOptions,"inline-help":e.translate("PrivacyManager_DoNotTrack_Description")},null,8,["modelValue","options","inline-help"])]),Object(i["createVNode"])(c,{onConfirm:t[1]||(t[1]=function(t){return e.save()}),saving:e.isLoading},null,8,["saving"])],512)),[[s]])}var Ot=Object(i["defineComponent"])({props:{dntSupport:Boolean,doNotTrackOptions:{type:Array,required:!0}},components:{Field:ee["Field"],SaveButton:ee["SaveButton"]},directives:{Form:ee["Form"]},data:function(){return{isLoading:!1,enabled:this.dntSupport?1:0}},methods:{save:function(){var e=this;this.isLoading=!0;var t="deactivateDoNotTrack";this.enabled&&"0"!==this.enabled&&(t="activateDoNotTrack"),X["AjaxHelper"].post({module:"API",method:"PrivacyManager.".concat(t)}).then((function(){var e=X["NotificationsStore"].show({message:Object(X["translate"])("CoreAdminHome_SettingsSaveSuccess"),context:"success",id:"privacyManagerSettings",type:"transient"});X["NotificationsStore"].scrollToNotification(e)})).finally((function(){e.isLoading=!1}))}}});Ot.render=ht;var jt=Ot;function ft(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yt(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Vt(e,t,n){return t&&yt(e.prototype,t),n&&yt(e,n),e}function St(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var Dt=function(){function e(){var t=this;ft(this,e),St(this,"privateState",Object(i["reactive"])({settings:{},showEstimate:!1,loadingEstimation:!1,estimation:"",isModified:!1})),St(this,"state",Object(i["computed"])((function(){return Object(i["readonly"])(t.privateState)}))),St(this,"enableDeleteReports",Object(i["computed"])((function(){return t.state.value.settings.enableDeleteReports}))),St(this,"enableDeleteLogs",Object(i["computed"])((function(){return t.state.value.settings.enableDeleteLogs}))),St(this,"currentRequest",void 0)}return Vt(e,[{key:"updateSettings",value:function(e){this.initSettings(e),this.privateState.isModified=!0}},{key:"initSettings",value:function(e){this.privateState.settings=Object.assign(Object.assign({},this.privateState.settings),e),this.reloadDbStats()}},{key:"savePurgeDataSettings",value:function(e,t){return this.privateState.isModified=!1,X["AjaxHelper"].post({module:"API",method:e},Object.assign(Object.assign({},t),{},{enableDeleteLogs:t.enableDeleteLogs?"1":"0",enableDeleteReports:t.enableDeleteReports?"1":"0"})).then((function(){var e=X["NotificationsStore"].show({message:Object(X["translate"])("CoreAdminHome_SettingsSaveSuccess"),context:"success",id:"privacyManagerSettings",type:"toast"});X["NotificationsStore"].scrollToNotification(e)}))}},{key:"isEitherDeleteSectionEnabled",value:function(){return this.state.value.settings.enableDeleteLogs||this.state.value.settings.enableDeleteReports}},{key:"isManualEstimationLinkShowing",value:function(){return window.$("#getPurgeEstimateLink").length>0}},{key:"reloadDbStats",value:function(e){var t=this;if(this.currentRequest&&(this.currentRequest.abort(),this.currentRequest=void 0),e||this.isEitherDeleteSectionEnabled()&&!this.isManualEstimationLinkShowing()){this.privateState.loadingEstimation=!0,this.privateState.estimation="",this.privateState.showEstimate=!1;var n=this.privateState.settings,a=Object.assign(Object.assign({},n),{},{enableDeleteLogs:n.enableDeleteLogs?"1":"0",enableDeleteReports:n.enableDeleteReports?"1":"0"});!0===e&&(a.forceEstimate=1),this.currentRequest=new AbortController,X["AjaxHelper"].post({module:"PrivacyManager",action:"getDatabaseSize",format:"html"},a,{abortController:this.currentRequest,format:"html"}).then((function(e){t.privateState.estimation=e,t.privateState.showEstimate=!0,t.privateState.loadingEstimation=!1})).finally((function(){t.currentRequest=void 0,t.privateState.loadingEstimation=!1}))}}}]),e}(),Nt=new Dt,Et={id:"formDeleteSettings"},Ct={id:"deleteLogSettingEnabled"},kt={class:"alert alert-warning deleteOldLogsWarning",style:{width:"50%"}},_t={href:"https://matomo.org/faq/general/#faq_125",rel:"noreferrer noopener",target:"_blank"},Pt={id:"deleteLogSettings"};function wt(e,t,n,a,o,l){var r=Object(i["resolveComponent"])("Field"),c=Object(i["resolveComponent"])("SaveButton"),s=Object(i["resolveDirective"])("form");return Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Et,[Object(i["createElementVNode"])("div",Ct,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"deleteEnable","model-value":e.enabled,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.enabled=t,e.reloadDbStats()}),title:e.translate("PrivacyManager_UseDeleteLog"),"inline-help":e.translate("PrivacyManager_DeleteRawDataInfo")},null,8,["model-value","title","inline-help"])]),Object(i["withDirectives"])(Object(i["createElementVNode"])("div",kt,[Object(i["createElementVNode"])("a",_t,Object(i["toDisplayString"])(e.translate("General_ClickHere")),1)],512),[[i["vShow"],e.enabled]])]),Object(i["withDirectives"])(Object(i["createElementVNode"])("div",Pt,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"text",name:"deleteOlderThan","model-value":e.deleteOlderThan,"onUpdate:modelValue":t[1]||(t[1]=function(t){e.deleteOlderThan=t,e.reloadDbStats()}),title:e.deleteOlderThanTitle,"inline-help":e.translate("PrivacyManager_LeastDaysInput","1")},null,8,["model-value","title","inline-help"])])],512),[[i["vShow"],e.enabled]]),Object(i["createVNode"])(c,{onConfirm:t[2]||(t[2]=function(t){return e.save()}),saving:e.isLoading},null,8,["saving"])],512)),[[s]])}var Mt=window,At=Mt.$,zt=Object(i["defineComponent"])({props:{isDataPurgeSettingsEnabled:Boolean,deleteData:{type:Object,required:!0},scheduleDeletionOptions:{type:Object,required:!0}},components:{Field:ee["Field"],SaveButton:ee["SaveButton"]},directives:{Form:ee["Form"]},data:function(){return{isLoading:!1,enabled:"1"===this.deleteData.config.delete_logs_enable,deleteOlderThan:this.deleteData.config.delete_logs_older_than}},created:function(){var e=this;setTimeout((function(){Nt.initSettings(e.settings)}))},methods:{saveSettings:function(){var e=this,t="PrivacyManager.setDeleteLogsSettings";this.isLoading=!0,Nt.savePurgeDataSettings(t,this.settings).finally((function(){e.isLoading=!1}))},reloadDbStats:function(){Nt.updateSettings(this.settings)},save:function(){var e=this;if(this.enabled){var t="deleteLogsConfirm";Nt.enableDeleteReports.value&&(t="deleteBothConfirm"),At("#confirmDeleteSettings").find(">h2").hide(),At("#".concat(t)).show(),X["Matomo"].helper.modalConfirm("#confirmDeleteSettings",{yes:function(){e.saveSettings()}})}else this.saveSettings()}},computed:{settings:function(){return{enableDeleteLogs:!!this.enabled,deleteLogsOlderThan:this.deleteOlderThan}},deleteOlderThanTitle:function(){return"".concat(Object(X["translate"])("PrivacyManager_DeleteLogsOlderThan")," (").concat(Object(X["translate"])("Intl_PeriodDays"),")")}}});zt.render=wt;var It=zt,Ft={id:"formDeleteSettings"},Tt={id:"deleteReportsSettingEnabled"},xt={class:"alert alert-warning",style:{width:"50%"}},Lt=Object(i["createElementVNode"])("br",null,null,-1),Bt=Object(i["createElementVNode"])("br",null,null,-1),Ut={id:"deleteReportsSettings"};function Rt(e,t,n,a,o,l){var r=Object(i["resolveComponent"])("Field"),c=Object(i["resolveComponent"])("SaveButton"),s=Object(i["resolveDirective"])("form");return Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Ft,[Object(i["createElementVNode"])("div",Tt,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"deleteReportsEnable","model-value":e.enabled,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.enabled=t,e.reloadDbStats()}),title:e.translate("PrivacyManager_UseDeleteReports"),"inline-help":e.translate("PrivacyManager_DeleteAggregateReportsDetailedInfo")},null,8,["model-value","title","inline-help"])]),Object(i["withDirectives"])(Object(i["createElementVNode"])("div",xt,[Object(i["createElementVNode"])("span",null,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("PrivacyManager_DeleteReportsInfo2",e.deleteOldLogsText)),1),Lt,Bt,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.translate("PrivacyManager_DeleteReportsInfo3",e.deleteOldLogsText)),1)])],512),[[i["vShow"],e.enabled]])]),Object(i["withDirectives"])(Object(i["createElementVNode"])("div",Ut,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"text",name:"deleteReportsOlderThan","model-value":e.deleteOlderThan,"onUpdate:modelValue":t[1]||(t[1]=function(t){e.deleteOlderThan=t,e.reloadDbStats()}),title:e.deleteReportsOlderThanTitle,"inline-help":e.translate("PrivacyManager_LeastMonthsInput","1")},null,8,["model-value","title","inline-help"])]),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"deleteReportsKeepBasic","model-value":e.keepBasic,"onUpdate:modelValue":t[2]||(t[2]=function(t){e.keepBasic=t,e.reloadDbStats()}),title:e.deleteReportsKeepBasicTitle,"inline-help":e.translate("PrivacyManager_KeepBasicMetricsReportsDetailedInfo")},null,8,["model-value","title","inline-help"])]),Object(i["createElementVNode"])("h3",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_KeepDataFor")),1),Object(i["createElementVNode"])("div",null,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"deleteReportsKeepDay","model-value":e.keepDataForDay,"onUpdate:modelValue":t[3]||(t[3]=function(t){e.keepDataForDay=t,e.reloadDbStats()}),title:e.translate("General_DailyReports")},null,8,["model-value","title"])]),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"deleteReportsKeepWeek","model-value":e.keepDataForWeek,"onUpdate:modelValue":t[4]||(t[4]=function(t){e.keepDataForWeek=t,e.reloadDbStats()}),title:e.translate("General_WeeklyReports")},null,8,["model-value","title"])]),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"deleteReportsKeepMonth","model-value":e.keepDataForMonth,"onUpdate:modelValue":t[5]||(t[5]=function(t){e.keepDataForMonth=t,e.reloadDbStats()}),title:"".concat(e.translate("General_MonthlyReports")," (").concat(e.translate("General_Recommended"),")")},null,8,["model-value","title"])]),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"deleteReportsKeepYear","model-value":e.keepDataForYear,"onUpdate:modelValue":t[6]||(t[6]=function(t){e.keepDataForYear=t,e.reloadDbStats()}),title:"".concat(e.translate("General_YearlyReports")," (").concat(e.translate("General_Recommended"),")")},null,8,["model-value","title"])]),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"deleteReportsKeepRange","model-value":e.keepDataForRange,"onUpdate:modelValue":t[7]||(t[7]=function(t){e.keepDataForRange=t,e.reloadDbStats()}),title:e.translate("General_RangeReports")},null,8,["model-value","title"])]),Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(r,{uicontrol:"checkbox",name:"deleteReportsKeepSegments","model-value":e.keepDataForSegments,"onUpdate:modelValue":t[8]||(t[8]=function(t){e.keepDataForSegments=t,e.reloadDbStats()}),title:e.translate("PrivacyManager_KeepReportSegments")},null,8,["model-value","title"])])])],512),[[i["vShow"],e.enabled]]),Object(i["createVNode"])(c,{onConfirm:t[9]||(t[9]=function(t){return e.save()}),saving:e.isLoading},null,8,["saving"])],512)),[[s]])}function Ht(e){return e?"1":"0"}var Gt=window,qt=Gt.$,Kt=Object(i["defineComponent"])({props:{isDataPurgeSettingsEnabled:Boolean,deleteData:{type:Object,required:!0},scheduleDeletionOptions:{type:Object,required:!0}},components:{Field:ee["Field"],SaveButton:ee["SaveButton"]},directives:{Form:ee["Form"]},data:function(){return{isLoading:!1,enabled:1===parseInt(this.deleteData.config.delete_reports_enable,10),deleteOlderThan:this.deleteData.config.delete_reports_older_than,keepBasic:1===parseInt(this.deleteData.config.delete_reports_keep_basic_metrics,10),keepDataForDay:1===parseInt(this.deleteData.config.delete_reports_keep_day_reports,10),keepDataForWeek:1===parseInt(this.deleteData.config.delete_reports_keep_week_reports,10),keepDataForMonth:1===parseInt(this.deleteData.config.delete_reports_keep_month_reports,10),keepDataForYear:1===parseInt(this.deleteData.config.delete_reports_keep_year_reports,10),keepDataForRange:1===parseInt(this.deleteData.config.delete_reports_keep_range_reports,10),keepDataForSegments:1===parseInt(this.deleteData.config.delete_reports_keep_segment_reports,10)}},created:function(){var e=this;setTimeout((function(){Nt.initSettings(e.settings)}))},methods:{saveSettings:function(){var e=this,t="PrivacyManager.setDeleteReportsSettings";this.isLoading=!0,Nt.savePurgeDataSettings(t,this.settings).finally((function(){e.isLoading=!1}))},reloadDbStats:function(){Nt.updateSettings(this.settings)},save:function(){var e=this;if(this.enabled){var t="deleteReportsConfirm";Nt.enableDeleteLogs.value&&(t="deleteBothConfirm"),qt("#confirmDeleteSettings").find(">h2").hide(),qt("#".concat(t)).show(),X["Matomo"].helper.modalConfirm("#confirmDeleteSettings",{yes:function(){e.saveSettings()}})}else this.saveSettings()}},computed:{settings:function(){return{enableDeleteReports:this.enabled,deleteReportsOlderThan:this.deleteOlderThan,keepBasic:Ht(this.keepBasic),keepDay:Ht(this.keepDataForDay),keepWeek:Ht(this.keepDataForWeek),keepMonth:Ht(this.keepDataForMonth),keepYear:Ht(this.keepDataForYear),keepRange:Ht(this.keepDataForRange),keepSegments:Ht(this.keepDataForSegments)}},deleteOldLogsText:function(){return Object(X["translate"])("PrivacyManager_UseDeleteLog")},deleteReportsOlderThanTitle:function(){var e=Object(X["translate"])("PrivacyManager_DeleteReportsOlderThan");return"".concat(e," (").concat(Object(X["translate"])("Intl_PeriodMonths"),")")},deleteReportsKeepBasicTitle:function(){var e=Object(X["translate"])("PrivacyManager_KeepBasicMetrics");return"".concat(e," (").concat(Object(X["translate"])("General_Recommended"),")")}}});Kt.render=Rt;var Wt=Kt,$t={id:"formDeleteSettings"},Yt={id:"deleteSchedulingSettings"},Jt={id:"deleteSchedulingSettingsInlineHelp",class:"inline-help-node"},Qt={key:0},Xt=Object(i["createElementVNode"])("br",null,null,-1),Zt=Object(i["createElementVNode"])("br",null,null,-1),en=Object(i["createElementVNode"])("br",null,null,-1),tn=Object(i["createElementVNode"])("br",null,null,-1),nn={key:0,id:"deleteDataEstimateSect",class:"form-group row"},an={class:"col s12",id:"databaseSizeHeadline"},on={class:"col s12 m6"},ln=["innerHTML"],rn=Object(i["createTextVNode"])("Â "),cn={class:"col s12 m6"},sn={key:0,class:"form-help"};function dn(e,t,n,a,o,l){var r=Object(i["resolveComponent"])("ActivityIndicator"),c=Object(i["resolveComponent"])("Field"),s=Object(i["resolveComponent"])("SaveButton"),d=Object(i["resolveComponent"])("ContentBlock"),u=Object(i["resolveDirective"])("form");return Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("div",$t,[Object(i["withDirectives"])(Object(i["createVNode"])(d,{id:"scheduleSettingsHeadline","content-title":e.translate("PrivacyManager_DeleteSchedulingSettings")},{default:Object(i["withCtx"])((function(){return[Object(i["createElementVNode"])("div",Yt,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(c,{uicontrol:"select",name:"deleteLowestInterval",title:e.translate("PrivacyManager_DeleteDataInterval"),modelValue:e.deleteLowestInterval,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.deleteLowestInterval=t}),options:e.scheduleDeletionOptions},{"inline-help":Object(i["withCtx"])((function(){return[Object(i["createElementVNode"])("div",Jt,[e.deleteData.lastRun?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",Qt,[Object(i["createElementVNode"])("strong",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_LastDelete"))+":",1),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.deleteData.lastRunPretty)+" ",1),Xt,Zt])):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("strong",null,Object(i["toDisplayString"])(e.translate("PrivacyManager_NextDelete"))+":",1),Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.deleteData.nextRunPretty)+" ",1),en,tn,Object(i["withDirectives"])(Object(i["createElementVNode"])("a",{id:"purgeDataNowLink",href:"#",onClick:t[0]||(t[0]=function(t){return e.executeDataPurgeNow()})},Object(i["toDisplayString"])(e.translate("PrivacyManager_PurgeNow")),513),[[i["vShow"],e.showPurgeNowLink]]),Object(i["createVNode"])(r,{"loading-message":e.translate("PrivacyManager_PurgingData"),loading:e.loadingDataPurge},null,8,["loading-message","loading"]),Object(i["withDirectives"])(Object(i["createElementVNode"])("span",{id:"db-purged-message"},Object(i["toDisplayString"])(e.translate("PrivacyManager_DBPurged")),513),[[i["vShow"],e.dataWasPurged]])])]})),_:1},8,["title","modelValue","options"])])]),"1"===e.deleteData.config.enable_database_size_estimate||1===e.deleteData.config.enable_database_size_estimate?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",nn,[Object(i["createElementVNode"])("h3",an,Object(i["toDisplayString"])(e.translate("PrivacyManager_ReportsDataSavedEstimate")),1),Object(i["createElementVNode"])("div",on,[Object(i["withDirectives"])(Object(i["createElementVNode"])("div",{id:"deleteDataEstimate",innerHTML:e.$sanitize(e.estimation)},null,8,ln),[[i["vShow"],e.showEstimate]]),rn,Object(i["createVNode"])(r,{loading:e.loadingEstimation},null,8,["loading"])]),Object(i["createElementVNode"])("div",cn,["1"!==e.deleteData.config.enable_auto_database_size_estimate&&1!==e.deleteData.config.enable_auto_database_size_estimate?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",sn,[Object(i["createElementVNode"])("a",{id:"getPurgeEstimateLink",href:"#",onClick:t[2]||(t[2]=Object(i["withModifiers"])((function(t){return e.getPurgeEstimate()}),["prevent"]))},Object(i["toDisplayString"])(e.translate("PrivacyManager_GetPurgeEstimate")),1)])):Object(i["createCommentVNode"])("",!0)])])):Object(i["createCommentVNode"])("",!0),Object(i["createVNode"])(s,{onConfirm:t[3]||(t[3]=function(t){return e.save()}),saving:e.isLoading},null,8,["saving"])]})),_:1},8,["content-title"]),[[i["vShow"],e.isEitherDeleteSectionEnabled]])],512)),[[u]])}var un=Object(i["defineComponent"])({props:{isDataPurgeSettingsEnabled:Boolean,deleteData:{type:Object,required:!0},scheduleDeletionOptions:{type:Object,required:!0}},components:{ContentBlock:X["ContentBlock"],ActivityIndicator:X["ActivityIndicator"],Field:ee["Field"],SaveButton:ee["SaveButton"]},directives:{Form:ee["Form"]},data:function(){return{isLoading:!1,loadingDataPurge:!1,dataWasPurged:!1,showPurgeNowLink:!0,deleteLowestInterval:this.deleteData.config.delete_logs_schedule_lowest_interval}},methods:{save:function(){var e="PrivacyManager.setScheduleReportDeletionSettings";Nt.savePurgeDataSettings(e,{deleteLowestInterval:this.deleteLowestInterval})},executeDataPurgeNow:function(){var e=this;Nt.state.value.isModified?X["Matomo"].helper.modalConfirm("#saveSettingsBeforePurge",{yes:function(){return null}}):X["Matomo"].helper.modalConfirm("#confirmPurgeNow",{yes:function(){e.loadingDataPurge=!0,e.showPurgeNowLink=!1,X["AjaxHelper"].fetch({module:"PrivacyManager",action:"executeDataPurge",format:"html"},{withTokenInUrl:!0}).then((function(){Nt.reloadDbStats(),e.dataWasPurged=!0,setTimeout((function(){e.dataWasPurged=!1,e.showPurgeNowLink=!0}),2e3)})).finally((function(){e.loadingDataPurge=!1}))}})},getPurgeEstimate:function(){return Nt.reloadDbStats(!0)}},computed:{showEstimate:function(){return Nt.state.value.showEstimate},isEitherDeleteSectionEnabled:function(){return Nt.isEitherDeleteSectionEnabled()},estimation:function(){return Nt.state.value.estimation},loadingEstimation:function(){return Nt.state.value.loadingEstimation}}});un.render=dn;var mn=un;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["MobileMessaging"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["MobileMessaging"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,n){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/MobileMessaging/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"8bbf":function(e,n){e.exports=t},a5a2:function(e,t){e.exports=n},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"ReportParameters",(function(){return P})),n.d(t,"ManageSmsProvider",(function(){return T})),n.d(t,"SmsProviderCredentials",(function(){return b})),n.d(t,"DelegateMobileMessagingSettings",(function(){return L})),n.d(t,"ManageMobilePhoneNumbers",(function(){return pe})),n.d(t,"SelectPhoneNumbers",(function(){return V})),"undefined"!==typeof window){var o=window.document.currentScript,r=o&&o.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);r&&(n.p=r[1])}var i=n("8bbf"),l=n("19dc");function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c={key:0};function s(e,t,n,o,r,l){var s=Object(i["resolveComponent"])("Field");return e.fields?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",c,[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.fields,(function(t){var n;return Object(i["openBlock"])(),Object(i["createBlock"])(s,{key:t.name,uicontrol:t.type,name:t.name,"model-value":null===(n=e.modelValue)||void 0===n?void 0:n[t.name],"onUpdate:modelValue":function(n){return e.$emit("update:modelValue",Object.assign(Object.assign({},e.modelValue),{},a({},t.name,n)))},title:e.translate(t.title)},null,8,["uicontrol","name","model-value","onUpdate:modelValue","title"])})),128))])):Object(i["createCommentVNode"])("",!0)}var d=n("a5a2"),u=Object(i["reactive"])({}),m=Object(i["defineComponent"])({props:{provider:{type:String,required:!0},modelValue:Object},emits:["update:modelValue"],components:{Field:d["Field"]},watch:{provider:function(){this.$emit("update:modelValue",null),this.getCredentialFields()}},created:function(){this.getCredentialFields()},methods:{getCredentialFields:function(){var e=this;u[this.provider]?this.$emit("update:modelValue",Object.fromEntries(u[this.provider].map((function(e){return[e.name,null]})))):l["AjaxHelper"].fetch({module:"MobileMessaging",action:"getCredentialFields",provider:this.provider}).then((function(t){e.$emit("update:modelValue",Object.fromEntries(t.map((function(e){return[e.name,null]})))),u[e.provider]=t}))}},computed:{fields:function(){return u[this.provider]}}});m.render=s;var b=m,p=(Object(l["createAngularJsAdapter"])({component:b,scope:{provider:{angularJsBind:"="},credentials:{angularJsBind:"=value"}},directiveName:"smsProviderCredentials",transclude:!0,events:{"update:modelValue":function(e,t,n,o,r,i,l){var a=i?i.$viewValue:n.value;e!==a&&l((function(){i?(i.$setViewValue(e),i.$render()):n.value=e}))}},postCreate:function(e,t,n,o,r){var a=r;a?(a.$render=function(){Object(i["nextTick"])((function(){e.modelValue=Object(l["removeAngularJsSpecificProperties"])(a.$viewValue)}))},"undefined"!==typeof t.value?a.$setViewValue(t.value):a.$setViewValue(e.modelValue)):t.$watch("value",(function(t){t!==e.modelValue&&Object(i["nextTick"])((function(){e.modelValue=t}))}))}}),{class:"mobile"}),g={id:"mobilePhoneNumbersHelp",class:"inline-help-node"},v=Object(i["createElementVNode"])("span",{class:"icon-info",style:{"margin-right":"3.5px"}},null,-1),h={key:0,style:{"margin-right":"3.5px"}},f={key:1,style:{"margin-right":"3.5px"}},j=["href"];
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function O(e,t,n,o,r,l){var a=Object(i["resolveComponent"])("Field");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",p,[Object(i["createVNode"])(a,{uicontrol:"checkbox","var-type":"array",name:"phoneNumbers","model-value":e.modelValue,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.$emit("update:modelValue",t)}),introduction:e.withIntroduction?e.translate("ScheduledReports_SendReportTo"):void 0,title:e.translate("MobileMessaging_PhoneNumbers"),disabled:0===e.phoneNumbers.length,options:e.phoneNumbers},{"inline-help":Object(i["withCtx"])((function(){return[Object(i["createElementVNode"])("div",g,[v,0===e.phoneNumbers.length?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",h,Object(i["toDisplayString"])(e.translate("MobileMessaging_MobileReport_NoPhoneNumbers")),1)):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",f,Object(i["toDisplayString"])(e.translate("MobileMessaging_MobileReport_AdditionalPhoneNumbers")),1)),Object(i["createElementVNode"])("a",{href:e.linkTo({module:"MobileMessaging",action:"index",updated:null})},Object(i["toDisplayString"])(e.translate("MobileMessaging_MobileReport_MobileMessagingSettingsLink")),9,j)])]})),_:1},8,["model-value","introduction","title","disabled","options"])])}var N=Object(i["defineComponent"])({props:{modelValue:Array,phoneNumbers:{type:[Array,Object],required:!0},withIntroduction:Boolean},emits:["update:modelValue"],components:{Field:d["Field"]},methods:{linkTo:function(e){return"?".concat(l["MatomoUrl"].stringify(Object.assign(Object.assign({},l["MatomoUrl"].urlParsed.value),e)))}}});N.render=O;var V=N,M=(Object(l["createAngularJsAdapter"])({component:V,require:"?ngModel",scope:{phoneNumbers:{angularJsBind:"<"},withIntroduction:{angularJsBind:"<"},value:{angularJsBind:"<",vue:"modelValue"}},$inject:["$timeout"],directiveName:"matomoSelectPhoneNumbers",events:{"update:modelValue":function(e,t,n,o,r,i,l){i&&e!==i.$viewValue&&l((function(){i.$setViewValue(e),i.$render()}))}},postCreate:function(e,t,n,o,r){var a=r;a.$render=function(){Object(i["nextTick"])((function(){e.modelValue=Object(l["removeAngularJsSpecificProperties"])(a.$viewValue)}))},"undefined"!==typeof t.value?a.$setViewValue(t.value):a.$setViewValue(e.modelValue)}}),{key:0});
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function y(e,t,n,o,r,l){var a=Object(i["resolveComponent"])("SelectPhoneNumbers");return e.report&&"mobile"===e.report.type?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",M,[Object(i["createVNode"])(a,{"phone-numbers":e.phoneNumbers,"with-introduction":!0,"model-value":e.report.phoneNumbers,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.$emit("change","phoneNumbers",t)})},null,8,["phone-numbers","model-value"])])):Object(i["createCommentVNode"])("",!0)}var C="mobile",S=Object(i["defineComponent"])({props:{report:{type:Object,required:!0},phoneNumbers:{type:[Array,Object],required:!0}},components:{SelectPhoneNumbers:V},emits:["change"],created:function(){var e=window,t=e.resetReportParametersFunctions,n=e.updateReportParametersFunctions,o=e.getReportParametersFunctions;t[C]||(t[C]=function(e){e.phoneNumbers=[],e.formatmobile="sms"}),n[C]||(n[C]=function(e){null!==e&&void 0!==e&&e.parameters&&(e.parameters&&e.parameters.phoneNumbers&&(e.phoneNumbers=e.parameters.phoneNumbers),e.formatmobile="sms")}),o[C]||(o[C]=function(e){var t=e.phoneNumbers;return{phoneNumbers:t||[""]}})}});S.render=y;var P=S,A=Object(i["createElementVNode"])("div",{id:"ajaxErrorManageSmsProviderSettings"},null,-1),E={key:0},k={key:0},_=Object(i["createElementVNode"])("br",null,null,-1),B={key:1},w=Object(i["createElementVNode"])("br",null,null,-1),x=["innerHTML"],D={key:1},F={id:"accountForm"},U=["innerHTML"];function $(e,t,n,o,r,l){var a=Object(i["resolveComponent"])("ActivityIndicator"),c=Object(i["resolveComponent"])("Field"),s=Object(i["resolveComponent"])("SmsProviderCredentials"),d=Object(i["resolveComponent"])("SaveButton"),u=Object(i["resolveDirective"])("form");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["createVNode"])(a,{loading:e.isDeletingAccount},null,8,["loading"]),A,e.credentialSupplied?(Object(i["openBlock"])(),Object(i["createElementBlock"])("p",E,[e.credentialError?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",k,[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_CredentialInvalid",e.provider)),1),_,Object(i["createTextVNode"])(" "+Object(i["toDisplayString"])(e.credentialError),1)])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",B,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_CredentialProvided",e.provider))+" "+Object(i["toDisplayString"])(e.creditLeft),1)),w,Object(i["createElementVNode"])("span",{innerHTML:e.$sanitize(e.updateOrDeleteAccountText),onClick:t[0]||(t[0]=function(t){return e.onUpdateOrDeleteClick(t)})},null,8,x)])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("p",D,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_PleaseSignUp")),1)),Object(i["withDirectives"])(Object(i["createElementVNode"])("div",F,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(c,{uicontrol:"select",name:"smsProviders",modelValue:e.smsProvider,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.smsProvider=t}),title:e.translate("MobileMessaging_Settings_SMSProvider"),options:e.smsProviderOptions,value:e.provider},null,8,["modelValue","title","options","value"])]),Object(i["createVNode"])(s,{provider:e.smsProvider,modelValue:e.credentials,"onUpdate:modelValue":[t[2]||(t[2]=function(t){return e.credentials=t}),t[3]||(t[3]=function(t){e.credentials=t})],"model-value":e.credentials},null,8,["provider","modelValue","model-value"]),Object(i["createVNode"])(d,{id:"apiAccountSubmit",disabled:!e.isUpdateAccountPossible,saving:e.isUpdatingAccount,onConfirm:t[4]||(t[4]=function(t){return e.updateAccount()})},null,8,["disabled","saving"]),Object(i["createElementVNode"])("div",{class:"providerDescription",innerHTML:e.$sanitize(e.currentProviderDescription)},null,8,U)],512),[[i["vShow"],!e.credentialSupplied||e.showAccountForm],[u]])])}var H=Object(i["defineComponent"])({props:{credentialSupplied:Boolean,credentialError:String,provider:String,creditLeft:[Number,String],smsProviderOptions:{type:Object,required:!0},smsProviders:{type:Object,required:!0}},components:{ActivityIndicator:l["ActivityIndicator"],Field:d["Field"],SaveButton:d["SaveButton"],SmsProviderCredentials:b},directives:{Form:d["Form"]},data:function(){return{isDeletingAccount:!1,isUpdatingAccount:!1,showAccountForm:!1,credentials:null,smsProvider:this.provider}},methods:{deleteApiAccount:function(){var e=this;this.isDeletingAccount=!0,l["AjaxHelper"].fetch({method:"MobileMessaging.deleteSMSAPICredential"},{errorElement:"#ajaxErrorManageSmsProviderSettings"}).then((function(){l["Matomo"].helper.redirect()})).finally((function(){e.isDeletingAccount=!1}))},showUpdateAccount:function(){this.showAccountForm=!0},updateAccount:function(){var e=this;this.isUpdateAccountPossible&&(this.isUpdatingAccount=!0,l["AjaxHelper"].post({method:"MobileMessaging.setSMSAPICredential"},{provider:this.smsProvider,credentials:this.credentials},{errorElement:"#ajaxErrorManageSmsProviderSettings"}).then((function(){l["Matomo"].helper.redirect()})).finally((function(){e.isUpdatingAccount=!1})))},deleteAccount:function(){var e=this;l["Matomo"].helper.modalConfirm("#confirmDeleteAccount",{yes:function(){e.isDeletingAccount=!0,l["AjaxHelper"].fetch({method:"MobileMessaging.deleteSMSAPICredential"},{errorElement:"#ajaxErrorManageSmsProviderSettings"}).then((function(){e.isDeletingAccount=!1,l["Matomo"].helper.redirect()})).finally((function(){e.isDeletingAccount=!1}))}})},onUpdateOrDeleteClick:function(e){var t=e.target;"displayAccountForm"===t.id?this.showUpdateAccount():"deleteAccount"===t.id&&this.deleteAccount()}},computed:{isUpdateAccountPossible:function(){return!!this.smsProvider&&null!==this.credentials&&Object.values(this.credentials).every((function(e){return!!e}))},updateOrDeleteAccountText:function(){return Object(l["translate"])("MobileMessaging_Settings_UpdateOrDeleteAccount",'<a id="displayAccountForm">',"</a>",'<a id="deleteAccount">',"</a>")},currentProviderDescription:function(){return this.smsProvider&&this.smsProviders?this.smsProviders[this.smsProvider]:""}}});H.render=$;var T=H;function q(e,t,n,o,r,l){var a=Object(i["resolveComponent"])("Field"),c=Object(i["resolveComponent"])("SaveButton");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(a,{uicontrol:"radio",name:"delegatedManagement",title:e.translate("MobileMessaging_Settings_LetUsersManageAPICredential"),modelValue:e.enabled,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.enabled=t}),"full-width":!0,options:e.delegateManagementOptions},null,8,["title","modelValue","options"])]),Object(i["createVNode"])(c,{onConfirm:t[1]||(t[1]=function(t){return e.save()}),saving:e.isLoading},null,8,["saving"])])}var I=Object(i["defineComponent"])({props:{delegateManagementOptions:{type:Array,required:!0},delegatedManagement:[Number,Boolean]},components:{Field:d["Field"],SaveButton:d["SaveButton"]},data:function(){return{isLoading:!1,enabled:this.delegatedManagement?1:0}},methods:{save:function(){var e=this;this.isLoading=!0,l["AjaxHelper"].post({method:"MobileMessaging.setDelegatedManagement"},{delegatedManagement:this.enabled&&"0"!==this.enabled?"true":"false"}).then((function(){var e=l["NotificationsStore"].show({message:Object(l["translate"])("CoreAdminHome_SettingsSaveSuccess"),id:"mobileMessagingSettings",type:"transient",context:"success"});l["NotificationsStore"].scrollToNotification(e),l["Matomo"].helper.redirect()})).finally((function(){e.isLoading=!1}))}}});I.render=q;var L=I,J={key:0},R={class:"row"},z={class:"col s12"},G={class:"form-group row"},Y={class:"col s12 m6"},K={class:"col s12 m6 form-help"},Q={class:"form-group row addPhoneNumber"},W={class:"col s12 m6"},X={class:"countryCode left"},Z=Object(i["createElementVNode"])("span",{class:"countryCodeSymbol"},"+",-1),ee={class:"phoneNumber left"},te={class:"addNumber left valign-wrapper"},ne={class:"col s12 m6 form-help"},oe=Object(i["createElementVNode"])("div",{id:"ajaxErrorAddPhoneNumber"},null,-1),re={key:1,class:"row"},ie={class:"col s12"},le={class:"col s12 m6"},ae={class:"phoneNumber"},ce=["onUpdate:modelValue","placeholder"],se={key:0,class:"form-help col s12 m6"},de=Object(i["createTextVNode"])(" Â  "),ue=Object(i["createElementVNode"])("div",{id:"invalidVerificationCodeAjaxError",style:{display:"none"}},null,-1);function me(e,t,n,o,r,l){var a=Object(i["resolveComponent"])("Field"),c=Object(i["resolveComponent"])("SaveButton"),s=Object(i["resolveComponent"])("Alert"),d=Object(i["resolveComponent"])("ActivityIndicator");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",null,[Object(i["createElementVNode"])("p",null,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_PhoneNumbers_Help")),1),e.isSuperUser?(Object(i["openBlock"])(),Object(i["createElementBlock"])("p",J,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_DelegatedPhoneNumbersOnlyUsedByYou")),1)):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("div",R,[Object(i["createElementVNode"])("h3",z,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_PhoneNumbers_Add")),1)]),Object(i["createElementVNode"])("div",G,[Object(i["createElementVNode"])("div",Y,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(a,{uicontrol:"select",name:"countryCodeSelect",title:e.translate("MobileMessaging_Settings_SelectCountry"),modelValue:e.countryCallingCode,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.countryCallingCode=t}),"full-width":!0,options:e.countries},null,8,["title","modelValue","options"])])]),Object(i["createElementVNode"])("div",K,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_PhoneNumbers_CountryCode_Help")),1)]),Object(i["createElementVNode"])("div",Q,[Object(i["createElementVNode"])("div",W,[Object(i["createElementVNode"])("div",X,[Z,Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(a,{uicontrol:"text",name:"countryCallingCode",title:e.translate("MobileMessaging_Settings_CountryCode"),modelValue:e.countryCallingCode,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.countryCallingCode=t}),"full-width":!0,maxlength:4},null,8,["title","modelValue"])])]),Object(i["createElementVNode"])("div",ee,[Object(i["createElementVNode"])("div",null,[Object(i["createVNode"])(a,{uicontrol:"text",name:"newPhoneNumber",modelValue:e.newPhoneNumber,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.newPhoneNumber=t}),title:e.translate("MobileMessaging_Settings_PhoneNumber"),"full-width":!0,maxlength:80},null,8,["modelValue","title"])])]),Object(i["createElementVNode"])("div",te,[Object(i["createVNode"])(c,{class:"valign",disabled:!e.canAddNumber||e.isAddingPhonenumber,onConfirm:t[3]||(t[3]=function(t){return e.addPhoneNumber()}),value:e.translate("General_Add")},null,8,["disabled","value"])]),Object(i["withDirectives"])(Object(i["createVNode"])(s,{severity:"warning",id:"suspiciousPhoneNumber"},{default:Object(i["withCtx"])((function(){return[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_SuspiciousPhoneNumber","54184032")),1)]})),_:1},512),[[i["vShow"],e.showSuspiciousPhoneNumber]])]),Object(i["createElementVNode"])("div",ne,Object(i["toDisplayString"])(e.strHelpAddPhone),1)]),oe,Object(i["createVNode"])(d,{loading:e.isAddingPhonenumber},null,8,["loading"]),Object.keys(e.phoneNumbers||{}).length>0?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",re,[Object(i["createElementVNode"])("h3",ie,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_ManagePhoneNumbers")),1)])):Object(i["createCommentVNode"])("",!0),(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.phoneNumbers||[],(function(t,n,o){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:"form-group row",key:o},[Object(i["createElementVNode"])("div",le,[Object(i["createElementVNode"])("span",ae,Object(i["toDisplayString"])(n),1),t||e.isActivated[o]?Object(i["createCommentVNode"])("",!0):Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("input",{key:0,type:"text",class:"verificationCode","onUpdate:modelValue":function(t){return e.validationCode[o]=t},placeholder:e.translate("MobileMessaging_Settings_EnterActivationCode"),style:{"margin-right":"3.5px"}},null,8,ce)),[[i["vModelText"],e.validationCode[o]]]),t||e.isActivated[o]?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createBlock"])(c,{key:1,disabled:!e.validationCode[o]||e.isChangingPhoneNumber,onConfirm:function(t){return e.validateActivationCode(n,o)},value:e.translate("MobileMessaging_Settings_ValidatePhoneNumber")},null,8,["disabled","onConfirm","value"])),Object(i["createVNode"])(c,{disabled:e.isChangingPhoneNumber,onConfirm:function(t){return e.removePhoneNumber(n)},value:e.translate("General_Remove"),style:{"margin-left":"3.5px"}},null,8,["disabled","onConfirm","value"])]),t||e.isActivated[o]?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",se,[Object(i["createElementVNode"])("div",null,Object(i["toDisplayString"])(e.translate("MobileMessaging_Settings_VerificationCodeJustSent")),1),de]))])})),128)),ue,Object(i["createVNode"])(d,{loading:e.isChangingPhoneNumber},null,8,["loading"])])}var be=Object(i["defineComponent"])({props:{isSuperUser:Boolean,defaultCallingCode:String,countries:{type:Array,required:!0},strHelpAddPhone:{type:String,required:!0},phoneNumbers:Object},components:{Field:d["Field"],SaveButton:d["SaveButton"],Alert:l["Alert"],ActivityIndicator:l["ActivityIndicator"]},data:function(){return{isAddingPhonenumber:!1,isChangingPhoneNumber:!1,isActivated:{},countryCallingCode:this.defaultCallingCode||"",newPhoneNumber:"",validationCode:{}}},methods:{validateActivationCode:function(e,t){var n=this;if(this.validationCode[t]){var o=this.validationCode[t];this.isChangingPhoneNumber=!0,l["AjaxHelper"].post({method:"MobileMessaging.validatePhoneNumber"},{phoneNumber:e,verificationCode:o},{errorElement:"#invalidVerificationCodeAjaxError"}).then((function(e){var o;if(n.isChangingPhoneNumber=!1,e&&e.value){var r=Object(l["translate"])("MobileMessaging_Settings_PhoneActivated");o=l["NotificationsStore"].show({message:r,context:"success",id:"MobileMessaging_ValidatePhoneNumber",type:"transient"}),n.isActivated[t]=!0}else{var i=Object(l["translate"])("MobileMessaging_Settings_InvalidActivationCode");o=l["NotificationsStore"].show({message:i,context:"error",id:"MobileMessaging_ValidatePhoneNumber",type:"transient"})}l["NotificationsStore"].scrollToNotification(o)})).finally((function(){n.isChangingPhoneNumber=!1}))}},removePhoneNumber:function(e){var t=this;e&&(this.isChangingPhoneNumber=!0,l["AjaxHelper"].post({method:"MobileMessaging.removePhoneNumber"},{phoneNumber:e},{errorElement:"#invalidVerificationCodeAjaxError"}).then((function(){t.isChangingPhoneNumber=!1,l["Matomo"].helper.redirect()})).finally((function(){t.isChangingPhoneNumber=!1})))},addPhoneNumber:function(){var e=this,t="+".concat(this.countryCallingCode).concat(this.newPhoneNumber);this.canAddNumber&&t.length>1&&(this.isAddingPhonenumber=!0,l["AjaxHelper"].post({method:"MobileMessaging.addPhoneNumber"},{phoneNumber:t},{errorElement:"#ajaxErrorAddPhoneNumber"}).then((function(){e.isAddingPhonenumber=!1,l["Matomo"].helper.redirect()})).finally((function(){e.isAddingPhonenumber=!1})))}},computed:{showSuspiciousPhoneNumber:function(){return 0===this.newPhoneNumber.trim().lastIndexOf("0",0)},canAddNumber:function(){return!!this.newPhoneNumber&&""!==this.newPhoneNumber}}});be.render=me;var pe=be;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["CustomDimensions"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["CustomDimensions"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,n){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/CustomDimensions/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"8bbf":function(e,n){e.exports=t},a5a2:function(e,t){e.exports=n},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"CustomDimensionsStore",(function(){return B})),n.d(t,"Edit",(function(){return P})),n.d(t,"List",(function(){return pe})),n.d(t,"Manage",(function(){return Se})),"undefined"!==typeof window){var i=window.document.currentScript,o=i&&i.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);o&&(n.p=o[1])}var s=n("19dc"),a=n("8bbf"),c={class:"editCustomDimension"},r={class:"loadingPiwik"},l=Object(a["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),u={class:"row form-group"},m={class:"col s12"},d={class:"col s12 m6"},p={class:"row"},b={class:"col s12 m6"},f={class:"col s12 m6"},v={class:"col s12"},O=["onClick"],j={class:"row"},h={class:"col s12"},D={class:"col s12 m6 form-help"},C=["value","disabled"],g=["value","disabled"],V={class:"btn cancel",type:"button",href:"#list"},E={class:"alert alert-info howToTrackInfo"},S=["innerHTML"],N=["innerHTML"],y=["innerHTML"],x=["innerHTML"];function w(e,t,n,i,o,s){var w=Object(a["resolveComponent"])("Field"),k=Object(a["resolveComponent"])("ContentBlock"),_=Object(a["resolveDirective"])("select-on-focus");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",c,[Object(a["createVNode"])(k,{"content-title":e.contentTitleText},{default:Object(a["withCtx"])((function(){var n;return[Object(a["withDirectives"])(Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("span",r,[l,Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[a["vShow"],e.isLoading||e.isUpdating]]),Object(a["withDirectives"])(Object(a["createElementVNode"])("div",null,[Object(a["createElementVNode"])("form",{onSubmit:t[4]||(t[4]=Object(a["withModifiers"])((function(t){return e.edit?e.updateCustomDimension():e.createCustomDimension()}),["prevent"]))},[Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(w,{uicontrol:"text",name:"name",modelValue:e.dimension.name,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.dimension.name=t}),maxlength:255,required:!0,title:e.translate("General_Name"),"inline-help":e.translate("CustomDimensions_NameAllowedCharacters")},null,8,["modelValue","title","inline-help"])]),Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(w,{uicontrol:"checkbox",name:"active",modelValue:e.dimension.active,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.dimension.active=t}),title:e.translate("CorePluginsAdmin_Active"),"inline-help":e.translate("CustomDimensions_CannotBeDeleted")},null,8,["modelValue","title","inline-help"])]),Object(a["withDirectives"])(Object(a["createElementVNode"])("div",u,[Object(a["createElementVNode"])("h3",m,Object(a["toDisplayString"])(e.translate("CustomDimensions_ExtractValue")),1),Object(a["createElementVNode"])("div",d,[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e.dimension.extractions,(function(n,i){return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{class:Object(a["normalizeClass"])("".concat(i,"extraction ")),key:i},[Object(a["createElementVNode"])("div",p,[Object(a["createElementVNode"])("div",b,[Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(w,{uicontrol:"select",name:"".concat(i,"dimension"),modelValue:n.dimension,"onUpdate:modelValue":function(e){return n.dimension=e},"full-width":!0,options:e.extractionDimensionsOptions},null,8,["name","modelValue","onUpdate:modelValue","options"])])]),Object(a["createElementVNode"])("div",f,[Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(w,{uicontrol:"text",name:"".concat(i,"pattern"),modelValue:n.pattern,"onUpdate:modelValue":function(e){return n.pattern=e},"full-width":!0,title:"urlparam"===n.dimension?e.translate("CustomDimensions_UrlQueryStringParameter"):"eg. /blog/(.*)/"},null,8,["name","modelValue","onUpdate:modelValue","title"])])]),Object(a["createElementVNode"])("div",v,[Object(a["withDirectives"])(Object(a["createElementVNode"])("span",{class:"icon-plus",onClick:t[2]||(t[2]=function(t){return e.addExtraction()})},null,512),[[a["vShow"],n.pattern]]),Object(a["withDirectives"])(Object(a["createElementVNode"])("span",{class:"icon-minus",onClick:function(t){return e.removeExtraction(i)}},null,8,O),[[a["vShow"],e.dimension.extractions.length>1]])])])],2)})),128)),Object(a["createElementVNode"])("div",j,[Object(a["createElementVNode"])("div",h,[Object(a["createElementVNode"])("div",null,[Object(a["withDirectives"])(Object(a["createVNode"])(w,{uicontrol:"checkbox",name:"casesensitive",modelValue:e.dimension.case_sensitive,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.dimension.case_sensitive=t}),title:e.translate("Goals_CaseSensitive")},null,8,["modelValue","title"]),[[a["vShow"],null===(n=e.dimension.extractions[0])||void 0===n?void 0:n.pattern]])])])])]),Object(a["createElementVNode"])("div",D,Object(a["toDisplayString"])(e.translate("CustomDimensions_ExtractionsHelp")),1)],512),[[a["vShow"],e.doesScopeSupportExtraction]]),Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{class:"btn update",type:"submit",value:e.translate("General_Update"),disabled:e.isUpdating,style:{"margin-right":"3.5px"}},null,8,C),[[a["vShow"],e.edit]]),Object(a["withDirectives"])(Object(a["createElementVNode"])("input",{class:"btn create",type:"submit",value:e.translate("General_Create"),disabled:e.isUpdating,style:{"margin-right":"3.5px"}},null,8,g),[[a["vShow"],e.create]]),Object(a["createElementVNode"])("a",V,Object(a["toDisplayString"])(e.translate("General_Cancel")),1)],32),Object(a["withDirectives"])(Object(a["createElementVNode"])("div",E,[Object(a["createElementVNode"])("strong",null,Object(a["toDisplayString"])(e.translate("CustomDimensions_HowToTrackManuallyTitle")),1),Object(a["createElementVNode"])("p",null,Object(a["toDisplayString"])(e.translate("CustomDimensions_HowToTrackManuallyViaJs")),1),Object(a["withDirectives"])(Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{innerHTML:e.$sanitize(e.manuallyTrackCodeViaJs(e.dimension))},null,8,S)],512),[[_,{}]]),Object(a["createElementVNode"])("p",{innerHTML:e.$sanitize(e.howToTrackManuallyText)},null,8,N),Object(a["createElementVNode"])("p",null,Object(a["toDisplayString"])(e.translate("CustomDimensions_HowToTrackManuallyViaPhp")),1),Object(a["withDirectives"])(Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{innerHTML:e.$sanitize(e.manuallyTrackCodeViaPhp(e.dimension))},null,8,y)],512),[[_,{}]]),Object(a["createElementVNode"])("p",null,Object(a["toDisplayString"])(e.translate("CustomDimensions_HowToTrackManuallyViaHttp")),1),Object(a["withDirectives"])(Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{innerHTML:e.$sanitize(e.manuallyTrackCode)},null,8,x)],512),[[_,{}]])],512),[[a["vShow"],e.edit]])],512),[[a["vShow"],!e.isLoading]])]})),_:1},8,["content-title"])])}var k=n("a5a2");function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function M(e,t,n){return t&&T(e.prototype,t),n&&T(e,n),e}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var U=function(){function e(){var t=this;_(this,e),A(this,"privateState",Object(a["reactive"])({customDimensions:[],availableScopes:[],extractionDimensions:[],isLoading:!1,isUpdating:!1})),A(this,"state",Object(a["computed"])((function(){return Object(a["readonly"])(t.privateState)}))),A(this,"isLoading",Object(a["computed"])((function(){return t.state.value.isLoading}))),A(this,"isUpdating",Object(a["computed"])((function(){return t.state.value.isUpdating}))),A(this,"extractionDimensions",Object(a["computed"])((function(){return t.state.value.extractionDimensions}))),A(this,"extractionDimensionsOptions",Object(a["computed"])((function(){return t.extractionDimensions.value.map((function(e){return{key:e.value,value:e.name}}))}))),A(this,"availableScopes",Object(a["computed"])((function(){return t.state.value.availableScopes}))),A(this,"customDimensions",Object(a["computed"])((function(){return t.state.value.customDimensions}))),A(this,"customDimensionsById",Object(a["computed"])((function(){var e={};return t.customDimensions.value.forEach((function(t){e["".concat(t.idcustomdimension)]=t})),e}))),A(this,"reloadPromise",null)}return M(e,[{key:"reload",value:function(){return this.privateState.customDimensions=[],this.privateState.availableScopes=[],this.privateState.extractionDimensions=[],this.reloadPromise=null,this.fetch()}},{key:"fetch",value:function(){var e=this;return this.reloadPromise||(this.privateState.isLoading=!0,this.reloadPromise=Promise.all([this.fetchConfiguredCustomDimensions(),this.fetchAvailableExtractionDimensions(),this.fetchAvailableScopes()]).finally((function(){e.privateState.isLoading=!1}))),this.reloadPromise}},{key:"fetchConfiguredCustomDimensions",value:function(){var e=this;return s["AjaxHelper"].fetch({method:"CustomDimensions.getConfiguredCustomDimensions",filter_limit:"-1"}).then((function(t){e.privateState.customDimensions=t}))}},{key:"fetchAvailableExtractionDimensions",value:function(){var e=this;return s["AjaxHelper"].fetch({method:"CustomDimensions.getAvailableExtractionDimensions",filter_limit:"-1"}).then((function(t){e.privateState.extractionDimensions=t}))}},{key:"fetchAvailableScopes",value:function(){var e=this;return s["AjaxHelper"].fetch({method:"CustomDimensions.getAvailableScopes",filter_limit:"-1"}).then((function(t){e.privateState.availableScopes=t}))}},{key:"createOrUpdateDimension",value:function(e,t){var n=this;return this.privateState.isUpdating=!0,s["AjaxHelper"].post({method:t,scope:e.scope,idDimension:e.idcustomdimension,idSite:e.idsite,name:e.name,active:e.active?"1":"0",caseSensitive:e.case_sensitive?"1":"0"},{extractions:e.extractions}).finally((function(){n.privateState.isUpdating=!1}))}}]),e}(),B=new U;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
function L(e){return"".concat(e[0].toUpperCase()).concat(e.slice(1))}var H="customdimensions",I=Object(a["defineComponent"])({props:{dimensionId:Number,dimensionScope:{type:String,required:!0}},components:{ContentBlock:s["ContentBlock"],Field:k["Field"]},directives:{SelectOnFocus:s["SelectOnFocus"]},data:function(){return{dimension:{extractions:[]},isUpdatingDim:!1}},created:function(){this.init()},watch:{dimensionId:function(){this.init()}},methods:{removeAnyCustomDimensionNotification:function(){s["NotificationsStore"].remove(H)},showNotification:function(e,t){s["NotificationsStore"].show({message:e,context:t,id:H,type:"transient"})},init:function(){var e=this;null!==this.dimensionId&&this.removeAnyCustomDimensionNotification(),B.fetch().then((function(){e.edit&&e.dimensionId?(e.dimension=Object(s["clone"])(B.customDimensionsById.value[e.dimensionId]),e.dimension&&!e.dimension.extractions.length&&e.addExtraction()):e.create&&(e.dimension={idsite:s["Matomo"].idSite,name:"",active:!1,extractions:[],scope:e.dimensionScope,case_sensitive:!0},e.addExtraction())}))},removeExtraction:function(e){e>-1&&this.dimension.extractions.splice(e,1)},addExtraction:function(){this.doesScopeSupportExtraction&&this.dimension.extractions.push({dimension:"url",pattern:""})},createCustomDimension:function(){var e=this;this.isUpdatingDim=!0,B.createOrUpdateDimension(this.dimension,"CustomDimensions.configureNewCustomDimension").then((function(){e.showNotification(Object(s["translate"])("CustomDimensions_DimensionCreated"),"success"),B.reload(),s["MatomoUrl"].updateHashToUrl("/list")})).finally((function(){e.isUpdatingDim=!1}))},updateCustomDimension:function(){var e=this;this.isUpdatingDim=!0,B.createOrUpdateDimension(this.dimension,"CustomDimensions.configureExistingCustomDimension").then((function(){e.showNotification(Object(s["translate"])("CustomDimensions_DimensionUpdated"),"success"),B.reload(),s["MatomoUrl"].updateHashToUrl("/list")})).finally((function(){e.isUpdatingDim=!1}))},manuallyTrackCodeViaJs:function(e){return"_paq.push(['setCustomDimension', ".concat(e.idcustomdimension,", ")+"'".concat(Object(s["translate"])("CustomDimensions_ExampleValue"),"']);")},manuallyTrackCodeViaPhp:function(e){return"$tracker->setCustomDimension('".concat(e.idcustomdimension,"', ")+"'".concat(Object(s["translate"])("CustomDimensions_ExampleValue"),"');")}},computed:{isLoading:function(){return B.isLoading.value},isUpdating:function(){return B.isUpdating.value||this.isUpdatingDim},create:function(){return 0===this.dimensionId},edit:function(){return!this.create},extractionDimensionsOptions:function(){return B.extractionDimensionsOptions.value},availableScopes:function(){return B.availableScopes.value},doesScopeSupportExtraction:function(){var e,t=this;if(null===(e=this.dimension)||void 0===e||!e.scope||!this.availableScopes)return!1;var n=this.availableScopes.find((function(e){return e.value===t.dimension.scope}));return null===n||void 0===n?void 0:n.supportsExtractions},contentTitleText:function(){var e;return Object(s["translate"])("CustomDimensions_ConfigureDimension",L(this.dimensionScope),"".concat((null===(e=this.dimension)||void 0===e?void 0:e.index)||""))},howToTrackManuallyText:function(){var e="https://developer.piwik.org/guides/tracking-javascript-guide#custom-dimensions";return Object(s["translate"])("CustomDimensions_HowToTrackManuallyViaJsDetails",'<a target=_blank href="'.concat(e,'" rel="noreferrer noopener">'),"</a>")},manuallyTrackCode:function(){var e=Object(s["translate"])("CustomDimensions_ExampleValue");return"&dimension".concat(this.dimension.idcustomdimension,"=").concat(e)}}});I.render=w;var P=I,q=(Object(s["createAngularJsAdapter"])({component:P,scope:{dimensionId:{angularJsBind:"=",transform:s["transformAngularJsIntAttr"]},dimensionScope:{angularJsBind:"="}},directiveName:"piwikCustomDimensionsEdit"}),["innerHTML"]),z={class:"loadingPiwik"},F=Object(a["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),G={class:"index"},J={class:"name"},$={class:"active"},Q={class:"action"},X={colspan:"5"},Y={class:"index"},K={class:"name"},R={class:"extractions"},W={class:"active"},Z={class:"action"},ee=["href"],te={class:"tableActionBar"},ne=["disabled","onClick"],ie=Object(a["createElementVNode"])("span",{class:"icon-add"},null,-1),oe={class:"info"};
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function se(e,t,n,i,o,s){var c=Object(a["resolveComponent"])("EnrichedHeadline"),r=Object(a["resolveComponent"])("ContentBlock"),l=Object(a["resolveDirective"])("content-intro"),u=Object(a["resolveDirective"])("content-table");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",null,[Object(a["withDirectives"])(Object(a["createElementVNode"])("div",null,[Object(a["createElementVNode"])("h2",null,[Object(a["createVNode"])(c,null,{default:Object(a["withCtx"])((function(){return[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.translate("CustomDimensions_CustomDimensions")),1)]})),_:1})]),Object(a["createElementVNode"])("p",{innerHTML:e.$sanitize(e.contentIntroText)},null,8,q),Object(a["withDirectives"])(Object(a["createElementVNode"])("p",null,[Object(a["createElementVNode"])("span",z,[F,Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[a["vShow"],e.isLoading]])],512),[[l]]),(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e.availableScopes,(function(t){return Object(a["withDirectives"])((Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{key:t.value},[Object(a["createVNode"])(r,{"content-title":"".concat(t.name," Dimensions")},{default:Object(a["withCtx"])((function(){return[Object(a["createElementVNode"])("p",null,Object(a["toDisplayString"])(e.translate("CustomDimensions_ScopeDescription".concat(e.ucfirst(t.value))))+" "+Object(a["toDisplayString"])(e.translate("CustomDimensions_ScopeDescription".concat(e.ucfirst(t.value),"MoreInfo"))),1),Object(a["withDirectives"])(Object(a["createElementVNode"])("table",null,[Object(a["createElementVNode"])("thead",null,[Object(a["createElementVNode"])("tr",null,[Object(a["createElementVNode"])("th",G,Object(a["toDisplayString"])(e.translate("General_Id")),1),Object(a["createElementVNode"])("th",J,Object(a["toDisplayString"])(e.translate("General_Name")),1),Object(a["withDirectives"])(Object(a["createElementVNode"])("th",{class:"extractions"},Object(a["toDisplayString"])(e.translate("CustomDimensions_Extractions")),513),[[a["vShow"],t.supportsExtractions]]),Object(a["createElementVNode"])("th",$,Object(a["toDisplayString"])(e.translate("CorePluginsAdmin_Active")),1),Object(a["createElementVNode"])("th",Q,Object(a["toDisplayString"])(e.translate("General_Action")),1)])]),Object(a["createElementVNode"])("tbody",null,[Object(a["withDirectives"])(Object(a["createElementVNode"])("tr",null,[Object(a["createElementVNode"])("td",X,Object(a["toDisplayString"])(e.translate("CustomDimensions_NoCustomDimensionConfigured")),1)],512),[[a["vShow"],0===t.numSlotsUsed&&!e.isLoading]]),(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e.sortedCustomDimensionsByScope[t.value],(function(e){var n;return Object(a["openBlock"])(),Object(a["createElementBlock"])("tr",{class:Object(a["normalizeClass"])(["customdimension",e.idcustomdimension]),key:e.idcustomdimension},[Object(a["createElementVNode"])("td",Y,Object(a["toDisplayString"])(e.idcustomdimension),1),Object(a["createElementVNode"])("td",K,Object(a["toDisplayString"])(e.name),1),Object(a["withDirectives"])(Object(a["createElementVNode"])("td",R,[Object(a["createElementVNode"])("span",{class:Object(a["normalizeClass"])({"icon-ok":null===(n=e.extractions[0])||void 0===n?void 0:n.pattern})},null,2)],512),[[a["vShow"],t.supportsExtractions]]),Object(a["createElementVNode"])("td",W,[Object(a["createElementVNode"])("span",{class:Object(a["normalizeClass"])({"icon-ok":e.active})},null,2)]),Object(a["createElementVNode"])("td",Z,[Object(a["createElementVNode"])("a",{class:"table-action icon-edit",href:"#?idDimension=".concat(e.idcustomdimension,"&scope=").concat(t.value)},null,8,ee)])],2)})),128))])],512),[[u]]),Object(a["createElementVNode"])("div",te,[Object(a["withDirectives"])(Object(a["createElementVNode"])("button",{class:"btn",disabled:!t.numSlotsLeft,onClick:function(n){return e.addDimension(t.value)}},[ie,Object(a["createTextVNode"])(" "+Object(a["toDisplayString"])(e.translate("CustomDimensions_ConfigureNewDimension"))+" ",1),Object(a["createElementVNode"])("span",oe,"("+Object(a["toDisplayString"])(e.translate("CustomDimensions_XofYLeft",t.numSlotsLeft,t.numSlotsAvailable))+")",1)],8,ne),[[a["vShow"],!e.isLoading]])])]})),_:2},1032,["content-title"])],512)),[[a["vShow"],!e.isLoading]])})),128))])}function ae(e){return ue(e)||le(e)||re(e)||ce()}function ce(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function re(e,t){if(e){if("string"===typeof e)return me(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?me(e,t):void 0}}function le(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function ue(e){if(Array.isArray(e))return me(e)}function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var de=Object(a["defineComponent"])({name:"listcustomdimensions",components:{EnrichedHeadline:s["EnrichedHeadline"],ContentBlock:s["ContentBlock"]},directives:{ContentIntro:s["ContentIntro"],ContentTable:s["ContentTable"]},created:function(){B.fetch()},methods:{ucfirst:function(e){return L(e)},addDimension:function(e){s["MatomoUrl"].updateHashToUrl("/?idDimension=0&scope=".concat(e))}},computed:{isLoading:function(){return B.isLoading.value},availableScopes:function(){return B.availableScopes.value},contentIntroText:function(){var e=Object(s["translate"])("CustomDimensions_CustomDimensionsIntroNext",'<a target=_blank href="https://piwik.org/docs/custom-variables">',"</a>",'<a target=_blank href="https://piwik.org/faq/general/faq_21117">',"</a>"),t=Object(s["translate"])("CustomDimensions_CustomDimensionsIntro",'<a target=_blank href="https://piwik.org/docs/custom-dimensions">',"</a>",this.siteName);return"".concat(e).concat(t)},customDimensions:function(){return B.customDimensions.value},sortedCustomDimensions:function(){var e=ae(this.customDimensions);return e.sort((function(e,t){var n=parseInt("".concat(e.idcustomdimension),10),i=parseInt("".concat(t.idcustomdimension),10);return n-i})),e},sortedCustomDimensionsByScope:function(){var e={};return this.sortedCustomDimensions.reduce((function(e,t){return e[t.scope]=e[t.scope]||[],e[t.scope].push(t),e}),e),e},siteName:function(){return s["Matomo"].helper.htmlDecode(s["Matomo"].siteName)}}});de.render=se;var pe=de,be=(Object(s["createAngularJsAdapter"])({component:pe,directiveName:"piwikCustomDimensionsList"}),{class:"manageCustomDimensions"}),fe={key:0},ve=Object(a["createElementVNode"])("br",null,null,-1),Oe=Object(a["createElementVNode"])("br",null,null,-1),je=Object(a["createElementVNode"])("br",null,null,-1),he=Object(a["createElementVNode"])("br",null,null,-1),De=["textContent"],Ce=["textContent"],ge={key:1};
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function Ve(e,t,n,i,o,s){var c=Object(a["resolveComponent"])("CustomDimensionsList"),r=Object(a["resolveComponent"])("ContentBlock"),l=Object(a["resolveComponent"])("CustomDimensionsEdit"),u=Object(a["resolveDirective"])("select-on-focus");return Object(a["openBlock"])(),Object(a["createElementBlock"])("div",be,[e.editMode?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",fe,[Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(c)]),Object(a["createVNode"])(r,{id:"customDimensionsCreateMoreDimensions","content-title":e.translate("CustomDimensions_IncreaseAvailableCustomDimensionsTitle")},{default:Object(a["withCtx"])((function(){return[Object(a["createElementVNode"])("p",null,[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.translate("CustomDimensions_IncreaseAvailableCustomDimensionsTakesLong"))+" ",1),ve,Oe,Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.translate("CustomDimensions_HowToCreateCustomDimension"))+" ",1),je,he]),Object(a["withDirectives"])(Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{textContent:Object(a["toDisplayString"])(e.addCustomDimCode)},null,8,De)],512),[[u,{}]]),Object(a["createElementVNode"])("p",null,Object(a["toDisplayString"])(e.translate("CustomDimensions_HowToManyCreateCustomDimensions"))+" "+Object(a["toDisplayString"])(e.translate("CustomDimensions_ExampleCreateCustomDimensions",5)),1),Object(a["withDirectives"])(Object(a["createElementVNode"])("pre",null,[Object(a["createElementVNode"])("code",{textContent:Object(a["toDisplayString"])(e.addMultipleCustomDimCode)},null,8,Ce)],512),[[u,{}]])]})),_:1},8,["content-title"])])),e.editMode?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",ge,[Object(a["createElementVNode"])("div",null,[Object(a["createVNode"])(l,{"dimension-id":e.dimensionId,"dimension-scope":e.dimensionScope},null,8,["dimension-id","dimension-scope"])])])):Object(a["createCommentVNode"])("",!0)])}var Ee=Object(a["defineComponent"])({components:{CustomDimensionsList:pe,ContentBlock:s["ContentBlock"],CustomDimensionsEdit:P},directives:{SelectOnFocus:s["SelectOnFocus"]},data:function(){return{editMode:!1,dimensionId:null,dimensionScope:""}},created:function(){var e=this;Object(a["watch"])((function(){return s["MatomoUrl"].hashParsed.value}),(function(){e.initState()})),this.initState()},methods:{getValidDimensionScope:function(e){return-1!==["action","visit"].indexOf(e)?e:""},initState:function(){var e=s["MatomoUrl"].hashParsed.value.idDimension;if(e){var t=this.getValidDimensionScope(s["MatomoUrl"].hashParsed.value.scope);if("0"===e){var n={isAllowed:!0,scope:t};if(s["Matomo"].postEvent("CustomDimensions.initAddDimension",n),n&&!n.isAllowed)return this.editMode=!1,this.dimensionId=null,void(this.dimensionScope="")}this.editMode=!0,this.dimensionId=parseInt(e,10),this.dimensionScope=t}else this.editMode=!1,this.dimensionId=null,this.dimensionScope="";s["Matomo"].helper.lazyScrollToContent()}},computed:{addCustomDimCode:function(){return"./console customdimensions:add-custom-dimension --scope=action\n./console customdimensions:add-custom-dimension --scope=visit"},addMultipleCustomDimCode:function(){return"./console customdimensions:add-custom-dimension --scope=action --count=5"}}});Ee.render=Ve;var Se=Ee;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */Object(s["createAngularJsAdapter"])({component:Se,directiveName:"piwikCustomDimensionsManage"})}})}));
//# 
(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):"function"===typeof define&&define.amd?define(["CoreHome",,"CorePluginsAdmin"],t):"object"===typeof exports?exports["TagManager"]=t(require("CoreHome"),require("vue"),require("CorePluginsAdmin")):e["TagManager"]=t(e["CoreHome"],e["Vue"],e["CorePluginsAdmin"])})("undefined"!==typeof self?self:this,(function(e,t,n){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="plugins/TagManager/vue/dist/",n(n.s="fae3")}({"19dc":function(t,n){t.exports=e},"8bbf":function(e,n){e.exports=t},a5a2:function(e,t){e.exports=n},fae3:function(e,t,n){"use strict";if(n.r(t),n.d(t,"ImportVersion",(function(){return p})),n.d(t,"VariableSelect",(function(){return G})),n.d(t,"VariableSelectType",(function(){return ne})),n.d(t,"FieldTextareaVariable",(function(){return Og})),n.d(t,"FieldVariableTemplate",(function(){return Mg})),n.d(t,"FieldVariableTypeTemplate",(function(){return Lg})),n.d(t,"VariableEdit",(function(){return at})),n.d(t,"VariableList",(function(){return Jt})),n.d(t,"VariableManage",(function(){return Yt})),n.d(t,"TriggerEdit",(function(){return zn})),n.d(t,"TriggerList",(function(){return Sa})),n.d(t,"TriggerManage",(function(){return Da})),n.d(t,"TagEdit",(function(){return Hr})),n.d(t,"TagList",(function(){return Co})),n.d(t,"TagManage",(function(){return Mo})),n.d(t,"VersionEdit",(function(){return Pl})),n.d(t,"VersionList",(function(){return Dc})),n.d(t,"VersionManage",(function(){return Ic})),n.d(t,"ContainerEdit",(function(){return us})),n.d(t,"ContainerList",(function(){return zs})),n.d(t,"ContainerManage",(function(){return Ys})),n.d(t,"ContainerDashboard",(function(){return Rd})),n.d(t,"ContainerSelector",(function(){return tu})),n.d(t,"ManageInstallTagCode",(function(){return xu})),n.d(t,"TagmanagerTrackingCode",(function(){return ug})),n.d(t,"Debugging",(function(){return Yb})),"undefined"!==typeof window){var a=window.document.currentScript,i=a&&a.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);i&&(n.p=i[1])}var r=n("19dc"),o=n("8bbf"),l={class:"tagManagerImportVersion"},c={class:"ui-confirm",id:"confirmImportContainerVersion",ref:"confirmImportContainerVersion"},s=["value"],d=["value"];function u(e,t,n,a,i,r){var u=Object(o["resolveComponent"])("ActivityIndicator"),g=Object(o["resolveComponent"])("Field"),b=Object(o["resolveComponent"])("SaveButton"),m=Object(o["resolveComponent"])("ContentBlock");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",l,[Object(o["createVNode"])(m,{"content-title":e.translate("TagManager_ImportVersion")},{default:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("p",null,Object(o["toDisplayString"])(e.translate("TagManager_VersionImportInfo")),1),Object(o["createVNode"])(u,{loading:e.isUpdating,"loading-message":e.translate("TagManager_UpdatingData")},null,8,["loading","loading-message"]),Object(o["createElementVNode"])("div",null,[Object(o["createVNode"])(g,{uicontrol:"text",modelValue:e.backupName,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.backupName=t}),name:"backupName",placeholder:" ",title:e.backupNameTitle,"inline-help":e.translate("TagManager_BackupVersionNameHelp")},null,8,["modelValue","title","inline-help"])]),Object(o["createElementVNode"])("div",null,[Object(o["createVNode"])(g,{uicontrol:"textarea",modelValue:e.importContent,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.importContent=t}),name:"importContent",placeholder:" ","full-width":!0,title:e.translate("TagManager_VersionImportContentTitle")},null,8,["modelValue","title"])]),Object(o["createVNode"])(b,{class:"importVersion",disabled:!e.importContent,onConfirm:t[2]||(t[2]=function(t){return e.importVersion(e.backupName,e.importContent)}),value:e.translate("TagManager_VersionImportOverwriteContent")},null,8,["disabled","value"])]})),_:1},8,["content-title"]),Object(o["createElementVNode"])("div",c,[Object(o["createElementVNode"])("h2",null,Object(o["toDisplayString"])(e.translate("TagManager_ConfirmImportContainerVersion")),1),Object(o["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,s),Object(o["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,d)],512)])}var g=n("a5a2"),b="importContainerVersion",m=Object(o["defineComponent"])({props:{idContainer:{type:String,required:!0}},components:{ContentBlock:r["ContentBlock"],ActivityIndicator:r["ActivityIndicator"],Field:g["Field"],SaveButton:g["SaveButton"]},data:function(){return{isUpdating:!1,backupName:"",importContent:""}},methods:{showNotification:function(e,t){var n=r["NotificationsStore"].show({message:e,context:t,type:"transient",id:b});setTimeout((function(){r["NotificationsStore"].scrollToNotification(n)}),200)},importVersion:function(e,t){var n=this;if(t){var a;try{a=JSON.parse(t)}catch(i){return void this.showNotification(Object(r["translate"])("TagManager_ErrorInvalidContainerImportFormat"),"error")}"tags"in a&&"triggers"in a&&"variables"in a&&"idcontainer"in a&&"context"in a?r["Matomo"].helper.modalConfirm(this.$refs.confirmImportContainerVersion,{yes:function(){n.isUpdating=!0;var e={exportedContainerVersion:t};r["AjaxHelper"].post({method:"TagManager.importContainerVersion",idContainer:n.idContainer,backupName:n.backupName},e).then((function(){n.showNotification(Object(r["translate"])("TagManager_VersionImportSuccess"),"success"),n.isUpdating=!1,window.location.reload()})).catch((function(){n.isUpdating=!1}))}}):this.showNotification(Object(r["translate"])("TagManager_ErrorContainerVersionImportIncomplete"),"error")}}},computed:{backupNameTitle:function(){return"".concat(Object(r["translate"])("TagManager_BackupVersionName")," (").concat(Object(r["translate"])("General_Recommended"),")")}}});m.render=u;var p=m,v=(Object(r["createAngularJsAdapter"])({component:p,scope:{idContainer:{angularJsBind:"="}},directiveName:"piwikImportVersion"}),{class:"tagManagerManageSelect tagManagerVariableSelect"}),f={class:"tableActionBar"},h=Object(o["createElementVNode"])("span",{class:"icon-add"},null,-1),j={class:"collection with-header"},O={class:"collection-header"},V=["onClick"],y={class:"title"},T={class:"secondary-content"},C=["onClick","title"],N={class:"collection-header"},E=["onClick"],k={class:"title"},S={class:"secondary-content"},w=["title"],M={class:"tableActionBar"},_=Object(o["createElementVNode"])("span",{class:"icon-add"},null,-1);
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function D(e,t,n,a,i,r){var l=Object(o["resolveComponent"])("ActivityIndicator");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",v,[Object(o["createVNode"])(l,{loading:e.isLoading},null,8,["loading"]),Object(o["createElementVNode"])("div",f,[Object(o["withDirectives"])(Object(o["createElementVNode"])("a",{class:"createNewVariable",onClick:t[0]||(t[0]=function(t){return e.createVariable()})},[h,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("TagManager_CreateNewX",e.translate("TagManager_Variable"))),1)],512),[[o["vShow"],!e.isLoading]])]),Object(o["createElementVNode"])("ul",j,[Object(o["createElementVNode"])("li",O,[Object(o["createElementVNode"])("h4",null,Object(o["toDisplayString"])(e.translate("TagManager_CustomVariables")),1)]),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.containerVariables,(function(t,n){return Object(o["openBlock"])(),Object(o["createElementBlock"])("li",{class:"collection-item",onClick:function(n){return e.selectVariable(t)},key:n},[Object(o["createElementVNode"])("span",y,Object(o["toDisplayString"])(t.name)+" ("+Object(o["toDisplayString"])(e.translate("TagManager_Type"))+": "+Object(o["toDisplayString"])(t.type)+") ",1),Object(o["createElementVNode"])("span",T,[Object(o["createElementVNode"])("i",{class:"icon-edit",onClick:Object(o["withModifiers"])((function(n){return e.editVariable(t)}),["stop"]),title:e.translate("General_Edit")},null,8,C)])],8,V)})),128))]),Object(o["createElementVNode"])("h2",null,Object(o["toDisplayString"])(e.translate("TagManager_PreconfiguredVariables")),1),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.preconfiguredVariables,(function(t){return Object(o["openBlock"])(),Object(o["createElementBlock"])("ul",{class:"collection with-header",key:t.name},[Object(o["createElementVNode"])("li",N,[Object(o["createElementVNode"])("h4",null,Object(o["toDisplayString"])(t.name),1)]),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(t.types,(function(t,n){return Object(o["withDirectives"])((Object(o["openBlock"])(),Object(o["createElementBlock"])("li",{class:"collection-item",key:n,onClick:function(n){return e.selectVariable(t)}},[Object(o["createElementVNode"])("span",k,Object(o["toDisplayString"])(t.name),1),Object(o["withDirectives"])(Object(o["createElementVNode"])("span",S,[Object(o["createElementVNode"])("i",{class:"icon-help",title:t.description},null,8,w)],512),[[o["vShow"],!!t.description]])],8,E)),[[o["vShow"],t.is_pre_configured]])})),128))])})),128)),Object(o["createElementVNode"])("div",M,[Object(o["withDirectives"])(Object(o["createElementVNode"])("a",{class:"createNewVariable",onClick:t[1]||(t[1]=function(t){return e.createVariable()})},[_,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("TagManager_CreateNewX",e.translate("TagManager_Variable"))),1)],512),[[o["vShow"],!e.isLoading]])])])}function A(e){return x(e)||L(e)||U(e)||B()}function B(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function U(e,t){if(e){if("string"===typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(e,t):void 0}}function L(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function x(e){if(Array.isArray(e))return I(e)}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var P=window,F=P.tagManagerHelper,H=Object(o["defineComponent"])({props:{idContainer:{type:String,required:!0},idContainerVersion:Number},components:{ActivityIndicator:r["ActivityIndicator"]},data:function(){return{preconfiguredVariables:[],containerVariables:[],isLoading:!1,actualIdContainerVersion:this.idContainerVersion}},emits:["selectVariable"],created:function(){this.fetchAvailableVariables()},watch:{idContainerVersion:function(e){this.actualIdContainerVersion=e}},methods:{fetchAvailableVariables:function(){var e=this;this.preconfiguredVariables=[],this.containerVariables=[],this.fetchContainer().then((function(t){return e.isLoading=!0,e.actualIdContainerVersion=t.draft.idcontainerversion,r["AjaxHelper"].fetch({method:"TagManager.getAvailableContainerVariables",filter_limit:"-1",idContainer:e.idContainer,idContainerVersion:e.actualIdContainerVersion}).then((function(t){e.preconfiguredVariables=[],e.containerVariables=[],e.isLoading=!1,t.forEach((function(t){var n,a=Object.assign(Object.assign({},t),{},{types:t.types.filter((function(e){return e.is_pre_configured}))});(n=e.containerVariables).push.apply(n,A(t.types.filter((function(e){return!e.is_pre_configured})))),a.types.length&&e.preconfiguredVariables.push(a)}))})).catch((function(){e.isLoading=!1}))}))},editVariable:function(e){var t=this;this.actualIdContainerVersion&&F.editVariable(null,this.idContainer,this.actualIdContainerVersion,e.idvariable,(function(){t.fetchAvailableVariables()}))},createVariable:function(){var e=this;this.actualIdContainerVersion&&F.editVariable(null,this.idContainer,this.actualIdContainerVersion,0,(function(){e.fetchAvailableVariables()}))},selectVariable:function(e){this.$emit("selectVariable",{variable:e})},fetchContainer:function(){return this.isLoading=!0,r["AjaxHelper"].fetch({method:"TagManager.getContainer",filter_limit:"-1",idContainer:this.idContainer})}}});H.render=D;var G=H,R=(Object(r["createAngularJsAdapter"])({component:G,scope:{idContainer:{angularJsBind:"="},idContainerVersion:{angularJsBind:"="},onSelectVariable:{angularJsBind:"&?",vue:"selectVariable"}},directiveName:"piwikVariableSelect"}),{class:"tagManagerManageSelect tagManagerVariableSelectType"}),J=Object(o["createElementVNode"])("span",{class:"icon-add"},null,-1);
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function q(e,t,n,a,i,r){var l=Object(o["resolveComponent"])("Field");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",R,[Object(o["createElementVNode"])("div",null,[Object(o["createVNode"])(l,{uicontrol:"select",name:"variableType".concat(e.variableType),class:"selectVariableType","model-value":e.modelValue,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.onChange(t)}),"full-width":!0,options:e.containerVariables},null,8,["name","model-value","options"])]),Object(o["withDirectives"])(Object(o["createElementVNode"])("a",{class:"createNewVariable",onClick:t[1]||(t[1]=Object(o["withModifiers"])((function(t){return e.createVariable()}),["prevent"]))},[J,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("TagManager_CreateNewX",e.variableTypeName)),1)],512),[[o["vShow"],!e.isLoading]])])}function z(e){return Y(e)||K(e)||X(e)||W()}function W(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function X(e,t){if(e){if("string"===typeof e)return Q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Q(e,t):void 0}}function K(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Y(e){if(Array.isArray(e))return Q(e)}function Q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Z=window,ee=Z.tagManagerHelper,te=Object(o["defineComponent"])({props:{variableTypeName:{type:String,required:!0},modelValue:String,variableType:String},components:{Field:g["Field"]},emits:["update:modelValue"],data:function(){return{containerVariables:[],isLoading:!1,idContainerVersion:null}},created:function(){this.fetchAvailableVariables()},methods:{fetchAvailableVariables:function(){var e=this;this.containerVariables=[],this.fetchContainer().then((function(t){return e.isLoading=!0,e.idContainerVersion=t.draft.idcontainerversion,r["AjaxHelper"].fetch({method:"TagManager.getAvailableContainerVariables",filter_limit:"-1",idContainer:r["MatomoUrl"].parsed.value.idContainer,idContainerVersion:e.idContainerVersion}).then((function(t){e.containerVariables=[],e.isLoading=!1,t.forEach((function(t){var n,a=t.types.filter((function(t){return t.type===e.variableType})).map((function(e){return{key:"{{".concat(e.id,"}}"),value:e.name}}));(n=e.containerVariables).push.apply(n,z(a))})),e.modelValue||1!==e.containerVariables.length||e.onChange(e.containerVariables[0].key)})).catch((function(){e.isLoading=!1}))}))},onChange:function(e){this.$emit("update:modelValue",e)},createVariable:function(){var e=this;this.idContainerVersion&&ee.editVariable(null,r["MatomoUrl"].parsed.value.idContainer,this.idContainerVersion,0,(function(t){e.fetchAvailableVariables(),t&&e.onChange("{{".concat(t.name,"}}"))}),this.variableType)},fetchContainer:function(){return this.isLoading=!0,r["AjaxHelper"].fetch({method:"TagManager.getContainer",filter_limit:"-1",idContainer:r["MatomoUrl"].parsed.value.idContainer})}}});te.render=q;var ne=te;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */Object(r["createAngularJsAdapter"])({component:ne,scope:{variableTypeName:{angularJsBind:"@"},variable:{angularJsBind:"=",vue:"modelValue",default:function(e){return e.variable}},variableType:{angularJsBind:"@"}},directiveName:"piwikVariableSelectType",$inject:["$timeout"],events:{"update:modelValue":function(e,t,n,a,i,o,l){n.variable=Object(r["clone"])(e),l()}},postCreate:function(e,t){t.$watch("variable",(function(t,n){t!==n&&Object(o["nextTick"])((function(){e.modelValue=Object(r["clone"])(t)}))}))}});function ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ie={class:"editVariable tagManagerManageEdit",ref:"root"},re={class:"loadingPiwik"},oe=Object(o["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),le={class:"loadingPiwik"},ce=Object(o["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),se={key:0,class:"form-group row"},de={class:"col s12"},ue={key:1},ge={class:"form-group row"},be={class:"col s12"},me={class:"innerFormField"},pe={class:"form-group row"},ve={class:"col s12 m12"},fe={for:"lookup_table"},he={class:"innerFormField comparisonField"},je={class:"innerFormField"},Oe={class:"innerFormField"},Ve=["onClick","title"],ye={class:"entityCancel"},Te={id:"confirmSelectVariableType"},Ce={class:"collection-header"},Ne=["onClick","title"],Ee=["src"],ke={class:"title"},Se={class:"secondary-content"},we=["title"],Me={class:"entityCancel"};function _e(e,t,n,a,i,r){var l=this,c=Object(o["resolveComponent"])("Field"),s=Object(o["resolveComponent"])("GroupedSettings"),d=Object(o["resolveComponent"])("SaveButton"),u=Object(o["resolveComponent"])("ContentBlock");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",ie,[Object(o["createVNode"])(u,{feature:"Tag Manager","content-title":e.editTitle},{default:Object(o["withCtx"])((function(){var n,a,i,r,u,g;return[Object(o["withDirectives"])(Object(o["createElementVNode"])("p",null,[Object(o["createElementVNode"])("span",re,[oe,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[o["vShow"],e.isLoading]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("p",null,[Object(o["createElementVNode"])("span",le,[ce,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("TagManager_UpdatingData")),1)])],512),[[o["vShow"],e.isUpdating]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("form",{onSubmit:t[7]||(t[7]=function(t){return e.edit?e.updateVariable():e.createVariable()})},[Object(o["createElementVNode"])("div",null,[Object(o["withDirectives"])(Object(o["createElementVNode"])("div",{class:"alert alert-warning"},Object(o["toDisplayString"])(e.translate("TagManager_UseCustomTemplateCapabilityRequired",e.translate("TagManager_CapabilityUseCustomTemplates"))),513),[[o["vShow"],e.isVariableDisabled]]),Object(o["createElementVNode"])("div",null,[Object(o["createVNode"])(c,{uicontrol:"text",name:"type","model-value":null===(n=e.variable.typeMetadata)||void 0===n?void 0:n.name,disabled:!0,"inline-help":e.typeInlineHelp,title:e.translate("TagManager_Type")},null,8,["model-value","inline-help","title"])]),Object(o["createElementVNode"])("div",null,[Object(o["createVNode"])(c,{uicontrol:"text",name:"name","model-value":e.variable.name,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.variable.name=t,e.setValueHasChanged()}),maxlength:50,title:e.translate("General_Name"),"inline-help":e.translate("TagManager_VariableNameHelp")},null,8,["model-value","title","inline-help"])]),null!==(a=e.variable.typeMetadata)&&void 0!==a&&null!==(i=a.parameters)&&void 0!==i&&i.length?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",se,[Object(o["createElementVNode"])("div",de,[Object(o["createElementVNode"])("h3",null,Object(o["toDisplayString"])(e.translate("TagManager_ConfigureThisVariable")),1)])])):Object(o["createCommentVNode"])("",!0),e.variable?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",ue,[Object(o["createVNode"])(s,{settings:(null===(r=e.variable.typeMetadata)||void 0===r?void 0:r.parameters)||[],"all-setting-values":e.parameterValues,onChange:t[1]||(t[1]=function(t){return e.parameterValues[t.name]=t.value})},null,8,["settings","all-setting-values"])])):Object(o["createCommentVNode"])("",!0),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",ge,[Object(o["createElementVNode"])("div",be,[Object(o["createElementVNode"])("h3",null,[Object(o["withDirectives"])(Object(o["createElementVNode"])("a",{class:"showAdvancedSettings",onClick:t[2]||(t[2]=Object(o["withModifiers"])((function(t){return e.showAdvanced=!0}),["prevent"]))},Object(o["toDisplayString"])(e.translate("TagManager_ShowAdvancedSettings")),513),[[o["vShow"],!e.showAdvanced]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("a",{class:"hideAdvancedSettings",onClick:t[3]||(t[3]=Object(o["withModifiers"])((function(t){return e.showAdvanced=!1}),["prevent"]))},Object(o["toDisplayString"])(e.translate("TagManager_HideAdvancedSettings")),513),[[o["vShow"],e.showAdvanced]])])])],512),[[o["vShow"],null===(u=e.variable.typeMetadata)||void 0===u?void 0:u.hasAdvancedSettings]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",null,[Object(o["createElementVNode"])("div",me,[Object(o["createVNode"])(c,{uicontrol:"text",name:"default_value","model-value":e.variable.default_value,"onUpdate:modelValue":t[4]||(t[4]=function(t){e.variable.default_value=t,e.setValueHasChanged()}),title:e.translate("TagManager_DefaultValue"),"inline-help":e.translate("TagManager_DefaultValueHelp")},null,8,["model-value","title","inline-help"])]),Object(o["createElementVNode"])("div",pe,[Object(o["createElementVNode"])("div",ve,[Object(o["createElementVNode"])("div",null,[Object(o["createElementVNode"])("label",fe,Object(o["toDisplayString"])(e.translate("TagManager_LookupTableTitle")),1),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.variable.lookup_table,(function(t,n){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",{key:n,class:Object(o["normalizeClass"])("lookupTable lookupTable".concat(n," multiple valign-wrapper"))},[Object(o["createElementVNode"])("div",he,[Object(o["createVNode"])(c,{uicontrol:"select",name:"lookup_table_comparison","model-value":t.comparison,"onUpdate:modelValue":function(n){t.comparison=n,e.setValueHasChanged()},"full-width":!0,options:e.availableLookUpComparisons},null,8,["model-value","onUpdate:modelValue","options"])]),Object(o["createElementVNode"])("div",je,[Object(o["createVNode"])(c,{uicontrol:"text",name:"lookup_table_matchvalue","model-value":t.match_value,"onUpdate:modelValue":function(n){t.match_value=n,e.setValueHasChanged()},"full-width":!0,placeholder:e.translate("TagManager_LookupTableMatchValue")},null,8,["model-value","onUpdate:modelValue","placeholder"])]),Object(o["createElementVNode"])("div",Oe,[Object(o["createVNode"])(c,{uicontrol:"text",name:"lookup_table_outvalue","model-value":t.out_value,"onUpdate:modelValue":function(n){t.out_value=n,e.setValueHasChanged()},"full-width":!0,placeholder:e.translate("TagManager_LookupTableOutValue")},null,8,["model-value","onUpdate:modelValue","placeholder"])]),n+1!==e.variable.lookup_table.length?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",{key:0,class:"icon-minus valign",onClick:function(t){return e.removeLookUpEntry(n)},title:e.translate("General_Remove")},null,8,Ve)):Object(o["createCommentVNode"])("",!0)],2)})),128))])])])],512),[[o["vShow"],e.showAdvanced&&(null===(g=e.variable.typeMetadata)||void 0===g?void 0:g.hasAdvancedSettings)]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",{class:"alert alert-warning"},Object(o["toDisplayString"])(e.translate("TagManager_UseCustomTemplateCapabilityRequired",e.translate("TagManager_CapabilityUseCustomTemplates"))),513),[[o["vShow"],e.isVariableDisabled]]),Object(o["withDirectives"])(Object(o["createVNode"])(d,{class:"createButton",onConfirm:t[5]||(t[5]=function(t){return e.edit?e.updateVariable():e.createVariable()}),disabled:e.isUpdating||!e.isDirty,saving:e.isUpdating,value:e.edit?e.translate("CoreUpdater_UpdateTitle"):e.translate("TagManager_CreateNewVariable")},null,8,["disabled","saving","value"]),[[o["vShow"],!e.isVariableDisabled]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",ye,[Object(o["createElementVNode"])("a",{onClick:t[6]||(t[6]=Object(o["withModifiers"])((function(t){return e.cancel()}),["prevent"]))},Object(o["toDisplayString"])(e.translate("General_Cancel")),1)],512),[[o["vShow"],!e.isEmbedded]])])],544),[[o["vShow"],!e.chooseVariableType&&e.editTitle]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",Te,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.availableVariables,(function(t,n){return Object(o["openBlock"])(),Object(o["createElementBlock"])("ul",{class:"collection with-header",key:n},[Object(o["createElementVNode"])("li",Ce,[Object(o["createElementVNode"])("h4",null,Object(o["toDisplayString"])(t.name),1)]),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(t.types,(function(t,n){return Object(o["openBlock"])(),Object(o["createElementBlock"])("li",{key:n,class:Object(o["normalizeClass"])(["collection-item avatar",ae({disabledTemplate:l.isVariableTemplateDisabled[t.id]},"templateType".concat(t.id),!0)]),onClick:function(n){return e.createVariableType(t)},title:l.isVariableTemplateDisabled[t.id]?e.translate("TagManager_UseCustomTemplateCapabilityRequired",e.translate("TagManager_CapabilityUseCustomTemplates")):""},[t.icon?(Object(o["openBlock"])(),Object(o["createElementBlock"])("img",{key:0,alt:"",class:"circle",src:t.icon},null,8,Ee)):Object(o["createCommentVNode"])("",!0),Object(o["createElementVNode"])("span",ke,Object(o["toDisplayString"])(t.name),1),Object(o["withDirectives"])(Object(o["createElementVNode"])("p",null,Object(o["toDisplayString"])(t.description),513),[[o["vShow"],t.description]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("span",Se,[Object(o["createElementVNode"])("i",{class:"icon-help",title:t.help},null,8,we)],512),[[o["vShow"],!!t.help]])],10,Ne)})),128))])})),128)),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",Me,[Object(o["createElementVNode"])("a",{onClick:t[8]||(t[8]=Object(o["withModifiers"])((function(t){return e.cancel()}),["prevent"]))},Object(o["toDisplayString"])(e.translate("General_Cancel")),1)],512),[[o["vShow"],!e.isEmbedded]])],512),[[o["vShow"],e.chooseVariableType]])]})),_:1},8,["content-title"])],512)}function De(e,t){return Ue(e)||Be(e,t)||Pe(e,t)||Ae()}function Ae(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Be(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,i,r=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done);o=!0)if(r.push(a.value),t&&r.length===t)break}catch(c){l=!0,i=c}finally{try{o||null==n["return"]||n["return"]()}finally{if(l)throw i}}return r}}function Ue(e){if(Array.isArray(e))return e}function Le(e){return Le="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Le(e)}function xe(e){return He(e)||Fe(e)||Pe(e)||Ie()}function Ie(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Pe(e,t){if(e){if("string"===typeof e)return $e(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$e(e,t):void 0}}function Fe(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function He(e){if(Array.isArray(e))return $e(e)}function $e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function Ge(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Re(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Je(e,t,n){return t&&Re(e.prototype,t),n&&Re(e,n),e}function qe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var ze=function(){function e(){var t=this;Ge(this,e),qe(this,"privateState",Object(o["reactive"])({variables:[],isLoadingVars:!1,isLoadingSingle:!1,isUpdating:!1})),qe(this,"state",Object(o["computed"])((function(){return Object(o["readonly"])(t.privateState)}))),qe(this,"isLoading",Object(o["computed"])((function(){var e=t.state.value;return e.isLoadingVars||e.isLoadingSingle}))),qe(this,"isUpdating",Object(o["computed"])((function(){return t.state.value.isUpdating}))),qe(this,"variables",Object(o["computed"])((function(){return t.state.value.variables}))),qe(this,"fetchPromise",null),qe(this,"availableVariablesPromises",{})}return Je(e,[{key:"fetchVariablesIfNotLoaded",value:function(e,t){this.fetchPromise||this.fetchVariables(e,t)}},{key:"findVariable",value:function(e,t,n){var a=this,i=this.variables.value.find((function(e){return e.idvariable===n}));return i?Promise.resolve(i):(this.privateState.isLoadingSingle=!0,r["AjaxHelper"].fetch({idVariable:n,idContainer:e,idContainerVersion:t,method:"TagManager.getContainerVariable",filter_limit:"-1"}).then((function(e){return a.privateState.variables=[].concat(xe(a.privateState.variables),[e]),Object(o["readonly"])(e)})).finally((function(){a.privateState.isLoadingSingle=!1})))}},{key:"fetchVariables",value:function(e,t){var n=this;return this.privateState.isLoadingVars=!0,this.privateState.variables=[],this.fetchPromise||(this.fetchPromise=r["AjaxHelper"].fetch({method:"TagManager.getContainerVariables",idContainer:e,idContainerVersion:t,filter_limit:"-1"})),Promise.resolve(this.fetchPromise).then((function(e){return n.privateState.variables=e,n.privateState.isLoadingVars=!1,n.variables.value})).finally((function(){n.privateState.isLoadingVars=!1}))}},{key:"fetchAvailableVariables",value:function(e){return this.availableVariablesPromises[e]||(this.availableVariablesPromises[e]=r["AjaxHelper"].fetch({method:"TagManager.getAvailableVariableTypesInContext",idContext:e,filter_limit:"-1"}).then((function(e){return Object(o["readonly"])(e)}))),Promise.resolve(this.availableVariablesPromises[e])}},{key:"suggestNameForType",value:function(e){for(var t=this,n=function(n){var a=e;n&&(a="".concat(a," (").concat(n,")"));var i=!t.variables.value.some((function(e){return e.name===a}));if(i)return{v:a}},a=0;a<100;a+=1){var i=n(a);if("object"===Le(i))return i.v}}},{key:"createOrUpdateVariable",value:function(e,t,n,a,i){var o=this;this.privateState.isUpdating=!0;var l=Object.entries(i).map((function(e){var t=De(e,2),n=t[0],a=t[1],i=a;return"boolean"===typeof a&&(i=(+a).toString()),[n,i]})),c=Object.fromEntries(l),s=e.lookup_table.filter((function(e){return e&&e.out_value&&e.comparison}));return r["AjaxHelper"].post({idVariable:e.idvariable,method:t,idContainer:n,idContainerVersion:a,type:e.type,name:e.name,defaultValue:e.default_value},{parameters:c,lookupTable:s},{withTokenInUrl:!0}).finally((function(){o.privateState.isUpdating=!1}))}},{key:"reload",value:function(e,t){return this.privateState.variables=[],this.fetchPromise=null,this.availableVariablesPromises={},this.fetchVariables(e,t)}},{key:"deleteVariable",value:function(e,t,n){var a=this;return this.privateState.isUpdating=!0,this.privateState.variables=[],r["AjaxHelper"].fetch({idVariable:n,idContainerVersion:t,idContainer:e,method:"TagManager.deleteContainerVariable"},{withTokenInUrl:!0}).finally((function(){a.privateState.isUpdating=!1}))}}]),e}(),We=new ze;function Xe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ke(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Ye(e,t,n){return t&&Ke(e.prototype,t),n&&Ke(e,n),e}function Qe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var Ze=function(){function e(){var t=this;Xe(this,e),Qe(this,"privateState",Object(o["reactive"])({comparisons:[],isLoading:!1})),Qe(this,"state",Object(o["computed"])((function(){return Object(o["readonly"])(t.privateState)}))),Qe(this,"isLoading",Object(o["computed"])((function(){return t.state.value.isLoading}))),Qe(this,"comparisons",Object(o["computed"])((function(){return t.state.value.comparisons}))),Qe(this,"comparisonOptions",Object(o["computed"])((function(){return t.comparisons.value.map((function(e){var t=e.id,n=e.name;return{key:t,value:n}}))}))),Qe(this,"initializePromise",null)}return Ye(e,[{key:"init",value:function(){return this.initializePromise||(this.initializePromise=this.fetchAvailableComparisons()),this.initializePromise}},{key:"fetchAvailableComparisons",value:function(){var e=this;return this.privateState.isLoading=!0,r["AjaxHelper"].fetch({method:"TagManager.getAvailableComparisons",filter_limit:"-1"}).then((function(t){e.privateState.comparisons=t})).finally((function(){e.privateState.isLoading=!1}))}}]),e}(),et=new Ze,tt="tagvariablemanagement",nt=Object(o["defineComponent"])({props:{idVariable:Number,idContainer:{type:String,required:!0},idContainerVersion:{type:Number,required:!0},variableType:String,isEmbedded:{type:Boolean,default:!1}},components:{GroupedSettings:g["GroupedSettings"],ContentBlock:r["ContentBlock"],Field:g["Field"],SaveButton:g["SaveButton"]},data:function(){return{isDirty:!1,showAdvanced:!1,chooseVariableType:!1,canUseCustomTemplates:r["Matomo"].hasUserCapability("tagmanager_use_custom_templates"),availableVariables:[],editTitle:"",variable:{},parameterValues:{},isUpdatingVar:!1}},emits:["changeVariable"],created:function(){et.init(),We.fetchVariablesIfNotLoaded(this.idContainer,this.idContainerVersion),this.initIdVariable()},watch:{idVariable:function(e){null!==e&&this.initIdVariable()},variableParameterValues:{handler:function(e,t){e&&t&&(this.isDirty=!0)},deep:!0},variableLookupTable:{handler:function(){var e=(this.variable.lookup_table||[]).every((function(e){return!(null===e||void 0===e||!e.out_value)}));e&&this.addLookUpEntry()},deep:!0}},methods:{removeAnyVariableNotification:function(){r["NotificationsStore"].remove(tt),r["NotificationsStore"].remove("ajaxHelper")},showNotification:function(e,t){var n=r["NotificationsStore"].show({message:e,context:t,id:tt,type:"transient"});setTimeout((function(){r["NotificationsStore"].scrollToNotification(n)}),200)},showErrorFieldNotProvidedNotification:function(e){var t=Object(r["translate"])("TagManager_ErrorXNotProvided",[e]);this.showNotification(t,"error")},initIdVariable:function(){var e=this;r["Matomo"].helper.lazyScrollToContent(),this.availableVariables=[],r["AjaxHelper"].fetch({method:"TagManager.getContainer",idContainer:this.idContainer,filter_limit:"-1"}).then((function(e){return We.fetchAvailableVariables(e.context)})).then((function(t){e.availableVariables=t})).then((function(){if(e.edit&&e.idVariable)return e.editTitle=Object(r["translate"])("TagManager_EditVariable"),void We.findVariable(e.idContainer,e.idContainerVersion,e.idVariable).then((function(t){t&&(e.variable=Object(r["clone"])(t),e.parameterValues=Object.fromEntries(t.typeMetadata.parameters.map((function(e){return[e.name,e.value]}))),(e.variable.lookup_table&&e.variable.lookup_table.length||e.variable.default_value)&&(e.showAdvanced=!0),e.addLookUpEntryIfNoneExists(),e.isDirty=!1)}));if(e.create){var t=!1;e.variableType&&e.availableVariables.forEach((function(n){if(!t){var a=n.types.find((function(t){return(null===t||void 0===t?void 0:t.id)===e.variableType}));a&&(t=!0,e.createVariableType(a))}})),t||(e.editTitle=Object(r["translate"])("TagManager_ChooseVariableToContinue"),e.chooseVariableType=!0)}}))},addLookUpEntryIfNoneExists:function(){this.variable.lookup_table&&Array.isArray(this.variable.lookup_table)||(this.variable.lookup_table=[]),this.variable.lookup_table.length||this.variable.lookup_table.push({comparison:"equals",match_value:"",out_value:""})},addLookUpEntry:function(){this.variable.lookup_table.push({comparison:"equals",match_value:"",out_value:""}),this.isDirty=!0},removeLookUpEntry:function(e){e>-1&&(this.variable.lookup_table.splice(e,1),this.isDirty=!0)},createVariableType:function(e){var t=this;e&&this.isVariableTemplateDisabled[e.id]||(this.chooseVariableType=!1,this.editTitle=Object(r["translate"])("TagManager_CreateNewVariable"),this.variable={idsite:parseInt("".concat(r["Matomo"].idSite),10),name:We.suggestNameForType(e.name)||"",type:e.id,idcontainer:this.idContainer,idcontainerversion:this.idContainerVersion,default_value:"",lookup_table:[],typeMetadata:e},this.parameterValues=Object.fromEntries(e.parameters.map((function(e){return[e.name,e.value]}))),this.addLookUpEntry(),this.isDirty=!0,Object(o["nextTick"])((function(){if(t.$refs.root){var e=t.$refs.root;e.scrollIntoView();var n=e.querySelector("#name");n&&n.focus()}})))},cancel:function(){var e=Object.assign({},r["MatomoUrl"].hashParsed.value);delete e.idVariable,r["MatomoUrl"].updateHash(e)},createVariable:function(){var e=this;this.removeAnyVariableNotification(),this.checkRequiredFieldsAreSet()&&(this.isUpdatingVar=!0,We.createOrUpdateVariable(Object.assign(Object.assign({},this.variable),{},{name:encodeURIComponent(this.variable.name)}),"TagManager.addContainerVariable",this.idContainer,this.idContainerVersion,this.parameterValues).then((function(t){if(t){e.isDirty=!1;var n=t.value;We.reload(e.idContainer,e.idContainerVersion).then((function(){if(e.isEmbedded)return e.variable.idvariable=n,void e.$emit("changeVariable",{variable:e.variable});r["Matomo"].helper.isAngularRenderingThePage()?r["MatomoUrl"].updateHash(Object.assign(Object.assign({},r["MatomoUrl"].hashParsed.value),{},{idVariable:n})):r["MatomoUrl"].updateHash({idVariable:n}),setTimeout((function(){var t=Object(r["translate"])("TagManager_CreatedX",Object(r["translate"])("TagManager_Variable")),n=Object(r["translate"])("TagManager_WantToDeployThisChangeCreateVersion",'<a class="createNewVersionLink">',"</a>");e.showNotification("".concat(t," ").concat(n),"success")}),200)}))}})).finally((function(){e.isUpdatingVar=!1})))},setValueHasChanged:function(){this.isDirty=!0},updateVariable:function(){var e=this;this.removeAnyVariableNotification(),this.checkRequiredFieldsAreSet()&&(this.isUpdatingVar=!0,We.createOrUpdateVariable(Object.assign(Object.assign({},this.variable),{},{name:encodeURIComponent(this.variable.name)}),"TagManager.updateContainerVariable",this.idContainer,this.idContainerVersion,this.parameterValues).then((function(t){if(t)if(e.isEmbedded)e.$emit("changeVariable",{variable:e.variable});else{e.isDirty=!1,We.reload(e.idContainer,e.idContainerVersion).then((function(){e.initIdVariable()}));var n=Object(r["translate"])("TagManager_UpdatedX",Object(r["translate"])("TagManager_Variable")),a=Object(r["translate"])("TagManager_WantToDeployThisChangeCreateVersion",'<a class="createNewVersionLink">',"</a>");e.showNotification("".concat(n," ").concat(a),"success")}})).finally((function(){e.isUpdatingVar=!1})))},checkRequiredFieldsAreSet:function(){return!!this.variable.name||(this.showErrorFieldNotProvidedNotification(Object(r["translate"])("General_Name")),!1)}},computed:{typeInlineHelp:function(){var e,t,n=(null===(e=this.variable.typeMetadata)||void 0===e?void 0:e.description)||"",a=(null===(t=this.variable.typeMetadata)||void 0===t?void 0:t.help)||"";return"".concat(n," ").concat(a)},create:function(){return 0===this.idVariable},edit:function(){return!this.create},isLoading:function(){return We.isLoading.value||et.isLoading.value},isUpdating:function(){return We.isUpdating.value||this.isUpdatingVar},availableLookUpComparisons:function(){return et.comparisonOptions.value},isVariableTemplateDisabled:function(){var e=this,t={};return this.availableVariables.forEach((function(n){n.types.forEach((function(n){t[n.id]=!e.canUseCustomTemplates&&n.isCustomTemplate}))})),t},isVariableDisabled:function(){var e;return!this.canUseCustomTemplates&&(null===(e=this.variable.typeMetadata)||void 0===e?void 0:e.isCustomTemplate)},variableParameterValues:function(){var e;return null!==(e=this.variable.typeMetadata)&&void 0!==e&&e.parameters?this.parameterValues:null},variableLookupTable:function(){return this.variable.lookup_table}}});nt.render=_e;var at=nt,it=(Object(r["createAngularJsAdapter"])({component:at,scope:{idVariable:{angularJsBind:"="},idContainer:{angularJsBind:"="},idContainerVersion:{angularJsBind:"="},variableType:{angularJsBind:"=?"},isEmbedded:{default:function(e){return!!e.onChangeVariable}},onChangeVariable:{angularJsBind:"&?",vue:"changeVariable"}},directiveName:"piwikVariableEdit",events:{onChangeVariable:function(e,t,n){n.idVariable=e.variable.idvariable}},postCreate:function(e,t){t.$on("$destroy",(function(){t.idVariable=null}))}}),{class:"tagManagerManageList tagManagerVariableList"}),rt={class:"name"},ot={class:"type"},lt={class:"lookupTable"},ct={class:"lastUpdated"},st={colspan:"7"},dt={class:"loadingPiwik"},ut=Object(o["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),gt={colspan:"7"},bt=["id"],mt={class:"name"},pt=["title"],vt={class:"lookupTable"},ft={class:"icon-ok"},ht=["title"],jt={class:"action"},Ot=["onClick","title"],Vt=["onClick","title"],yt={class:"tableActionBar"},Tt=Object(o["createElementVNode"])("span",{class:"icon-add"},null,-1),Ct=["title"],Nt=Object(o["createElementVNode"])("span",{class:"icon-help preconfiguredVariablesHelp"},null,-1),Et={class:"collection-header"},kt={class:"title"},St=["textContent"],wt={class:"secondary-content"},Mt=["title"],_t={class:"ui-confirm",id:"confirmDeleteVariable",ref:"confirmDeleteVariable"},Dt=["value"],At=["value"],Bt={class:"ui-confirm",id:"confirmDeleteVariableNotPossible",ref:"confirmDeleteVariableNotPossible"},Ut={class:"collection"},Lt=["value"];
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function xt(e,t,n,a,i,r){var l=Object(o["resolveComponent"])("ContentBlock"),c=Object(o["resolveDirective"])("content-table");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",it,[Object(o["createVNode"])(l,{feature:"Tag Manager",class:"tagManagerCustomVariablesList","content-title":e.translate("TagManager_ManageX",e.translate("TagManager_Variables"))},{default:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("p",null,Object(o["toDisplayString"])(e.translate("TagManager_VariableUsageBenefits")),1),Object(o["withDirectives"])(Object(o["createElementVNode"])("table",null,[Object(o["createElementVNode"])("thead",null,[Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("th",rt,Object(o["toDisplayString"])(e.translate("General_Name")),1),Object(o["createElementVNode"])("th",ot,Object(o["toDisplayString"])(e.translate("TagManager_Type")),1),Object(o["createElementVNode"])("th",lt,Object(o["toDisplayString"])(e.translate("TagManager_LookupTable")),1),Object(o["createElementVNode"])("th",ct,Object(o["toDisplayString"])(e.translate("TagManager_LastUpdated")),1),Object(o["withDirectives"])(Object(o["createElementVNode"])("th",{class:"action"},Object(o["toDisplayString"])(e.translate("General_Actions")),513),[[o["vShow"],e.hasWriteAccess]])])]),Object(o["createElementVNode"])("tbody",null,[Object(o["withDirectives"])(Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("td",st,[Object(o["createElementVNode"])("span",dt,[ut,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("General_LoadingData")),1)])])],512),[[o["vShow"],e.isLoading||e.isUpdating]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("td",gt,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.translate("TagManager_NoVariablesFound"))+" ",1),Object(o["withDirectives"])(Object(o["createElementVNode"])("a",{class:"createContainerVariableNow",onClick:t[0]||(t[0]=function(t){return e.createVariable()})},Object(o["toDisplayString"])(e.translate("TagManager_CreateNewVariableNow")),513),[[o["vShow"],e.hasWriteAccess]])])],512),[[o["vShow"],!e.isLoading&&!e.variables.length]]),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.sortedVariables,(function(t){return Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{id:"variable".concat(t.idvariable),class:"variables",key:t.idvariable},[Object(o["createElementVNode"])("td",mt,Object(o["toDisplayString"])(t.name),1),Object(o["createElementVNode"])("td",{class:"type",title:t.typeMetadata.description},Object(o["toDisplayString"])(t.typeMetadata.name),9,pt),Object(o["createElementVNode"])("td",vt,[Object(o["withDirectives"])(Object(o["createElementVNode"])("span",ft,null,512),[[o["vShow"],t.lookup_table.length]])]),Object(o["createElementVNode"])("td",{class:"lastUpdated",title:e.translate("TagManager_CreatedOnX",t.created_date_pretty)},[Object(o["createElementVNode"])("span",null,Object(o["toDisplayString"])(t.updated_date_pretty),1)],8,ht),Object(o["withDirectives"])(Object(o["createElementVNode"])("td",jt,[Object(o["createElementVNode"])("a",{class:"table-action icon-edit",onClick:function(n){return e.editVariable(t.idvariable,t.type)},title:e.translate("TagManager_EditVariable")},null,8,Ot),Object(o["createElementVNode"])("a",{class:"table-action icon-delete",onClick:function(n){return e.deleteVariable(t)},title:e.translate("TagManager_DeleteX",e.translate("TagManager_Variable"))},null,8,Vt)],512),[[o["vShow"],e.hasWriteAccess]])],8,bt)})),128))])],512),[[c]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",yt,[Object(o["createElementVNode"])("a",{class:"createNewVariable",value:"",onClick:t[1]||(t[1]=function(t){return e.createVariable()})},[Tt,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("TagManager_CreateNewVariable")),1)])],512),[[o["vShow"],e.hasWriteAccess]])]})),_:1},8,["content-title"]),Object(o["createElementVNode"])("h2",{title:e.translate("TagManager_PreConfiguredInfoTitle")},[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.translate("TagManager_PreconfiguredVariables"))+" ",1),Nt],8,Ct),Object(o["createElementVNode"])("div",null,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.containerVariables,(function(e,t){return Object(o["openBlock"])(),Object(o["createElementBlock"])("ul",{class:"collection with-header",key:t},[Object(o["createElementVNode"])("li",Et,[Object(o["createElementVNode"])("h4",null,Object(o["toDisplayString"])(e.name),1)]),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.types,(function(e){return Object(o["withDirectives"])((Object(o["openBlock"])(),Object(o["createElementBlock"])("li",{class:"collection-item",key:e.id},[Object(o["createElementVNode"])("span",kt,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.name)+" ",1),Object(o["createElementVNode"])("span",{class:"variableId",textContent:Object(o["toDisplayString"])("{{".concat(e.id,"}}"))},null,8,St)]),Object(o["withDirectives"])(Object(o["createElementVNode"])("span",wt,[Object(o["createElementVNode"])("i",{class:"icon-help",title:e.description},null,8,Mt)],512),[[o["vShow"],!!e.description]])],512)),[[o["vShow"],e.is_pre_configured]])})),128))])})),128))]),Object(o["createElementVNode"])("div",_t,[Object(o["createElementVNode"])("h2",null,Object(o["toDisplayString"])(e.translate("TagManager_DeleteVariableConfirm")),1),Object(o["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,Dt),Object(o["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,At)],512),Object(o["createElementVNode"])("div",Bt,[Object(o["createElementVNode"])("h2",null,Object(o["toDisplayString"])(e.translate("TagManager_VariableCannotBeDeleted")),1),Object(o["createElementVNode"])("p",null,Object(o["toDisplayString"])(e.translate("TagManager_VariableBeingUsedBy")),1),Object(o["createElementVNode"])("ul",Ut,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.variableReferences,(function(e){return Object(o["openBlock"])(),Object(o["createElementBlock"])("li",{class:"collection-item",key:"".concat(e.referenceType,".").concat(e.referenceId)},Object(o["toDisplayString"])(e.referenceTypeName)+": "+Object(o["toDisplayString"])(e.referenceName),1)})),128))]),Object(o["createElementVNode"])("p",null,Object(o["toDisplayString"])(e.translate("TagManager_VariableBeingUsedNeedsRemove")),1),Object(o["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_Cancel")},null,8,Lt)],512)])}function It(e){return $t(e)||Ht(e)||Ft(e)||Pt()}function Pt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ft(e,t){if(e){if("string"===typeof e)return Gt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gt(e,t):void 0}}function Ht(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function $t(e){if(Array.isArray(e))return Gt(e)}function Gt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Rt=Object(o["defineComponent"])({props:{idContainer:{type:String,required:!0},idContainerVersion:{type:Number,required:!0}},components:{ContentBlock:r["ContentBlock"]},directives:{ContentTable:r["ContentTable"]},data:function(){return{hasWriteAccess:r["Matomo"].hasUserCapability("tagmanager_write"),variableReferences:[],containerVariables:[]}},created:function(){var e=this;We.fetchVariables(this.idContainer,this.idContainerVersion),r["AjaxHelper"].fetch({method:"TagManager.getAvailableContainerVariables",idContainer:this.idContainer,idContainerVersion:this.idContainerVersion,filter_limit:"-1"}).then((function(t){e.containerVariables=t}))},methods:{createVariable:function(){this.editVariable(0)},editVariable:function(e){r["MatomoUrl"].updateHash(Object.assign(Object.assign({},r["MatomoUrl"].hashParsed.value),{},{idVariable:e}))},deleteVariable:function(e){var t=this;r["AjaxHelper"].fetch({method:"TagManager.getContainerVariableReferences",idContainer:this.idContainer,idContainerVersion:this.idContainerVersion,idVariable:e.idvariable}).then((function(n){n&&n.length?(t.variableReferences=n,r["Matomo"].helper.modalConfirm(t.$refs.confirmDeleteVariableNotPossible,{})):(t.variableReferences=[],r["Matomo"].helper.modalConfirm(t.$refs.confirmDeleteVariable,{yes:function(){We.deleteVariable(t.idContainer,t.idContainerVersion,e.idvariable).then((function(){We.reload(t.idContainer,t.idContainerVersion)}))}}))}))}},computed:{isLoading:function(){return We.isLoading.value},isUpdating:function(){return We.isUpdating.value},variables:function(){return We.variables.value},sortedVariables:function(){var e=It(this.variables);return e.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0})),e}}});Rt.render=xt;var Jt=Rt,qt=(Object(r["createAngularJsAdapter"])({component:Jt,scope:{idContainer:{angularJsBind:"="},idContainerVersion:{angularJsBind:"="}},directiveName:"piwikVariableList"}),{class:"manageVariable"}),zt={key:0},Wt={key:1};
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function Xt(e,t,n,a,i,r){var l=Object(o["resolveComponent"])("VariableList"),c=Object(o["resolveComponent"])("VariableEdit");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",qt,[e.editMode?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",zt,[Object(o["createVNode"])(l,{"id-container-version":e.idContainerVersion,"id-container":e.idContainer},null,8,["id-container-version","id-container"])])),e.editMode?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",Wt,[Object(o["createVNode"])(c,{"id-container-version":e.idContainerVersion,"id-container":e.idContainer,"id-variable":e.idVariable},null,8,["id-container-version","id-container","id-variable"])])):Object(o["createCommentVNode"])("",!0)])}var Kt=Object(o["defineComponent"])({props:{idContainerVersion:Number,idContainer:String},components:{VariableList:Jt,VariableEdit:at},data:function(){return{isAddAllowed:!1}},created:function(){var e=this;Object(o["watch"])((function(){return r["MatomoUrl"].hashParsed.value.idVariable}),(function(t){e.onIdVariableParamChange(t)})),r["NotificationsStore"].remove("variablevariablemanagement"),this.onIdVariableParamChange(r["MatomoUrl"].hashParsed.value.idVariable)},methods:{onIdVariableParamChange:function(e){if("0"===e){var t={isAllowed:!0};r["Matomo"].postEvent("TagManager.initAddVariable",t),this.isAddAllowed=!!t.isAllowed}}},computed:{idVariable:function(){var e=r["MatomoUrl"].hashParsed.value.idVariable;return this.isAddAllowed||"0"!==e?e?parseInt(e,10):e:null},editMode:function(){return"number"===typeof this.idVariable}}});Kt.render=Xt;var Yt=Kt;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */Object(r["createAngularJsAdapter"])({component:Yt,scope:{idContainerVersion:{angularJsBind:"@",transform:function(e){return e?parseInt(e,10):void 0}},idContainer:{angularJsBind:"@"}},directiveName:"piwikVariableManage"});function Qt(e,t){return tn(e)||en(e,t)||on(e,t)||Zt()}function Zt(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function en(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,i,r=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done);o=!0)if(r.push(a.value),t&&r.length===t)break}catch(c){l=!0,i=c}finally{try{o||null==n["return"]||n["return"]()}finally{if(l)throw i}}return r}}function tn(e){if(Array.isArray(e))return e}function nn(e){return nn="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nn(e)}function an(e){return cn(e)||ln(e)||on(e)||rn()}function rn(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function on(e,t){if(e){if("string"===typeof e)return sn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sn(e,t):void 0}}function ln(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function cn(e){if(Array.isArray(e))return sn(e)}function sn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function dn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function un(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function gn(e,t,n){return t&&un(e.prototype,t),n&&un(e,n),e}function bn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var mn=function(){function e(){var t=this;dn(this,e),bn(this,"privateState",Object(o["reactive"])({triggers:[],isLoadingTriggers:!1,isLoadingSingle:!1,isUpdating:!1})),bn(this,"state",Object(o["computed"])((function(){return Object(o["readonly"])(t.privateState)}))),bn(this,"isUpdating",Object(o["computed"])((function(){return t.state.value.isUpdating}))),bn(this,"isLoading",Object(o["computed"])((function(){var e=t.state.value;return e.isLoadingTriggers||e.isLoadingSingle}))),bn(this,"triggers",Object(o["computed"])((function(){return t.state.value.triggers}))),bn(this,"fetchPromise",null),bn(this,"availableTriggersPromises",{})}return gn(e,[{key:"fetchTriggers",value:function(e,t){var n=this;return this.privateState.triggers=[],this.privateState.isLoadingTriggers=!0,this.fetchPromise||(this.fetchPromise=r["AjaxHelper"].fetch({method:"TagManager.getContainerTriggers",idContainer:e,idContainerVersion:t,filter_limit:"-1"})),Promise.resolve(this.fetchPromise).then((function(e){return n.privateState.triggers=e,n.triggers.value})).finally((function(){n.privateState.isLoadingTriggers=!1}))}},{key:"fetchTriggersIfNotLoaded",value:function(e,t){this.fetchPromise||this.fetchTriggers(e,t)}},{key:"fetchAvailableTriggers",value:function(e){return this.availableTriggersPromises[e]||(this.availableTriggersPromises[e]=r["AjaxHelper"].fetch({method:"TagManager.getAvailableTriggerTypesInContext",idContext:e,filter_limit:"-1"})),Promise.resolve(this.availableTriggersPromises[e])}},{key:"findTrigger",value:function(e,t,n){var a=this,i=this.triggers.value.find((function(e){return e.idtrigger===n}));return i?Promise.resolve(i):(this.privateState.isLoadingSingle=!0,r["AjaxHelper"].fetch({idTrigger:n,idContainer:e,idContainerVersion:t,method:"TagManager.getContainerTrigger",filter_limit:"-1"}).then((function(e){return a.privateState.triggers=[].concat(an(a.privateState.triggers),[e]),Object(o["readonly"])(e)})).finally((function(){a.privateState.isLoadingSingle=!1})))}},{key:"suggestNameForType",value:function(e){for(var t=this,n=function(n){var a=e;n&&(a="".concat(a," (").concat(n,")"));var i=!t.triggers.value.some((function(e){return e.name===a}));if(i)return{v:a}},a=0;a<100;a+=1){var i=n(a);if("object"===nn(i))return i.v}}},{key:"createOrUpdateTrigger",value:function(e,t,n,a,i){var o=this,l=Object.entries(i).map((function(e){var t=Qt(e,2),n=t[0],a=t[1],i=a;return"boolean"===typeof a&&(i=(+a).toString()),[n,i]})),c=Object.fromEntries(l),s=e.conditions.filter((function(e){return e&&e.actual&&e.comparison&&e.expected}));return this.privateState.isUpdating=!0,r["AjaxHelper"].post({idTrigger:e.idtrigger,method:t,idContainer:n,idContainerVersion:a,type:e.type,name:e.name},{parameters:c,conditions:s},{withTokenInUrl:!0}).finally((function(){o.privateState.isUpdating=!1}))}},{key:"reload",value:function(e,t){return this.privateState.triggers=[],this.fetchPromise=null,this.availableTriggersPromises={},this.fetchTriggers(e,t)}},{key:"deleteTrigger",value:function(e,t,n){var a=this;return this.privateState.isUpdating=!0,this.privateState.triggers=[],r["AjaxHelper"].fetch({idTrigger:n,idContainerVersion:t,idContainer:e,method:"TagManager.deleteContainerTrigger"},{withTokenInUrl:!0}).finally((function(){a.privateState.isUpdating=!1}))}}]),e}(),pn=new mn;function vn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */
window.angular.module("piwikApp").factory("tagManagerTriggerModel",(function(){return pn}));var fn={class:"editTrigger tagManagerManageEdit",ref:"root"},hn={class:"loadingPiwik"},jn=Object(o["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),On={class:"loadingPiwik"},Vn=Object(o["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),yn={class:"form-group row"},Tn={class:"col s12"},Cn={key:0},Nn={class:"form-group row"},En={class:"col s12"},kn={class:"form-group row multiple"},Sn={class:"col s12 m12"},wn={class:"innerFormField"},Mn={class:"innerFormField comparisonField"},_n={class:"innerFormField"},Dn=["onClick","title"],An={class:"triggerConditionNode"},Bn={class:"entityCancel"},Un={id:"confirmSelectTriggerType"},Ln={class:"collection-header"},xn=["onClick","title"],In=["src"],Pn={class:"title"},Fn={class:"secondary-content"},Hn=["title"],$n={class:"entityCancel"};function Gn(e,t,n,a,i,r){var l=Object(o["resolveComponent"])("Field"),c=Object(o["resolveComponent"])("GroupedSettings"),s=Object(o["resolveComponent"])("SaveButton"),d=Object(o["resolveComponent"])("ContentBlock");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",fn,[Object(o["createVNode"])(d,{feature:"Tag Manager","content-title":e.editTitle},{default:Object(o["withCtx"])((function(){var n,a,i,r,d,u,g,b;return[Object(o["withDirectives"])(Object(o["createElementVNode"])("p",null,[Object(o["createElementVNode"])("span",hn,[jn,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[o["vShow"],e.isLoading]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("p",null,[Object(o["createElementVNode"])("span",On,[Vn,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("TagManager_UpdatingData")),1)])],512),[[o["vShow"],e.isUpdating]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("form",{onSubmit:t[4]||(t[4]=function(t){return e.edit?e.updateTrigger():e.createTrigger()})},[Object(o["createElementVNode"])("div",null,[Object(o["withDirectives"])(Object(o["createElementVNode"])("div",{class:"alert alert-warning"},Object(o["toDisplayString"])(e.translate("TagManager_UseCustomTemplateCapabilityRequired",e.translate("TagManager_CapabilityUseCustomTemplates"))),513),[[o["vShow"],e.isTriggerDisabled]]),Object(o["createElementVNode"])("div",null,[Object(o["createVNode"])(l,{uicontrol:"text",name:"type","model-value":null===(n=e.trigger.typeMetadata)||void 0===n?void 0:n.name,disabled:!0,"inline-help":"".concat(null===(a=e.trigger.typeMetadata)||void 0===a?void 0:a.description," ").concat(null===(i=e.trigger.typeMetadata)||void 0===i?void 0:i.help),title:e.translate("TagManager_Type")},null,8,["model-value","inline-help","title"])]),Object(o["createElementVNode"])("div",null,[Object(o["createVNode"])(l,{uicontrol:"text",name:"name","model-value":e.trigger.name,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.trigger.name=t,e.setValueHasChanged()}),maxlength:50,title:e.translate("General_Name"),"inline-help":e.translate("TagManager_TriggerNameHelp")},null,8,["model-value","title","inline-help"])]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",yn,[Object(o["createElementVNode"])("div",Tn,[Object(o["createElementVNode"])("h3",null,Object(o["toDisplayString"])(e.translate("TagManager_ConfigureThisTrigger")),1)])],512),[[o["vShow"],null===(r=e.trigger.typeMetadata)||void 0===r||null===(d=r.parameters)||void 0===d?void 0:d.length]]),e.trigger?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",Cn,[Object(o["createVNode"])(c,{settings:(null===(u=e.trigger.typeMetadata)||void 0===u?void 0:u.parameters)||[],"all-setting-values":e.parameterValues,onChange:t[1]||(t[1]=function(t){return e.parameterValues[t.name]=t.value})},null,8,["settings","all-setting-values"])])):Object(o["createCommentVNode"])("",!0),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",Nn,[Object(o["createElementVNode"])("div",En,[Object(o["createElementVNode"])("h3",null,Object(o["toDisplayString"])(e.translate("TagManager_OnlyTriggerWhen"))+" "+Object(o["toDisplayString"])(e.translate("Goals_Optional")),1)])],512),[[o["vShow"],null===(g=e.trigger.typeMetadata)||void 0===g?void 0:g.hasAdvancedSettings]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",null,[Object(o["createElementVNode"])("div",kn,[Object(o["createElementVNode"])("div",Sn,[Object(o["createElementVNode"])("div",null,[Object(o["createElementVNode"])("p",null,Object(o["toDisplayString"])(e.translate("TagManager_TriggerConditionsHelp")),1),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.trigger.conditions,(function(t,n){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",{key:n,class:Object(o["normalizeClass"])(["condition multiple valign-wrapper","condition".concat(n)])},[Object(o["createElementVNode"])("div",wn,[Object(o["createVNode"])(l,{uicontrol:"expandable-select",name:"condition_actual","model-value":t.actual,"onUpdate:modelValue":function(n){t.actual=n,e.setValueHasChanged()},"full-width":!0,options:e.availableVariables,title:e.variableIdToName[t.actual]||t.actual},null,8,["model-value","onUpdate:modelValue","options","title"])]),Object(o["createElementVNode"])("div",Mn,[Object(o["createVNode"])(l,{uicontrol:"select",name:"condition_comparison","model-value":t.comparison,"onUpdate:modelValue":function(n){t.comparison=n,e.setValueHasChanged()},"full-width":!0,options:e.availableComparisons},null,8,["model-value","onUpdate:modelValue","options"])]),Object(o["createElementVNode"])("div",_n,[Object(o["createVNode"])(l,{uicontrol:"text",name:"condition_expected","model-value":t.expected,"onUpdate:modelValue":function(n){t.expected=n,e.setValueHasChanged(),e.onConditionChange()},"full-width":!0},null,8,["model-value","onUpdate:modelValue"])]),Object(o["withDirectives"])(Object(o["createElementVNode"])("span",{class:"icon-minus valign",onClick:function(t){return e.removeConditionEntry(n)},title:e.translate("General_Remove")},null,8,Dn),[[o["vShow"],!(n+1===e.trigger.conditions.length)]])],2)})),128))]),Object(o["createElementVNode"])("p",An,Object(o["toDisplayString"])(e.translate("TagManager_TriggerConditionNode")),1)])])],512),[[o["vShow"],null===(b=e.trigger.typeMetadata)||void 0===b?void 0:b.hasAdvancedSettings]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",{class:"alert alert-warning"},Object(o["toDisplayString"])(e.translate("TagManager_UseCustomTemplateCapabilityRequired",e.translate("TagManager_CapabilityUseCustomTemplates"))),513),[[o["vShow"],e.isTriggerDisabled]]),Object(o["withDirectives"])(Object(o["createVNode"])(s,{class:"createButton",onConfirm:t[2]||(t[2]=function(t){return e.edit?e.updateTrigger():e.createTrigger()}),disabled:e.isUpdating||!e.isDirty,saving:e.isUpdating,value:e.saveButtonText},null,8,["disabled","saving","value"]),[[o["vShow"],!e.isTriggerDisabled]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",Bn,[Object(o["createElementVNode"])("a",{onClick:t[3]||(t[3]=function(t){return e.cancel()})},Object(o["toDisplayString"])(e.translate("General_Cancel")),1)],512),[[o["vShow"],!e.isEmbedded]])])],544),[[o["vShow"],!e.chooseTriggerType&&e.editTitle]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",Un,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.availableTriggers,(function(t,n){return Object(o["openBlock"])(),Object(o["createElementBlock"])("ul",{class:"collection with-header",key:n},[Object(o["createElementVNode"])("li",Ln,[Object(o["createElementVNode"])("h4",null,Object(o["toDisplayString"])(t.name),1)]),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(t.types,(function(t,n){return Object(o["openBlock"])(),Object(o["createElementBlock"])("li",{class:Object(o["normalizeClass"])(["collection-item avatar",vn({disabledTemplate:e.isTriggerTemplateDisabled[t.id]},"templateType".concat(t.id),!0)]),onClick:function(n){return e.createTriggerType(t)},key:n,title:e.isTriggerTemplateDisabled[t.id]?e.collectionItemAvatarText:""},[t.icon?(Object(o["openBlock"])(),Object(o["createElementBlock"])("img",{key:0,alt:"",class:"circle",src:t.icon},null,8,In)):Object(o["createCommentVNode"])("",!0),Object(o["createElementVNode"])("span",Pn,Object(o["toDisplayString"])(t.name),1),Object(o["withDirectives"])(Object(o["createElementVNode"])("p",null,Object(o["toDisplayString"])(t.description),513),[[o["vShow"],t.description]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("span",Fn,[Object(o["createElementVNode"])("i",{class:"icon-help",title:t.help},null,8,Hn)],512),[[o["vShow"],!!t.help]])],10,xn)})),128))])})),128)),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",$n,[Object(o["createElementVNode"])("a",{onClick:t[5]||(t[5]=function(t){return e.cancel()})},Object(o["toDisplayString"])(e.translate("General_Cancel")),1)],512),[[o["vShow"],!e.isEmbedded]])],512),[[o["vShow"],e.chooseTriggerType]])]})),_:1},8,["content-title"])],512)}var Rn="tagvariablemanagement",Jn={AllElementsClick:"ClickId",AllLinksClick:"ClickId",DownloadClick:"ClickId",ElementVisibility:"VisibleElementClasses",FormSubmit:"FormId",JavaScriptError:"ErrorMessage"},qn=Object(o["defineComponent"])({props:{idTrigger:Number,idContainer:{type:String,required:!0},idContainerVersion:{type:Number,required:!0},newTriggerType:String,isEmbedded:{type:Boolean,default:!1}},components:{ContentBlock:r["ContentBlock"],Field:g["Field"],GroupedSettings:g["GroupedSettings"],SaveButton:g["SaveButton"]},data:function(){return{isDirty:!1,chooseTriggerType:!1,availableTriggers:[],availableVariables:[],variableIdToName:{},editTitle:"",trigger:{},parameterValues:{},isUpdatingTrigger:!1}},emits:["changeTrigger"],created:function(){var e=this;et.init(),r["AjaxHelper"].fetch({method:"TagManager.getAvailableContainerVariables",filter_limit:"-1",idContainer:this.idContainer,idContainerVersion:this.idContainerVersion}).then((function(t){t.forEach((function(t){t.types.forEach((function(n){e.variableIdToName[n.id]=n.name,e.availableVariables.push({key:n.id,value:n.name,group:t.name})}))}))})),pn.fetchTriggersIfNotLoaded(this.idContainer,this.idContainerVersion),this.initIdTrigger()},watch:{idTrigger:function(e){null!==e&&this.initIdTrigger()},triggerParameterValues:{handler:function(e,t){e&&t&&(this.isDirty=!0)},deep:!0}},methods:{checkRequiredFieldsAreSet:function(){return!!this.trigger.name||(this.showErrorFieldNotProvidedNotification(Object(r["translate"])("General_Name")),!1)},removeAnyTriggerNotification:function(){r["NotificationsStore"].remove(Rn),r["NotificationsStore"].remove("ajaxHelper")},showNotification:function(e,t){var n=r["NotificationsStore"].show({message:e,context:t,id:Rn,type:"transient"});setTimeout((function(){r["NotificationsStore"].scrollToNotification(n)}),200)},showErrorFieldNotProvidedNotification:function(e){var t=Object(r["translate"])("TagManager_ErrorXNotProvided",[e]);this.showNotification(t,"error")},initIdTrigger:function(){var e=this;this.trigger={},this.chooseTriggerType=!1,this.editTitle="",r["Matomo"].helper.lazyScrollToContent(),this.availableTriggers=[],r["AjaxHelper"].fetch({method:"TagManager.getContainer",idContainer:this.idContainer,filter_limit:"-1"}).then((function(e){return pn.fetchAvailableTriggers(e.context)})).then((function(t){e.availableTriggers=t})).then((function(){if(e.edit&&e.idTrigger)return e.editTitle=Object(r["translate"])("TagManager_EditTrigger"),void pn.findTrigger(e.idContainer,e.idContainerVersion,e.idTrigger).then((function(t){t&&(e.trigger=Object(r["clone"])(t),e.parameterValues=Object.fromEntries(t.typeMetadata.parameters.map((function(e){return[e.name,e.value]}))),e.addConditionEntryIfNoneExists(),e.onConditionChange(),e.isDirty=!1)}));e.create&&(e.editTitle=Object(r["translate"])("TagManager_ChooseTriggerToContinue"),e.chooseTriggerType=!0)}))},onConditionChange:function(){var e=(this.trigger.conditions||[]).every((function(e){return!(null===e||void 0===e||!e.expected)}));e&&this.addConditionEntry()},addConditionEntryIfNoneExists:function(){this.trigger.conditions&&Array.isArray(this.trigger.conditions)||(this.trigger.conditions=[]),this.trigger.conditions.length||this.trigger.conditions.push(this.makeDefaultCondition())},addConditionEntry:function(){this.trigger.conditions.push(this.makeDefaultCondition()),this.isDirty=!0},removeConditionEntry:function(e){if(e>-1){var t=this.trigger.conditions.length-1;t===e?this.trigger.conditions[e]=this.makeDefaultCondition():this.trigger.conditions.splice(e,1),this.isDirty=!0}},createTriggerType:function(e){var t=this;e&&this.isTriggerTemplateDisabled[e.id]||(this.chooseTriggerType=!1,this.editTitle=Object(r["translate"])("TagManager_CreateNewTrigger"),this.trigger={idsite:parseInt("".concat(r["Matomo"].idSite),10),name:pn.suggestNameForType(e.name)||"",type:e.id,idcontainerversion:this.idContainerVersion,conditions:[],typeMetadata:e},this.parameterValues=Object.fromEntries(e.parameters.map((function(e){return[e.name,e.value]}))),this.addConditionEntry(),this.isDirty=!0,Object(o["nextTick"])((function(){if(t.$refs.root){var e=t.$refs.root;e.scrollIntoView();var n=e.querySelector("#name");n&&n.focus()}})))},cancel:function(){var e=Object.assign({},r["MatomoUrl"].hashParsed.value);delete e.idTrigger,r["MatomoUrl"].updateHash(e)},createTrigger:function(){var e=this;this.removeAnyTriggerNotification(),this.checkRequiredFieldsAreSet()&&(this.isUpdatingTrigger=!0,pn.createOrUpdateTrigger(this.trigger,"TagManager.addContainerTrigger",this.idContainer,this.idContainerVersion,this.parameterValues).then((function(t){var n=t.value;e.isDirty=!1,pn.reload(e.idContainer,e.idContainerVersion).then((function(){if(e.isEmbedded)return e.trigger.idtrigger=n,void e.$emit("changeTrigger",{trigger:e.trigger});r["MatomoUrl"].updateHash(Object.assign(Object.assign({},r["MatomoUrl"].hashParsed.value),{},{idTrigger:n})),setTimeout((function(){var t=Object(r["translate"])("TagManager_CreatedX",Object(r["translate"])("TagManager_Trigger")),n=Object(r["translate"])("TagManager_WantToDeployThisChangeCreateVersion",'<a href="" class="createNewVersionLink">',"</a>");e.showNotification("".concat(t," ").concat(n),"success")}),200)}))})).finally((function(){e.isUpdatingTrigger=!1})))},setValueHasChanged:function(){this.isDirty=!0},updateTrigger:function(){var e=this;this.removeAnyTriggerNotification(),this.checkRequiredFieldsAreSet()&&(this.isUpdatingTrigger=!0,pn.createOrUpdateTrigger(this.trigger,"TagManager.updateContainerTrigger",this.idContainer,this.idContainerVersion,this.parameterValues).then((function(t){if(t)if(e.isEmbedded)e.$emit("changeTrigger",{trigger:e.trigger});else{e.isDirty=!1,pn.reload(e.idContainer,e.idContainerVersion).then((function(){e.initIdTrigger()}));var n=Object(r["translate"])("TagManager_UpdatedX",Object(r["translate"])("TagManager_Trigger")),a=Object(r["translate"])("TagManager_WantToDeployThisChangeCreateVersion",'<a href="" class="createNewVersionLink">',"</a>");e.showNotification("".concat(n," ").concat(a),"success")}})).finally((function(){e.isUpdatingTrigger=!1})))},makeDefaultCondition:function(){var e,t="PageUrl";if(null!==(e=this.trigger)&&void 0!==e&&e.typeMetadata){var n=this.trigger.typeMetadata.id;Jn[n]&&(t=Jn[n])}return{comparison:"equals",actual:t,expected:""}}},computed:{isLoading:function(){return pn.isLoading.value||et.isLoading.value},isUpdating:function(){return pn.isUpdating.value||this.isUpdatingTrigger},create:function(){return 0===this.idTrigger},edit:function(){return!this.create},canUseCustomTemplates:function(){return r["Matomo"].hasUserCapability("tagmanager_use_custom_templates")},isTriggerDisabled:function(){var e;return!this.canUseCustomTemplates&&(null===(e=this.trigger.typeMetadata)||void 0===e?void 0:e.isCustomTemplate)},saveButtonText:function(){return this.edit?Object(r["translate"])("CoreUpdater_UpdateTitle"):Object(r["translate"])("TagManager_CreateNewTrigger")},collectionItemAvatarText:function(){return Object(r["translate"])("TagManager_UseCustomTemplateCapabilityRequired",Object(r["translate"])("TagManager_CapabilityUseCustomTemplates"))},availableComparisons:function(){return et.comparisonOptions.value},isTriggerTemplateDisabled:function(){var e=this,t={};return this.availableTriggers.forEach((function(n){n.types.forEach((function(n){t[n.id]=!e.canUseCustomTemplates&&n.isCustomTemplate}))})),t},triggerParameterValues:function(){var e;return null!==(e=this.trigger.typeMetadata)&&void 0!==e&&e.parameters?this.parameterValues:null}}});qn.render=Gn;var zn=qn,Wn=(Object(r["createAngularJsAdapter"])({component:zn,scope:{idTrigger:{angularJsBind:"="},idContainer:{angularJsBind:"="},idContainerVersion:{angularJsBind:"="},newTriggerType:{angularJsBind:"="},isEmbedded:{default:function(e){return!!e.onChangeTrigger}},onChangeTrigger:{angularJsBind:"&?",vue:"changeTrigger"}},directiveName:"piwikTriggerEdit",events:{onChangeTrigger:function(e,t,n){n.idTrigger=e.trigger.idtrigger}},postCreate:function(e,t){t.$on("$destroy",(function(){t.idTrigger=null}))}}),{class:"tagManagerManageList tagManagerTriggerList"}),Xn={class:"name"},Kn={class:"type"},Yn={class:"conditions"},Qn={class:"lastUpdated"},Zn={colspan:"7"},ea={class:"loadingPiwik"},ta=Object(o["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),na={colspan:"7"},aa=["id"],ia={class:"name"},ra=["title"],oa={class:"conditions"},la={class:"icon-ok"},ca=["title"],sa={class:"action"},da=["onClick","title"],ua=["onClick","title"],ga={class:"tableActionBar"},ba=Object(o["createElementVNode"])("span",{class:"icon-add"},null,-1),ma={class:"ui-confirm",id:"confirmDeleteTrigger",ref:"confirmDeleteTrigger"},pa=["value"],va=["value"],fa={class:"ui-confirm",id:"confirmDeleteTriggerNotPossible",ref:"confirmDeleteTriggerNotPossible"},ha={class:"collection"},ja=["value"];
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function Oa(e,t,n,a,i,r){var l=Object(o["resolveComponent"])("ContentBlock"),c=Object(o["resolveDirective"])("content-table");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",Wn,[Object(o["createVNode"])(l,{feature:"Tag Manager","content-title":e.translate("TagManager_ManageX",e.translate("TagManager_Triggers"))},{default:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("p",null,Object(o["toDisplayString"])(e.translate("TagManager_TriggerUsageBenefits")),1),Object(o["withDirectives"])(Object(o["createElementVNode"])("table",null,[Object(o["createElementVNode"])("thead",null,[Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("th",Xn,Object(o["toDisplayString"])(e.translate("General_Name")),1),Object(o["createElementVNode"])("th",Kn,Object(o["toDisplayString"])(e.translate("TagManager_Type")),1),Object(o["createElementVNode"])("th",Yn,Object(o["toDisplayString"])(e.translate("TagManager_Filter")),1),Object(o["createElementVNode"])("th",Qn,Object(o["toDisplayString"])(e.translate("TagManager_LastUpdated")),1),Object(o["withDirectives"])(Object(o["createElementVNode"])("th",{class:"action"},Object(o["toDisplayString"])(e.translate("General_Actions")),513),[[o["vShow"],e.hasWriteAccess]])])]),Object(o["createElementVNode"])("tbody",null,[Object(o["withDirectives"])(Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("td",Zn,[Object(o["createElementVNode"])("span",ea,[ta,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("General_LoadingData")),1)])])],512),[[o["vShow"],e.isLoading||e.isUpdating]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("td",na,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.translate("TagManager_NoTriggersFound"))+" ",1),Object(o["withDirectives"])(Object(o["createElementVNode"])("a",{class:"createContainerTriggerNow",onClick:t[0]||(t[0]=function(t){return e.createTrigger()})},Object(o["toDisplayString"])(e.translate("TagManager_CreateNewTriggerNow")),513),[[o["vShow"],e.hasWriteAccess]])])],512),[[o["vShow"],!e.isLoading&&0===e.triggers.length]]),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.sortedTriggers,(function(t){var n;return Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{id:"trigger".concat(t.idtrigger),class:"triggers",key:t.idtrigger},[Object(o["createElementVNode"])("td",ia,Object(o["toDisplayString"])(t.name),1),Object(o["createElementVNode"])("td",{class:"type",title:t.typeMetadata.description},Object(o["toDisplayString"])(t.typeMetadata.name),9,ra),Object(o["createElementVNode"])("td",oa,[Object(o["withDirectives"])(Object(o["createElementVNode"])("span",la,null,512),[[o["vShow"],null===(n=t.conditions)||void 0===n?void 0:n.length]])]),Object(o["createElementVNode"])("td",{class:"lastUpdated",title:e.translate("TagManager_CreatedOnX",t.created_date_pretty)},[Object(o["createElementVNode"])("span",null,Object(o["toDisplayString"])(t.updated_date_pretty),1)],8,ca),Object(o["withDirectives"])(Object(o["createElementVNode"])("td",sa,[Object(o["createElementVNode"])("a",{class:"table-action icon-edit",onClick:function(n){return e.editTrigger(t.idtrigger,t.type)},title:e.translate("TagManager_EditTrigger")},null,8,da),Object(o["createElementVNode"])("a",{class:"table-action icon-delete",onClick:function(n){return e.deleteTrigger(t)},title:e.translate("TagManager_DeleteX",e.translate("TagManager_Trigger"))},null,8,ua)],512),[[o["vShow"],e.hasWriteAccess]])],8,aa)})),128))])],512),[[c]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",ga,[Object(o["createElementVNode"])("a",{class:"createNewTrigger",value:"",onClick:t[1]||(t[1]=function(t){return e.createTrigger()})},[ba,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("TagManager_CreateNewTrigger")),1)])],512),[[o["vShow"],e.hasWriteAccess]])]})),_:1},8,["content-title"]),Object(o["createElementVNode"])("div",ma,[Object(o["createElementVNode"])("h2",null,Object(o["toDisplayString"])(e.translate("TagManager_DeleteTriggerConfirm")),1),Object(o["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,pa),Object(o["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,va)],512),Object(o["createElementVNode"])("div",fa,[Object(o["createElementVNode"])("h2",null,Object(o["toDisplayString"])(e.translate("TagManager_TriggerCannotBeDeleted")),1),Object(o["createElementVNode"])("p",null,Object(o["toDisplayString"])(e.translate("TagManager_TriggerBeingUsedBy")),1),Object(o["createElementVNode"])("ul",ha,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.triggerReferences,(function(e){return Object(o["openBlock"])(),Object(o["createElementBlock"])("li",{class:"collection-item",key:e.referenceId},Object(o["toDisplayString"])(e.referenceTypeName)+": "+Object(o["toDisplayString"])(e.referenceName),1)})),128))]),Object(o["createElementVNode"])("p",null,Object(o["toDisplayString"])(e.translate("TagManager_TriggerBeingUsedNeedsRemove")),1),Object(o["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_Cancel")},null,8,ja)],512)])}function Va(e){return Na(e)||Ca(e)||Ta(e)||ya()}function ya(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ta(e,t){if(e){if("string"===typeof e)return Ea(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ea(e,t):void 0}}function Ca(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Na(e){if(Array.isArray(e))return Ea(e)}function Ea(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var ka=Object(o["defineComponent"])({props:{idContainer:{type:String,required:!0},idContainerVersion:{type:Number,required:!0}},components:{ContentBlock:r["ContentBlock"]},directives:{ContentTable:r["ContentTable"]},data:function(){return{hasWriteAccess:r["Matomo"].hasUserCapability("tagmanager_write"),triggerReferences:[]}},created:function(){pn.fetchTriggers(this.idContainer,this.idContainerVersion)},methods:{createTrigger:function(){this.editTrigger(0)},editTrigger:function(e){r["MatomoUrl"].updateHash(Object.assign(Object.assign({},r["MatomoUrl"].hashParsed.value),{},{idTrigger:e}))},deleteTrigger:function(e){var t=this;r["AjaxHelper"].fetch({method:"TagManager.getContainerTriggerReferences",idContainer:this.idContainer,idContainerVersion:this.idContainerVersion,idTrigger:e.idtrigger}).then((function(n){if(n&&n.length)t.triggerReferences=n,r["Matomo"].helper.modalConfirm(t.$refs.confirmDeleteTriggerNotPossible,{});else{t.triggerReferences=[];var a=function(){pn.deleteTrigger(t.idContainer,t.idContainerVersion,e.idtrigger).then((function(){pn.reload(t.idContainer,t.idContainerVersion)}))};r["Matomo"].helper.modalConfirm(t.$refs.confirmDeleteTrigger,{yes:a})}}))}},computed:{isLoading:function(){return pn.isLoading.value},isUpdating:function(){return pn.isUpdating.value},triggers:function(){return pn.triggers.value},sortedTriggers:function(){var e=Va(this.triggers);return e.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0})),e}}});ka.render=Oa;var Sa=ka,wa=(Object(r["createAngularJsAdapter"])({component:Sa,scope:{idContainer:{angularJsBind:"="},idContainerVersion:{angularJsBind:"="}},directiveName:"piwikTriggerList"}),{class:"manageTrigger"});
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function Ma(e,t,n,a,i,r){var l=Object(o["resolveComponent"])("TriggerList"),c=Object(o["resolveComponent"])("TriggerEdit");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",wa,[Object(o["withDirectives"])(Object(o["createElementVNode"])("div",null,[Object(o["createElementVNode"])("div",null,[Object(o["createVNode"])(l,{"id-container":e.idContainer,"id-container-version":e.idContainerVersion},null,8,["id-container","id-container-version"])])],512),[[o["vShow"],!e.editMode]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",null,[Object(o["createElementVNode"])("div",null,[Object(o["createVNode"])(c,{"id-container":e.idContainer,"id-container-version":e.idContainerVersion,"id-trigger":e.idTrigger},null,8,["id-container","id-container-version","id-trigger"])])],512),[[o["vShow"],e.editMode]])])}var _a=Object(o["defineComponent"])({props:{idContainerVersion:Number,idContainer:String},components:{TriggerList:Sa,TriggerEdit:zn},data:function(){return{isAddAllowed:!1}},created:function(){var e=this;Object(o["watch"])((function(){return r["MatomoUrl"].hashParsed.value.idTrigger}),(function(t){e.onIdTriggerParamChange(t)})),r["NotificationsStore"].remove("triggertriggermanagement"),this.onIdTriggerParamChange(r["MatomoUrl"].hashParsed.value.idTrigger)},methods:{onIdTriggerParamChange:function(e){if("0"===e){var t={isAllowed:!0};r["Matomo"].postEvent("TagManager.initAddTrigger",t),this.isAddAllowed=!!t.isAllowed}}},computed:{idTrigger:function(){var e=r["MatomoUrl"].hashParsed.value.idTrigger;return this.isAddAllowed||"0"!==e?e?parseInt(e,10):e:null},editMode:function(){return"number"===typeof this.idTrigger}}});_a.render=Ma;var Da=_a;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */Object(r["createAngularJsAdapter"])({component:Da,scope:{idContainerVersion:{angularJsBind:"@",transform:function(e){return"string"===typeof e?parseInt(e,10):e}},idContainer:{angularJsBind:"@"}},directiveName:"piwikTriggerManage"});function Aa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ba={class:"editTag tagManagerManageEdit",ref:"root"},Ua={class:"loadingPiwik"},La=Object(o["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),xa={class:"loadingPiwik"},Ia=Object(o["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Pa={class:"form-group row"},Fa={class:"col s12"},Ha={key:0},$a={class:"form-group row"},Ga={class:"col s12"},Ra={class:"form-group row"},Ja={class:"col s12"},qa={class:"form-group row tagStartDate"},za={class:"col s12 m6"},Wa={class:"row"},Xa={class:"col s12"},Ka={for:"start_date_date",class:"active"},Ya={class:"tagStartDate"},Qa={class:"col s12 m6 "},Za={class:"form-help"},ei={class:"inline-help"},ti=["innerHTML"],ni=Object(o["createElementVNode"])("br",null,null,-1),ai=["innerHTML"],ii={class:"form-group row tagEndDate"},ri={class:"col s12 m6"},oi={class:"row"},li={class:"col s12"},ci={for:"end_date_date",class:"active"},si={class:"tagEndDate"},di={class:"col s12 m6"},ui={class:"form-help"},gi={class:"inline-help"},bi=["innerHTML"],mi=Object(o["createElementVNode"])("br",null,null,-1),pi=["innerHTML"],vi={class:"entityCancel"},fi={id:"confirmSelectTagType"},hi={class:"collection-header"},ji=["onClick","title"],Oi=["src"],Vi={class:"title"},yi={class:"secondary-content"},Ti=["title"],Ci={class:"entityCancel"};function Ni(e,t,n,a,i,r){var l=Object(o["resolveComponent"])("Field"),c=Object(o["resolveComponent"])("GroupedSettings"),s=Object(o["resolveComponent"])("TagTriggerArray"),d=Object(o["resolveComponent"])("TagDateInput"),u=Object(o["resolveComponent"])("SaveButton"),g=Object(o["resolveComponent"])("ContentBlock");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",Ba,[Object(o["createVNode"])(g,{feature:"Tag Manager","content-title":e.editTitle},{default:Object(o["withCtx"])((function(){var n,a,i,r,g,b,m,p;return[Object(o["withDirectives"])(Object(o["createElementVNode"])("p",null,[Object(o["createElementVNode"])("span",Ua,[La,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[o["vShow"],e.isLoading]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("p",null,[Object(o["createElementVNode"])("span",xa,[Ia,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("TagManager_UpdatingData")),1)])],512),[[o["vShow"],e.isUpdating]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("form",{onSubmit:t[17]||(t[17]=function(t){return e.edit?e.updateTag():e.createTag()})},[Object(o["createElementVNode"])("div",null,[Object(o["withDirectives"])(Object(o["createElementVNode"])("div",{class:"alert alert-warning"},Object(o["toDisplayString"])(e.translate("TagManager_UseCustomTemplateCapabilityRequired",e.translate("TagManager_CapabilityUseCustomTemplates"))),513),[[o["vShow"],e.isTagDisabled]]),Object(o["createElementVNode"])("div",null,[Object(o["createVNode"])(l,{uicontrol:"text",name:"type","model-value":null===(n=e.tag.typeMetadata)||void 0===n?void 0:n.name,disabled:!0,"inline-help":(null===(a=e.tag.typeMetadata)||void 0===a?void 0:a.description)+" "+(null===(i=e.tag.typeMetadata)||void 0===i?void 0:i.help),title:e.translate("TagManager_Type")},null,8,["model-value","inline-help","title"])]),Object(o["createElementVNode"])("div",null,[Object(o["createVNode"])(l,{uicontrol:"text",name:"name","model-value":e.tag.name,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.tag.name=t,e.setValueHasChanged()}),maxlength:50,title:e.translate("General_Name"),"inline-help":e.translate("TagManager_TagNameHelp")},null,8,["model-value","title","inline-help"])]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",Pa,[Object(o["createElementVNode"])("div",Fa,[Object(o["createElementVNode"])("h3",null,Object(o["toDisplayString"])(e.translate("TagManager_ConfigureWhatTagDoes")),1)])],512),[[o["vShow"],null===(r=e.tag.typeMetadata)||void 0===r?void 0:r.parameters.length]]),e.tag?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",Ha,[Object(o["createVNode"])(c,{settings:(null===(g=e.tag.typeMetadata)||void 0===g?void 0:g.parameters)||[],"all-setting-values":e.parameterValues,onChange:t[1]||(t[1]=function(t){e.parameterValues[t.name]=t.value,e.setValueHasChanged()})},null,8,["settings","all-setting-values"])])):Object(o["createCommentVNode"])("",!0),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",$a,[Object(o["createElementVNode"])("div",Ga,[Object(o["createElementVNode"])("h3",null,Object(o["toDisplayString"])(e.translate("TagManager_ConfigureWhenTagDoes")),1)])],512),[[o["vShow"],null===(b=e.tag.typeMetadata)||void 0===b?void 0:b.parameters.length]]),Object(o["createVNode"])(s,{"container-triggers":e.containerTriggers,type:"fire",title:e.translate("TagManager_FireTriggerTitle"),help:e.translate("TagManager_FireTriggerHelp",e.translate("TagManager_FireLimit")),"model-value":e.fireTriggers,"onUpdate:modelValue":t[2]||(t[2]=function(t){e.fireTriggers=t,e.setValueHasChanged(),e.onFireTriggerChange()}),onCreate:t[3]||(t[3]=function(t){return e.onCreateNewFireTrigger()}),onEdit:t[4]||(t[4]=function(t){return e.editTrigger(t)})},null,8,["container-triggers","title","help","model-value"]),Object(o["createVNode"])(s,{"container-triggers":e.containerTriggers,type:"block",title:e.translate("TagManager_BlockTriggerTitle"),help:e.translate("TagManager_BlockTriggerHelp"),"model-value":e.blockTriggers,"onUpdate:modelValue":t[5]||(t[5]=function(t){e.blockTriggers=t,e.setValueHasChanged(),e.onBlockTriggerChange()}),onCreate:t[6]||(t[6]=function(t){return e.onCreateNewBlockTrigger()}),onEdit:t[7]||(t[7]=function(t){return e.editTrigger(t)})},null,8,["container-triggers","title","help","model-value"]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",Ra,[Object(o["createElementVNode"])("div",Ja,[Object(o["createElementVNode"])("h3",null,[Object(o["withDirectives"])(Object(o["createElementVNode"])("a",{href:"",class:"showAdvancedSettings",onClick:t[8]||(t[8]=Object(o["withModifiers"])((function(t){return e.showAdvanced=!0}),["prevent"]))},Object(o["toDisplayString"])(e.translate("TagManager_ShowAdvancedSettings")),513),[[o["vShow"],!e.showAdvanced]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("a",{href:"",class:"hideAdvancedSettings",onClick:t[9]||(t[9]=Object(o["withModifiers"])((function(t){return e.showAdvanced=!1}),["prevent"]))},Object(o["toDisplayString"])(e.translate("TagManager_HideAdvancedSettings")),513),[[o["vShow"],e.showAdvanced]])])])],512),[[o["vShow"],null===(m=e.tag.typeMetadata)||void 0===m?void 0:m.hasAdvancedSettings]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",null,[Object(o["createElementVNode"])("div",null,[Object(o["createVNode"])(l,{uicontrol:"radio",name:"fire_limit","model-value":e.tag.fire_limit,"onUpdate:modelValue":t[10]||(t[10]=function(t){e.tag.fire_limit=t,e.setValueHasChanged()}),options:e.availableFireLimits,title:e.translate("TagManager_FireLimit"),"inline-help":e.fireLimitHelp},null,8,["model-value","options","title","inline-help"])]),Object(o["createElementVNode"])("div",null,[Object(o["createVNode"])(l,{uicontrol:"text",name:"fire_delay","model-value":e.tag.fire_delay,"onUpdate:modelValue":t[11]||(t[11]=function(t){e.tag.fire_delay=t,e.setValueHasChanged()}),maxlength:8,title:e.translate("TagManager_FireDelay"),"inline-help":e.translate("TagManager_FireDelayHelp")},null,8,["model-value","title","inline-help"])]),Object(o["createElementVNode"])("div",null,[Object(o["createVNode"])(l,{uicontrol:"text",name:"priority","model-value":e.tag.priority,"onUpdate:modelValue":t[12]||(t[12]=function(t){e.tag.priority=t,e.setValueHasChanged()}),maxlength:4,title:e.translate("TagManager_Priority"),"inline-help":e.translate("TagManager_PriorityHelp")},null,8,["model-value","title","inline-help"])]),Object(o["createElementVNode"])("div",qa,[Object(o["createElementVNode"])("div",za,[Object(o["createElementVNode"])("div",Wa,[Object(o["createElementVNode"])("div",Xa,[Object(o["createElementVNode"])("label",Ka,Object(o["toDisplayString"])(e.translate("TagManager_StartDate"))+":",1)]),Object(o["createElementVNode"])("div",Ya,[Object(o["createVNode"])(d,{name:"start_date","model-value":e.tag.start_date,"onUpdate:modelValue":t[13]||(t[13]=function(t){e.tag.start_date=t,e.setValueHasChanged()}),"default-time":"00:00:00"},null,8,["model-value"])])])]),Object(o["createElementVNode"])("div",Qa,[Object(o["createElementVNode"])("div",Za,[Object(o["createElementVNode"])("span",ei,[Object(o["createElementVNode"])("span",null,[Object(o["createElementVNode"])("span",{innerHTML:e.$sanitize(e.translate("TagManager_TagStartDateHelp","<strong>","</strong>"))},null,8,ti),ni,Object(o["createElementVNode"])("span",{class:"currentLocalTime",innerHTML:e.$sanitize(e.translate("TagManager_CurrentTimeInLocalTimezone","<strong>",e.currentTime,"</strong>"))},null,8,ai)])])])])]),Object(o["createElementVNode"])("div",ii,[Object(o["createElementVNode"])("div",ri,[Object(o["createElementVNode"])("div",oi,[Object(o["createElementVNode"])("div",li,[Object(o["createElementVNode"])("label",ci,Object(o["toDisplayString"])(e.translate("TagManager_EndDate"))+":",1)]),Object(o["createElementVNode"])("div",si,[Object(o["createVNode"])(d,{name:"end_date","model-value":e.tag.end_date,"onUpdate:modelValue":t[14]||(t[14]=function(t){e.tag.end_date=t,e.setValueHasChanged()}),"default-time":"23:59:59"},null,8,["model-value"])])])]),Object(o["createElementVNode"])("div",di,[Object(o["createElementVNode"])("div",ui,[Object(o["createElementVNode"])("span",gi,[Object(o["createElementVNode"])("span",null,[Object(o["createElementVNode"])("span",{innerHTML:e.$sanitize(e.translate("TagManager_TagEndDateHelp","<strong>","</strong>"))},null,8,bi),mi,Object(o["createElementVNode"])("span",{class:"currentLocalTime",innerHTML:e.$sanitize(e.translate("TagManager_CurrentTimeInLocalTimezone","<strong>",e.currentTime,"</strong>"))},null,8,pi)])])])])])],512),[[o["vShow"],e.showAdvanced&&(null===(p=e.tag.typeMetadata)||void 0===p?void 0:p.hasAdvancedSettings)]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",{class:"alert alert-warning"},Object(o["toDisplayString"])(e.translate("TagManager_UseCustomTemplateCapabilityRequired",e.translate("TagManager_CapabilityUseCustomTemplates"))),513),[[o["vShow"],e.isTagDisabled]]),Object(o["withDirectives"])(Object(o["createVNode"])(u,{class:"createButton",onConfirm:t[15]||(t[15]=function(t){return e.edit?e.updateTag():e.createTag()}),disabled:e.isUpdating||!e.isDirty,saving:e.isUpdating,value:e.edit?e.translate("CoreUpdater_UpdateTitle"):e.translate("TagManager_CreateNewTag")},null,8,["disabled","saving","value"]),[[o["vShow"],!e.isTagDisabled]]),Object(o["createElementVNode"])("div",vi,[Object(o["createElementVNode"])("a",{onClick:t[16]||(t[16]=function(t){return e.cancel()})},Object(o["toDisplayString"])(e.translate("General_Cancel")),1)])])],544),[[o["vShow"],!e.chooseTagType&&e.editTitle]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",fi,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.availableTags,(function(t){return Object(o["openBlock"])(),Object(o["createElementBlock"])("ul",{class:"collection with-header",key:t.name},[Object(o["createElementVNode"])("li",hi,[Object(o["createElementVNode"])("h4",null,Object(o["toDisplayString"])(t.name),1)]),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(t.types,(function(t,n){return Object(o["openBlock"])(),Object(o["createElementBlock"])("li",{key:n,class:Object(o["normalizeClass"])(["collection-item avatar",Aa({disabledTemplate:e.isTagTemplateDisabled[t.id]},"templateType".concat(t.id),!0)]),onClick:function(n){return e.createTagType(t)},title:e.isTagTemplateDisabled[t.id]?e.collectionItemAvatarText:""},[t.icon?(Object(o["openBlock"])(),Object(o["createElementBlock"])("img",{key:0,alt:"",class:"circle",src:t.icon},null,8,Oi)):Object(o["createCommentVNode"])("",!0),Object(o["createElementVNode"])("span",Vi,Object(o["toDisplayString"])(t.name),1),Object(o["withDirectives"])(Object(o["createElementVNode"])("p",null,Object(o["toDisplayString"])(t.description),513),[[o["vShow"],t.description]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("span",yi,[Object(o["createElementVNode"])("i",{class:"icon-help",title:t.help},null,8,Ti)],512),[[o["vShow"],!!t.help]])],10,ji)})),128))])})),128)),Object(o["createElementVNode"])("div",Ci,[Object(o["createElementVNode"])("a",{onClick:t[18]||(t[18]=function(t){return e.cancel()})},Object(o["toDisplayString"])(e.translate("General_Cancel")),1)])],512),[[o["vShow"],e.chooseTagType]])]})),_:1},8,["content-title"])],512)}function Ei(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ki(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Si(e,t,n){return t&&ki(e.prototype,t),n&&ki(e,n),e}function wi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var Mi=function(){function e(){var t=this;Ei(this,e),wi(this,"privateState",Object(o["reactive"])({fireLimits:[],isLoading:!1})),wi(this,"state",Object(o["computed"])((function(){return Object(o["readonly"])(t.privateState)}))),wi(this,"isLoading",Object(o["computed"])((function(){return t.state.value.isLoading}))),wi(this,"fireLimits",Object(o["computed"])((function(){return t.state.value.fireLimits}))),wi(this,"fireLimitsOptions",Object(o["computed"])((function(){return t.fireLimits.value.map((function(e){var t=e.id,n=e.name;return{key:t,value:n}}))}))),wi(this,"initializePromise",null)}return Si(e,[{key:"init",value:function(){return this.initializePromise||(this.initializePromise=this.fetchAvailableFireLimits()),this.initializePromise}},{key:"fetchAvailableFireLimits",value:function(){var e=this;return this.privateState.isLoading=!0,r["AjaxHelper"].fetch({method:"TagManager.getAvailableTagFireLimits",filter_limit:"-1"}).then((function(t){var n;n=Array.isArray(t)?t:Object.values(t),e.privateState.fireLimits=n})).finally((function(){e.privateState.isLoading=!1}))}}]),e}(),_i=new Mi,Di={class:"col s12 m6"},Ai=["for"],Bi=Object(o["createElementVNode"])("br",null,null,-1),Ui=["name"],Li=["onClick","title"],xi=["onClick","title"],Ii={class:"col s12 m6"},Pi={class:"form-help"},Fi={class:"inline-help"},Hi=Object(o["createElementVNode"])("br",null,null,-1),$i=Object(o["createElementVNode"])("br",null,null,-1);function Gi(e,t,n,a,i,r){var l=Object(o["resolveComponent"])("Field");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",{class:Object(o["normalizeClass"])(["form-group row","".concat(e.type,"Triggers")])},[Object(o["createElementVNode"])("div",Di,[Object(o["createElementVNode"])("div",null,[Object(o["createElementVNode"])("label",{for:"".concat(e.type,"_triggers")},Object(o["toDisplayString"])(e.title),9,Ai),Object(o["withDirectives"])(Object(o["createElementVNode"])("p",null,[Bi,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("TagManager_NoTriggersFound"))+". ",1),Object(o["createElementVNode"])("a",{class:"createNewTrigger",onClick:t[0]||(t[0]=function(t){return e.$emit("create")})},Object(o["toDisplayString"])(e.translate("TagManager_CreateNewTriggerNow")),1)],512),[[o["vShow"],0===e.containerTriggers.length]]),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.modelValue,(function(t,n){return Object(o["withDirectives"])((Object(o["openBlock"])(),Object(o["createElementBlock"])("div",{class:Object(o["normalizeClass"])(["multiple valign-wrapper","".concat(e.type,"Trigger ").concat(e.type,"Trigger").concat(n)]),key:n},[Object(o["createElementVNode"])("div",{class:"innerFormField",name:"".concat(e.type,"_triggers")},[Object(o["createVNode"])(l,{uicontrol:"select",name:"".concat(e.type,"_triggers"),"model-value":t,"onUpdate:modelValue":function(t){return e.onChangeTrigger(t,n)},"full-width":!0,options:e.containerTriggers},null,8,["name","model-value","onUpdate:modelValue","options"])],8,Ui),Object(o["withDirectives"])(Object(o["createElementVNode"])("span",{class:"icon-edit valign",onClick:function(n){return e.$emit("edit",t)},title:e.translate("General_Edit")},null,8,Li),[[o["vShow"],t]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("span",{class:"icon-minus valign",onClick:function(t){return e.removeTrigger(n)},title:e.translate("General_Remove")},null,8,xi),[[o["vShow"],n+1!==e.modelValue.length]])],2)),[[o["vShow"],e.containerTriggers.length]])})),128))])]),Object(o["createElementVNode"])("div",Ii,[Object(o["createElementVNode"])("div",Pi,[Object(o["createElementVNode"])("span",Fi,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.help)+" ",1),Hi,$i,Object(o["createElementVNode"])("a",{class:"createTriggerInHelp",onClick:t[1]||(t[1]=function(t){return e.$emit("create")})},Object(o["toDisplayString"])(e.translate("TagManager_CreateNewTriggerNow")),1)])])])],2)}function Ri(e){return Wi(e)||zi(e)||qi(e)||Ji()}function Ji(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function qi(e,t){if(e){if("string"===typeof e)return Xi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xi(e,t):void 0}}function zi(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Wi(e){if(Array.isArray(e))return Xi(e)}function Xi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Ki=Object(o["defineComponent"])({props:{type:{type:String,required:!0},help:{type:String,required:!0},title:{type:String,required:!0},containerTriggers:{type:Array,required:!0},modelValue:{type:Array,required:!0}},components:{Field:g["Field"]},emits:["update:modelValue","create","edit"],methods:{onChangeTrigger:function(e,t){var n=Ri(this.modelValue);n[t]=parseInt(e,10),this.$emit("update:modelValue",n)},removeTrigger:function(e){var t=Ri(this.modelValue);t.splice(e,1),this.$emit("update:modelValue",t)}}});Ki.render=Gi;var Yi=Ki,Qi={class:"col s12 m6 input-field"},Zi=["name","id","value"],er={class:"col s12 m6 input-field"},tr=["name","id","value"];function nr(e,t,n,a,i,r){return Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],null,[Object(o["createElementVNode"])("div",Qi,[Object(o["createElementVNode"])("input",{ref:"dateInput",type:"text",name:"".concat(e.name,"_date"),id:"".concat(e.name,"_date"),class:"dateInput",value:e.dateText,onKeydown:t[0]||(t[0]=function(t){return e.onDateKeydown(t)}),onChange:t[1]||(t[1]=function(t){return e.onDateKeydown(t)})},null,40,Zi)]),Object(o["createElementVNode"])("div",er,[Object(o["createElementVNode"])("input",{ref:"timeInput",type:"text",name:"".concat(e.name,"_time"),id:"".concat(e.name,"_time"),class:"timeInput",value:e.timeText,onKeydown:t[2]||(t[2]=function(t){return e.onTimeKeydown(t)})},null,40,tr)])],64)}function ar(e){var t=String(e);return 1===t.length&&(t="0".concat(t)),t}function ir(e){if(e){var t=e;if(t){t="".concat(t).replace(/-/g,"/");try{return new Date("".concat(t," UTC"))}catch(c){try{return new Date(Date.parse("".concat(t," UTC")))}catch(s){var n=t.substr(0,10),a=t.substr(11),i=n.split("/"),r=a.split(":");if(3===i.length&&3===r.length){var o=new Date(parseInt(i[0],10),parseInt(i[1],10)-1,parseInt(i[2],10),parseInt(r[0],10),parseInt(r[1],10),parseInt(r[2],10)),l=o.getTime()+6e4*o.getTimezoneOffset();return new Date(l)}}}}}}function rr(e){var t=ir(e);if(t){var n=ar(t.getMonth()+1),a=ar(t.getDate());return"".concat(t.getFullYear(),"-").concat(n,"-").concat(a)}var i=e.split(" ");return i[0]}function or(e){var t=ir(e);if(t){var n=ar(t.getHours()),a=ar(t.getMinutes()),i=ar(t.getSeconds());return"".concat(n,":").concat(a,":").concat(i)}var r=e.split(" ");return r[1]}function lr(e){var t=e;t&&(t=t.replace(/-/g,"/"));try{var n=new Date(t),a=ar(n.getUTCMonth()+1),i=ar(n.getUTCDate()),r=ar(n.getUTCHours()),o=ar(n.getUTCMinutes()),l=ar(n.getUTCSeconds()),c="";return c+="".concat(n.getUTCFullYear(),"-").concat(a,"-").concat(i),c+=" ",c+="".concat(r,":").concat(o,":").concat(l),c}catch(s){return t}}var cr=window,sr=cr.$,dr=Object(o["defineComponent"])({props:{name:{type:String,required:!0},defaultTime:{type:String,required:!0},modelValue:String},mounted:function(){var e=this,t=Object.assign(Object.assign({},r["Matomo"].getBaseDatePickerOptions(null)),{},{minDate:new Date});delete t.maxDate,sr(this.$refs.dateInput).datepicker(Object.assign({},t)),sr(this.$refs.timeInput).timepicker({timeFormat:"H:i:s"}).on("change",(function(t){e.onTimeKeydown(t)}))},computed:{dateText:function(){return this.modelValue?rr(this.modelValue):""},timeText:function(){return this.modelValue?or(this.modelValue):""}},methods:{onDateKeydown:function(e){var t=this;setTimeout((function(){var n=e.target.value;t.dateText!==n&&t.onChange(n,t.timeText)}))},onTimeKeydown:function(e){var t=this;setTimeout((function(){var n=e.target.value;t.timeText!==n&&t.onChange(t.dateText,n)}))},onChange:function(e,t){if(e){var n=t||this.defaultTime,a=lr("".concat(e," ").concat(n));this.$emit("update:model-value",a)}else this.$emit("update:model-value",null)}}});dr.render=nr;var ur=dr;function gr(e){return gr="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gr(e)}function br(e,t){return vr(e)||pr(e,t)||jr(e,t)||mr()}function mr(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function pr(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,i,r=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done);o=!0)if(r.push(a.value),t&&r.length===t)break}catch(c){l=!0,i=c}finally{try{o||null==n["return"]||n["return"]()}finally{if(l)throw i}}return r}}function vr(e){if(Array.isArray(e))return e}function fr(e){return Vr(e)||Or(e)||jr(e)||hr()}function hr(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function jr(e,t){if(e){if("string"===typeof e)return yr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yr(e,t):void 0}}function Or(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Vr(e){if(Array.isArray(e))return yr(e)}function yr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function Tr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cr(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Nr(e,t,n){return t&&Cr(e.prototype,t),n&&Cr(e,n),e}function Er(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var kr=function(){function e(){var t=this;Tr(this,e),Er(this,"privateState",Object(o["reactive"])({tags:[],isLoadingTags:!1,isLoadingSingle:!1,isUpdating:!1})),Er(this,"state",Object(o["computed"])((function(){return Object(o["readonly"])(t.privateState)}))),Er(this,"isLoading",Object(o["computed"])((function(){var e=t.state.value;return e.isLoadingTags||e.isLoadingSingle}))),Er(this,"isUpdating",Object(o["computed"])((function(){return t.state.value.isUpdating}))),Er(this,"tags",Object(o["computed"])((function(){return t.state.value.tags}))),Er(this,"fetchPromise",null),Er(this,"availableTagsPromises",{})}return Nr(e,[{key:"fetchTags",value:function(e,t){var n=this;return this.privateState.isLoadingTags=!0,this.privateState.tags=[],this.fetchPromise||(this.fetchPromise=r["AjaxHelper"].fetch({method:"TagManager.getContainerTags",idContainer:e,idContainerVersion:t,filter_limit:"-1"})),Promise.resolve(this.fetchPromise).then((function(e){return n.privateState.tags=e,n.privateState.isLoadingTags=!1,n.tags.value})).finally((function(){n.privateState.isLoadingTags=!1}))}},{key:"reload",value:function(e,t){return this.privateState.tags=[],this.fetchPromise=null,this.availableTagsPromises={},this.fetchTags(e,t)}},{key:"findTag",value:function(e,t,n){var a=this,i=this.tags.value.find((function(e){return e.idtag===n}));return i?Promise.resolve(i):(this.privateState.isLoadingSingle=!0,r["AjaxHelper"].fetch({idTag:n,idContainer:e,idContainerVersion:t,method:"TagManager.getContainerTag",filter_limit:"-1"}).then((function(e){return a.privateState.tags=[].concat(fr(a.privateState.tags),[e]),Object(o["readonly"])(e)})).finally((function(){a.privateState.isLoadingSingle=!1})))}},{key:"fetchAvailableTags",value:function(e){return this.availableTagsPromises[e]||(this.availableTagsPromises[e]=r["AjaxHelper"].fetch({method:"TagManager.getAvailableTagTypesInContext",idContext:e,filter_limit:"-1"}).then((function(e){return Object(o["readonly"])(e)}))),Promise.resolve(this.availableTagsPromises[e])}},{key:"createOrUpdateTag",value:function(e,t,n,a,i,o,l){var c=this;this.privateState.isUpdating=!0;var s=Object.entries(i).map((function(e){var t=br(e,2),n=t[0],a=t[1],i=a;return"boolean"===typeof a&&(i=(+a).toString()),[n,i]})),d=Object.fromEntries(s);return r["AjaxHelper"].post({idTag:e.idtag,method:t,idContainer:n,idContainerVersion:a,type:e.type,name:e.name,startDate:e.start_date,endDate:e.end_date,fireLimit:e.fire_limit,fireDelay:e.fire_delay,priority:e.priority},{parameters:d,fireTriggerIds:o,blockTriggerIds:l},{withTokenInUrl:!0}).finally((function(){c.privateState.isUpdating=!1}))}},{key:"deleteTag",value:function(e,t,n){var a=this;return this.privateState.isUpdating=!0,this.privateState.tags=[],r["AjaxHelper"].fetch({idTag:n,idContainerVersion:t,idContainer:e,method:"TagManager.deleteContainerTag"},{withTokenInUrl:!0}).finally((function(){a.privateState.isUpdating=!1}))}},{key:"suggestNameForType",value:function(e){for(var t=this,n=function(n){var a=e;n&&(a="".concat(a," (").concat(n,")"));var i=!t.tags.value.some((function(e){return e.name===a}));if(i)return{v:a}},a=0;a<100;a+=1){var i=n(a);if("object"===gr(i))return i.v}}}]),e}(),Sr=new kr;function wr(e){return Ar(e)||Dr(e)||_r(e)||Mr()}function Mr(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _r(e,t){if(e){if("string"===typeof e)return Br(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Br(e,t):void 0}}function Dr(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Ar(e){if(Array.isArray(e))return Br(e)}function Br(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function Ur(){var e=new Date;return e&&e.toString?e.toString():null}var Lr=window,xr=Lr.$,Ir=Lr.tagManagerHelper,Pr="tagtagmanagement",Fr=Object(o["defineComponent"])({props:{idTag:Number,idContainer:{type:String,required:!0},idContainerVersion:{type:Number,required:!0},newTagType:null},components:{TagDateInput:ur,ContentBlock:r["ContentBlock"],Field:g["Field"],SaveButton:g["SaveButton"],GroupedSettings:g["GroupedSettings"],TagTriggerArray:Yi},data:function(){return{isDirty:!1,showAdvanced:!1,chooseTagType:!1,availableTags:[],containerTriggers:[],currentTime:null,tag:{},editTitle:"",parameterValues:{},isUpdatingTag:!1,fireTriggers:[],blockTriggers:[],currentTimeTimeout:null}},created:function(){var e=this;_i.init(),this.updateAvailableTriggers(),this.setCurrentTime(),Sr.reload(this.idContainer,this.idContainerVersion).then((function(){e.initIdTag()}))},unmounted:function(){this.currentTimeTimeout&&clearTimeout(this.currentTimeTimeout)},watch:{idTag:function(e){null!==e&&this.initIdTag()}},methods:{setCurrentTime:function(){this.currentTime=Ur(),this.currentTimeTimeout=setTimeout(this.setCurrentTime.bind(this),1e4)},updateAvailableTriggers:function(){var e=this;r["AjaxHelper"].fetch({method:"TagManager.getContainerTriggers",idContainer:this.idContainer,idContainerVersion:this.idContainerVersion,filter_limit:"-1"}).then((function(t){e.containerTriggers=t.map((function(e){return{key:e.idtrigger,value:e.name}}))}))},removeAnyTagNotification:function(){r["NotificationsStore"].remove(Pr),r["NotificationsStore"].remove("ajaxHelper")},showNotification:function(e,t){var n=r["NotificationsStore"].show({message:e,context:t,id:Pr,type:"transient"});setTimeout((function(){r["NotificationsStore"].scrollToNotification(n)}),200)},showErrorFieldNotProvidedNotification:function(e){var t=Object(r["translate"])("TagManager_ErrorXNotProvided",[e]);this.showNotification(t,"error")},initIdTag:function(){var e=this;this.tag={},this.chooseTagType=!1,this.editTitle="",r["Matomo"].helper.lazyScrollToContent(),this.availableTags=[],r["AjaxHelper"].fetch({method:"TagManager.getContainer",idContainer:this.idContainer,filter_limit:"-1"}).then((function(e){return Sr.fetchAvailableTags(e.context)})).then((function(t){e.availableTags=t})).then((function(){if(e.edit&&e.idTag)return e.editTitle=Object(r["translate"])("TagManager_EditTag"),void Sr.findTag(e.idContainer,e.idContainerVersion,e.idTag).then((function(t){t&&(e.tag=Object(r["clone"])(t),e.parameterValues=Object.fromEntries(t.typeMetadata.parameters.map((function(e){return[e.name,e.value]}))),e.blockTriggers=wr(e.tag.block_trigger_ids||[]),e.blockTriggers.length||e.blockTriggers.push(null),e.fireTriggers=wr(e.tag.fire_trigger_ids||[]),e.fireTriggers.length||e.fireTriggers.push(null),e.onFireTriggerChange(),e.onBlockTriggerChange(),e.isDirty=!1)}));e.create&&(e.editTitle=Object(r["translate"])("TagManager_ChooseTagToContinue"),e.chooseTagType=!0)}))},onCreateNewBlockTrigger:function(){var e=this;this.openEditTrigger((function(t){var n=e.blockTriggers.length-1;e.blockTriggers[n]?e.blockTriggers.push(t.idtrigger):e.blockTriggers[n]=t.idtrigger,e.onBlockTriggerChange()}),0)},onCreateNewFireTrigger:function(){var e=this;this.openEditTrigger((function(t){var n=e.fireTriggers.length-1;e.fireTriggers[n]?e.fireTriggers.push(t.idtrigger):e.fireTriggers[n]=t.idtrigger,e.onFireTriggerChange()}),0)},editTrigger:function(e){this.openEditTrigger((function(){return null}),e)},openEditTrigger:function(e,t){var n=this;Ir.editTrigger(null,this.idContainer,this.idContainerVersion,t,(function(t){n.updateAvailableTriggers(),e(t)}))},onBlockTriggerChange:function(){var e=this.blockTriggers.every((function(e){return!!e}));e&&this.addBlockTrigger()},addBlockTrigger:function(){this.blockTriggers.push(null),this.isDirty=!0},removeBlockTrigger:function(e){if(e>-1){var t=this.blockTriggers.length-1;t===e?this.blockTriggers[e]=null:this.blockTriggers.splice(e,1),this.isDirty=!0}},onFireTriggerChange:function(){var e=this.fireTriggers.every((function(e){return!!e}));e&&this.addFireTrigger()},addFireTrigger:function(){this.fireTriggers.push(null),this.isDirty=!0},removeFireTrigger:function(e){if(e>-1){var t=this.fireTriggers.length-1;t===e?this.fireTriggers[e]=null:this.fireTriggers.splice(e,1),this.isDirty=!0}},createTagType:function(e){var t=this;e&&this.isTagTemplateDisabled[e.id]||(this.chooseTagType=!1,this.editTitle=Object(r["translate"])("TagManager_CreateNewTag"),this.tag={idsite:parseInt("".concat(r["Matomo"].idSite),10),name:Sr.suggestNameForType(e.name)||"",type:e.id,fire_limit:"unlimited",priority:999,fire_delay:0,typeMetadata:e},this.blockTriggers=[null],this.fireTriggers=[null],this.parameterValues=Object.fromEntries(e.parameters.map((function(e){return[e.name,e.value]}))),this.isDirty=!1,setTimeout((function(){var e=xr(t.$refs.root);e.length&&e[0]&&e[0].scrollIntoView(),e.find("#name").focus()}),1))},cancel:function(){var e=Object.assign({},r["MatomoUrl"].hashParsed.value);delete e.idTag,r["MatomoUrl"].updateHash(e)},createTag:function(){var e=this;this.removeAnyTagNotification(),this.checkRequiredFieldsAreSet()&&(this.isUpdatingTag=!0,Sr.createOrUpdateTag(this.tag,"TagManager.addContainerTag",this.idContainer,this.idContainerVersion,this.parameterValues,this.fireTriggers.filter((function(e){return!!e})),this.blockTriggers.filter((function(e){return!!e}))).then((function(t){if(t){e.isDirty=!1;var n=t.value;Sr.reload(e.idContainer,e.idContainerVersion).then((function(){r["MatomoUrl"].updateHash(Object.assign(Object.assign({},r["MatomoUrl"].hashParsed.value),{},{idTag:n})),setTimeout((function(){var t=Object(r["translate"])("TagManager_CreatedX",Object(r["translate"])("TagManager_Tag")),n=Object(r["translate"])("TagManager_WantToDeployThisChangeCreateVersion",'<a class="createNewVersionLink">',"</a>");e.showNotification("".concat(t," ").concat(n),"success")}),200)}))}})).finally((function(){e.isUpdatingTag=!1})))},setValueHasChanged:function(){this.isDirty=!0},updateTag:function(){var e=this;this.removeAnyTagNotification(),this.checkRequiredFieldsAreSet()&&(this.isUpdatingTag=!0,Sr.createOrUpdateTag(this.tag,"TagManager.updateContainerTag",this.idContainer,this.idContainerVersion,this.parameterValues,this.fireTriggers.filter((function(e){return!!e})),this.blockTriggers.filter((function(e){return!!e}))).then((function(t){if(t){e.isDirty=!1,Sr.reload(e.idContainer,e.idContainerVersion).then((function(){e.initIdTag()}));var n=Object(r["translate"])("TagManager_UpdatedX",Object(r["translate"])("TagManager_Tag")),a=Object(r["translate"])("TagManager_WantToDeployThisChangeCreateVersion",'<a class="createNewVersionLink">',"</a>");e.showNotification("".concat(n," ").concat(a),"success")}})).finally((function(){e.isUpdatingTag=!1})))},checkRequiredFieldsAreSet:function(){if(!this.tag.name){var e=Object(r["translate"])("General_Name");return this.showErrorFieldNotProvidedNotification(e),!1}return!(!this.fireTriggers||!this.fireTriggers.length)||(this.showNotification(Object(r["translate"])("TagManager_TagFireTriggerRequirement"),"error"),!1)}},computed:{availableFireLimits:function(){return _i.fireLimitsOptions.value},isLoading:function(){return pn.isLoading.value||_i.isLoading.value},isUpdating:function(){return pn.isUpdating.value||this.isUpdatingTag},create:function(){return 0===this.idTag},edit:function(){return!this.create},canUseCustomTemplates:function(){return r["Matomo"].hasUserCapability("tagmanager_use_custom_templates")},isTagDisabled:function(){var e;return!this.canUseCustomTemplates&&(null===(e=this.tag.typeMetadata)||void 0===e?void 0:e.isCustomTemplate)},isTagTemplateDisabled:function(){var e=this,t={};return this.availableTags.forEach((function(n){n.types.forEach((function(n){t[n.id]=!e.canUseCustomTemplates&&n.isCustomTemplate}))})),t},collectionItemAvatarText:function(){return Object(r["translate"])("TagManager_UseCustomTemplateCapabilityRequired",Object(r["translate"])("TagManager_CapabilityUseCustomTemplates"))},fireLimitHelp:function(){return Object(r["translate"])("TagManager_FireLimitHelp",Object(r["translate"])("TagManager_Unlimited"),Object(r["translate"])("TagManager_OncePage"),Object(r["translate"])("TagManager_Once24Hours"),Object(r["translate"])("TagManager_OnceLifetime"))}}});Fr.render=Ni;var Hr=Fr,$r=(Object(r["createAngularJsAdapter"])({component:Hr,scope:{idTag:{angularJsBind:"="},idContainer:{angularJsBind:"="},idContainerVersion:{angularJsBind:"="},newTagType:{angularJsBind:"="}},directiveName:"piwikTagEdit"}),{class:"tagManagerManageList tagManagerTagList"}),Gr={class:"name"},Rr={class:"type"},Jr={class:"triggers"},qr={class:"lastUpdated"},zr={colspan:"5"},Wr={class:"loadingPiwik"},Xr=Object(o["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Kr={colspan:"5"},Yr=["id"],Qr={class:"name"},Zr=["title"],eo={class:"triggers"},to=["onClick"],no={key:1,class:"chip"},ao=["onClick"],io=["title"],ro={class:"action"},oo=["onClick","title"],lo=["onClick","title"],co={class:"tableActionBar"},so=Object(o["createElementVNode"])("span",{class:"icon-add"},null,-1),uo={class:"ui-confirm",id:"confirmDeleteTag",ref:"confirmDeleteTag"},go=["value"],bo=["value"];
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function mo(e,t,n,a,i,r){var l=this,c=Object(o["resolveComponent"])("ContentBlock"),s=Object(o["resolveDirective"])("content-table");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",$r,[Object(o["createVNode"])(c,{feature:"Tag Manager","content-title":e.translate("TagManager_ManageX",e.translate("TagManager_Tags"))},{default:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("p",null,Object(o["toDisplayString"])(e.translate("TagManager_TagUsageBenefits")),1),Object(o["withDirectives"])(Object(o["createElementVNode"])("table",null,[Object(o["createElementVNode"])("thead",null,[Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("th",Gr,Object(o["toDisplayString"])(e.translate("General_Name")),1),Object(o["createElementVNode"])("th",Rr,Object(o["toDisplayString"])(e.translate("TagManager_Type")),1),Object(o["createElementVNode"])("th",Jr,Object(o["toDisplayString"])(e.translate("TagManager_Triggers")),1),Object(o["createElementVNode"])("th",qr,Object(o["toDisplayString"])(e.translate("TagManager_LastUpdated")),1),Object(o["withDirectives"])(Object(o["createElementVNode"])("th",{class:"action"},Object(o["toDisplayString"])(e.translate("General_Actions")),513),[[o["vShow"],e.hasWriteAccess]])])]),Object(o["createElementVNode"])("tbody",null,[Object(o["withDirectives"])(Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("td",zr,[Object(o["createElementVNode"])("span",Wr,[Xr,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("General_LoadingData")),1)])])],512),[[o["vShow"],e.isLoading||e.isUpdating]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("td",Kr,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.translate("TagManager_NoTagsFound"))+" ",1),Object(o["withDirectives"])(Object(o["createElementVNode"])("a",{class:"createContainerTagNow",onClick:t[0]||(t[0]=function(t){return e.createTag()})},Object(o["toDisplayString"])(e.translate("TagManager_CreateNewTagNow")),513),[[o["vShow"],e.hasWriteAccess]])])],512),[[o["vShow"],!e.isLoading&&0===e.tags.length]]),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.sortedTags,(function(t){return Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{class:"tags",key:t.idtag,id:"tag".concat(t.idtag)},[Object(o["createElementVNode"])("td",Qr,Object(o["toDisplayString"])(t.name),1),Object(o["createElementVNode"])("td",{class:"type",title:t.typeMetadata.description},Object(o["toDisplayString"])(t.typeMetadata.name),9,Zr),Object(o["createElementVNode"])("td",eo,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(t.fire_trigger_ids,(function(t,n){return Object(o["openBlock"])(),Object(o["createElementBlock"])("span",{key:n,style:{"margin-right":"3.5px"}},[e.hasWriteAccess?(Object(o["openBlock"])(),Object(o["createElementBlock"])("a",{key:0,style:{display:"inline-block","vertical-align":"top !important"},class:"chip",href:"",onClick:Object(o["withModifiers"])((function(n){return e.editTrigger(t)}),["prevent"])},Object(o["toDisplayString"])(l.triggers[t]),9,to)):Object(o["createCommentVNode"])("",!0),e.hasWriteAccess?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",no,Object(o["toDisplayString"])(l.triggers[t]),1))])})),128)),Object(o["withDirectives"])(Object(o["createElementVNode"])("span",null,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.translate("TagManager_Except"))+": ",1),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(t.block_trigger_ids,(function(t,n){return Object(o["openBlock"])(),Object(o["createElementBlock"])("span",{key:n,style:{"margin-right":"3.5px"}},[Object(o["withDirectives"])(Object(o["createElementVNode"])("a",{class:"chip",href:"",onClick:Object(o["withModifiers"])((function(n){return e.editTrigger(t)}),["prevent"])},Object(o["toDisplayString"])(l.triggers[t]),9,ao),[[o["vShow"],e.hasWriteAccess]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("span",{class:"chip"},Object(o["toDisplayString"])(l.triggers[t]),513),[[o["vShow"],!e.hasWriteAccess]])])})),128))],512),[[o["vShow"],t.block_trigger_ids.length]])]),Object(o["createElementVNode"])("td",{class:"lastUpdated",title:e.translate("TagManager_CreatedOnX",t.created_date_pretty)},[Object(o["createElementVNode"])("span",null,Object(o["toDisplayString"])(t.updated_date_pretty),1)],8,io),Object(o["withDirectives"])(Object(o["createElementVNode"])("td",ro,[Object(o["createElementVNode"])("a",{class:"table-action icon-edit",onClick:function(n){return e.editTag(t.idtag,t.type)},title:e.translate("TagManager_EditTag")},null,8,oo),Object(o["createElementVNode"])("a",{class:"table-action icon-delete",onClick:function(n){return e.deleteTag(t)},title:e.translate("TagManager_DeleteX",e.translate("TagManager_Tag"))},null,8,lo)],512),[[o["vShow"],e.hasWriteAccess]])],8,Yr)})),128))])],512),[[s]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",co,[Object(o["createElementVNode"])("a",{class:"createNewTag",value:"",onClick:t[1]||(t[1]=function(t){return e.createTag()})},[so,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("TagManager_CreateNewTag")),1)])],512),[[o["vShow"],e.hasWriteAccess]])]})),_:1},8,["content-title"]),Object(o["createElementVNode"])("div",uo,[Object(o["createElementVNode"])("h2",null,Object(o["toDisplayString"])(e.translate("TagManager_DeleteTagConfirm")),1),Object(o["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,go),Object(o["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,bo)],512)])}function po(e){return jo(e)||ho(e)||fo(e)||vo()}function vo(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function fo(e,t){if(e){if("string"===typeof e)return Oo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Oo(e,t):void 0}}function ho(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function jo(e){if(Array.isArray(e))return Oo(e)}function Oo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Vo=window,yo=Vo.tagManagerHelper,To=Object(o["defineComponent"])({props:{idContainer:{type:String,required:!0},idContainerVersion:{type:Number,required:!0}},components:{ContentBlock:r["ContentBlock"]},directives:{ContentTable:r["ContentTable"]},data:function(){return{hasWriteAccess:r["Matomo"].hasUserCapability("tagmanager_write")}},created:function(){var e=this;Object(o["watch"])((function(){return Sr.tags.value}),(function(){e.reloadTriggers()})),this.reloadTriggers(),Sr.fetchTags(this.idContainer,this.idContainerVersion)},methods:{reloadTriggers:function(){pn.reload(this.idContainer,this.idContainerVersion)},createTag:function(){this.editTag(0)},editTrigger:function(e){var t=this;yo.editTrigger(null,this.idContainer,this.idContainerVersion,e,(function(){t.reloadTriggers()}))},editTag:function(e){r["MatomoUrl"].updateHash(Object.assign(Object.assign({},r["MatomoUrl"].hashParsed.value),{},{idTag:e}))},deleteTag:function(e){var t=this,n=function(){Sr.deleteTag(t.idContainer,t.idContainerVersion,e.idtag).then((function(){Sr.reload(t.idContainer,t.idContainerVersion)}))};r["Matomo"].helper.modalConfirm("#confirmDeleteTag",{yes:n})}},computed:{triggers:function(){var e={};return pn.triggers.value.forEach((function(t){e["".concat(t.idtrigger)]=t.name})),e},isLoading:function(){return Sr.isLoading.value},isUpdating:function(){return Sr.isUpdating.value},tags:function(){return Sr.tags.value},sortedTags:function(){var e=po(this.tags);return e.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0})),e}}});To.render=mo;var Co=To,No=(Object(r["createAngularJsAdapter"])({component:Co,scope:{idContainer:{angularJsBind:"="},idContainerVersion:{angularJsBind:"="}},directiveName:"piwikTagList"}),{class:"manageTag"}),Eo={key:0},ko={key:1};
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function So(e,t,n,a,i,r){var l=Object(o["resolveComponent"])("TagList"),c=Object(o["resolveComponent"])("TagEdit");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",No,[e.editMode?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",Eo,[Object(o["createVNode"])(l,{"id-container":e.idContainer,"id-container-version":e.idContainerVersion},null,8,["id-container","id-container-version"])])),e.editMode?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",ko,[Object(o["createVNode"])(c,{"id-container":e.idContainer,"id-container-version":e.idContainerVersion,"id-tag":e.idTag},null,8,["id-container","id-container-version","id-tag"])])):Object(o["createCommentVNode"])("",!0)])}var wo=Object(o["defineComponent"])({props:{idContainerVersion:Number,idContainer:String},components:{TagList:Co,TagEdit:Hr},data:function(){return{isAddAllowed:!1}},created:function(){var e=this;Object(o["watch"])((function(){return r["MatomoUrl"].hashParsed.value.idTag}),(function(t){e.onIdTagParamChange(t)})),r["NotificationsStore"].remove("tagtagmanagement"),this.onIdTagParamChange(r["MatomoUrl"].hashParsed.value.idTag)},methods:{onIdTagParamChange:function(e){if("0"===e){var t={isAllowed:!0};r["Matomo"].postEvent("TagManager.initAddTag",t),this.isAddAllowed=!!t.isAllowed}}},computed:{idTag:function(){var e=r["MatomoUrl"].hashParsed.value.idTag;return this.isAddAllowed||"0"!==e?e?parseInt(e,10):e:null},editMode:function(){return"number"===typeof this.idTag}}});wo.render=So;var Mo=wo,_o=(Object(r["createAngularJsAdapter"])({component:Mo,scope:{idContainerVersion:{angularJsBind:"@",transform:function(e){return e?parseInt(e,10):void 0}},idContainer:{angularJsBind:"@"}},directiveName:"piwikTagManage"}),{class:"editVersion tagManagerManageEdit"}),Do={class:"loadingPiwik"},Ao=Object(o["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Bo={class:"loadingPiwik"},Uo=Object(o["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Lo={key:0},xo={key:2,class:"versionChanges"},Io={key:0},Po={colspan:"4"},Fo={key:1},Ho={colspan:"4"},$o={class:"lastUpdated"},Go={class:"entityCancel"};
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function Ro(e,t,n,a,i,r){var l=Object(o["resolveComponent"])("Field"),c=Object(o["resolveComponent"])("SaveButton"),s=Object(o["resolveComponent"])("ActivityIndicator"),d=Object(o["resolveComponent"])("ContentBlock"),u=Object(o["resolveDirective"])("content-table");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",_o,[Object(o["createVNode"])(d,{feature:"Tag Manager","content-title":e.editTitle},{default:Object(o["withCtx"])((function(){var n;return[Object(o["withDirectives"])(Object(o["createElementVNode"])("p",null,[Object(o["createElementVNode"])("span",Do,[Ao,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[o["vShow"],e.isLoading]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("p",null,[Object(o["createElementVNode"])("span",Bo,[Uo,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("TagManager_UpdatingData")),1)])],512),[[o["vShow"],e.isUpdating]]),Object(o["createElementVNode"])("form",{onSubmit:t[6]||(t[6]=function(t){return e.edit?e.updateVersion():e.createVersion()})},[Object(o["createElementVNode"])("div",null,[Object(o["createElementVNode"])("div",null,[Object(o["createVNode"])(l,{uicontrol:"text",name:"name","inline-help":e.versionNameHelpText,"inline-help-bind":{lastVersion:e.lastVersion},"model-value":e.version.name,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.version.name=t,e.setValueHasChanged()}),maxlength:30,title:e.translate("TagManager_VersionName")},null,8,["inline-help","inline-help-bind","model-value","title"])]),Object(o["createElementVNode"])("div",null,[Object(o["createVNode"])(l,{uicontrol:"text",name:"description","model-value":e.version.description,"onUpdate:modelValue":t[1]||(t[1]=function(t){e.version.description=t,e.setValueHasChanged()}),title:e.translate("TagManager_VersionDescription"),"inline-help":e.translate("TagManager_VersionDescriptionHelp")},null,8,["model-value","title","inline-help"])]),Object(o["createVNode"])(c,{class:"createButton no-publish",onConfirm:t[2]||(t[2]=function(t){return e.edit?e.updateVersion():e.createVersion()}),disabled:e.isUpdating||!e.isDirty,saving:e.isUpdating,value:e.edit?e.translate("CoreUpdater_UpdateTitle"):e.translate("TagManager_CreateVersionWithoutPublishing")},null,8,["disabled","saving","value"]),e.create&&e.environments.length?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",Lo,[Object(o["createVNode"])(l,{uicontrol:"select",name:"environment","inline-help":e.selectTagManagerEnvironmentHelp,"inline-help-bind":{canPublishToLive:e.canPublishToLive},"model-value":null===(n=e.version.environments)||void 0===n?void 0:n[0],"onUpdate:modelValue":t[3]||(t[3]=function(t){e.version.environments[0]=t,e.setValueHasChanged()}),options:e.environments,introduction:e.translate("TagManager_OrCreateAndPublishVersion"),title:e.translate("TagManager_Environment")},null,8,["inline-help","inline-help-bind","model-value","options","introduction","title"])])):Object(o["createCommentVNode"])("",!0),e.create&&e.environments.length?(Object(o["openBlock"])(),Object(o["createBlock"])(c,{key:1,class:"publishButton",onConfirm:t[4]||(t[4]=function(t){return e.createVersionAndPublish()}),disabled:e.isUpdating||!e.isDirty,saving:e.isUpdating,value:e.translate("TagManager_CreateVersionAndPublishRelease")},null,8,["disabled","saving","value"])):Object(o["createCommentVNode"])("",!0),e.lastVersion?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",xo,[Object(o["createElementVNode"])("h3",null,Object(o["toDisplayString"])(e.translate("TagManager_ChangesSinceLastVersion"))+":",1),Object(o["withDirectives"])(Object(o["createElementVNode"])("table",null,[Object(o["createElementVNode"])("thead",null,[Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("th",null,Object(o["toDisplayString"])(e.translate("SitesManager_Type")),1),Object(o["createElementVNode"])("th",null,Object(o["toDisplayString"])(e.translate("General_Name")),1),Object(o["createElementVNode"])("th",null,Object(o["toDisplayString"])(e.translate("TagManager_Change")),1),Object(o["createElementVNode"])("th",null,Object(o["toDisplayString"])(e.translate("TagManager_LastUpdated")),1)])]),Object(o["createElementVNode"])("tbody",null,[e.isLoadingVersionChanges?(Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",Io,[Object(o["createElementVNode"])("td",Po,[Object(o["createVNode"])(s,{"loading-message":e.translate("TagManager_DetectingChanges"),loading:!0},null,8,["loading-message"])])])):Object(o["createCommentVNode"])("",!0),e.versionChanges.length||e.isLoadingVersionChanges?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",Fo,[Object(o["createElementVNode"])("td",Ho,Object(o["toDisplayString"])(e.translate("UserCountryMap_None")),1)])),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.versionChanges,(function(t,n){return Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{key:n},[Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.translate(t.entityType)),1),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(t.name),1),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.translate(t.type)),1),Object(o["createElementVNode"])("td",$o,[Object(o["createElementVNode"])("span",null,Object(o["toDisplayString"])(t.lastChanged),1)])])})),128))])],512),[[u]])])):Object(o["createCommentVNode"])("",!0),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",Go,[Object(o["createElementVNode"])("a",{onClick:t[5]||(t[5]=function(t){return e.cancel()})},Object(o["toDisplayString"])(e.translate("General_Cancel")),1)],512),[[o["vShow"],!e.isEmbedded]])])],32)]})),_:1},8,["content-title"])])}function Jo(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qo(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function zo(e,t,n){return t&&qo(e.prototype,t),n&&qo(e,n),e}function Wo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var Xo=function(){function e(){var t=this;Jo(this,e),Wo(this,"privateState",Object(o["reactive"])({environmentsWithPublish:[],isLoading:!1})),Wo(this,"state",Object(o["computed"])((function(){return Object(o["readonly"])(t.privateState)}))),Wo(this,"isLoading",Object(o["computed"])((function(){return t.state.value.isLoading}))),Wo(this,"environmentsWithPublish",Object(o["computed"])((function(){return t.state.value.environmentsWithPublish}))),Wo(this,"environmentsWithPublishOptions",Object(o["computed"])((function(){return t.environmentsWithPublish.value.map((function(e){var t=e.id,n=e.name;return{key:t,value:n}}))}))),Wo(this,"initializePromise",null)}return zo(e,[{key:"init",value:function(){return this.initializePromise||(this.initializePromise=this.fetchEnvironments()),this.initializePromise}},{key:"fetchEnvironments",value:function(){var e=this;return this.privateState.isLoading=!0,r["AjaxHelper"].fetch({method:"TagManager.getAvailableEnvironmentsWithPublishCapability",filter_limit:"-1"}).then((function(t){var n;n=Array.isArray(t)?t:Object.values(t),e.privateState.environmentsWithPublish=n})).finally((function(){e.privateState.isLoading=!1}))}}]),e}(),Ko=new Xo;function Yo(e){return el(e)||Zo(e)||al(e)||Qo()}function Qo(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Zo(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function el(e){if(Array.isArray(e))return il(e)}function tl(e,t){return ol(e)||rl(e,t)||al(e,t)||nl()}function nl(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function al(e,t){if(e){if("string"===typeof e)return il(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?il(e,t):void 0}}function il(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function rl(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,i,r=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done);o=!0)if(r.push(a.value),t&&r.length===t)break}catch(c){l=!0,i=c}finally{try{o||null==n["return"]||n["return"]()}finally{if(l)throw i}}return r}}function ol(e){if(Array.isArray(e))return e}
/**
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function ll(e,t,n){function a(e,t){return e.find((function(e){return e.name===t}))}function i(e,t,n,i){var r=[];return t.forEach((function(t){var o=a(n,t.name);o?i.some((function(n){return JSON.stringify(t[n])!==JSON.stringify(o[n])&&(r.push({entityType:e,type:"TagManager_DiffModified",name:t.name,lastChanged:t.updated_date_pretty}),!0)})):r.push({entityType:e,type:"TagManager_DiffAdded",name:t.name,lastChanged:t.updated_date_pretty})})),n.forEach((function(n){a(t,n.name)||r.push({entityType:e,type:"TagManager_DiffDeleted",name:n.name,lastChanged:n.updated_date_pretty})})),r}function o(e,t){e.forEach((function(e){e.fire_triggers=[],e.block_triggers=[],e.fire_trigger_ids.forEach((function(n){var a=t.find((function(e){return e.idtrigger===n}));a&&e.fire_triggers.push(a.name)})),e.block_trigger_ids.forEach((function(n){var a=t.find((function(e){return e.idtrigger===n}));a&&e.block_triggers.push(a.name)}))}))}var l={module:"API",method:"TagManager.exportContainerVersion",format:"json",idContainer:e,filter_limit:-1};t&&(l.idContainerVersion=t);var c={module:"API",method:"TagManager.exportContainerVersion",format:"json",idContainer:e,idContainerVersion:n,filter_limit:-1};return r["AjaxHelper"].fetch([l,c]).then((function(e){var t=tl(e,2),n=t[0],a=t[1];o(n.tags,n.triggers),o(a.tags,a.triggers);var r=i("TagManager_Tag",n.tags,a.tags,["name","type","fire_limit","priority","fire_delay","fire_triggers","block_triggers","parameters"]),l=i("TagManager_Trigger",n.triggers,a.triggers,["name","type","conditions","parameters"]),c=i("TagManager_Variable",n.variables,a.variables,["name","type","lookup_table","default_value","parameters"]);return[].concat(Yo(r),Yo(l),Yo(c))}))}function cl(e){return gl(e)||ul(e)||dl(e)||sl()}function sl(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function dl(e,t){if(e){if("string"===typeof e)return bl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bl(e,t):void 0}}function ul(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function gl(e){if(Array.isArray(e))return bl(e)}function bl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function ml(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pl(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function vl(e,t,n){return t&&pl(e.prototype,t),n&&pl(e,n),e}function fl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var hl=function(){function e(){var t=this;ml(this,e),fl(this,"privateState",Object(o["reactive"])({versions:[],isLoadingVersions:!1,isLoadingSingle:!1,isUpdating:!1})),fl(this,"state",Object(o["computed"])((function(){return Object(o["readonly"])(t.privateState)}))),fl(this,"isLoading",Object(o["computed"])((function(){var e=t.state.value;return e.isLoadingVersions||e.isLoadingSingle}))),fl(this,"isUpdating",Object(o["computed"])((function(){return t.state.value.isUpdating}))),fl(this,"versions",Object(o["computed"])((function(){return t.state.value.versions}))),fl(this,"fetchPromise",null)}return vl(e,[{key:"reload",value:function(e){return this.privateState.versions=[],this.fetchPromise=null,this.fetchVersions(e)}},{key:"fetchVersions",value:function(e){var t=this;return this.privateState.isLoadingVersions=!0,this.privateState.versions=[],this.fetchPromise||(this.fetchPromise=r["AjaxHelper"].fetch({method:"TagManager.getContainerVersions",idContainer:e,filter_limit:"-1"})),Promise.resolve(this.fetchPromise).then((function(e){return t.privateState.versions=e,t.privateState.isLoadingVersions=!1,t.versions.value})).finally((function(){t.privateState.isLoadingVersions=!1}))}},{key:"findVersion",value:function(e,t){var n=this,a=this.versions.value.find((function(e){return e.idcontainerversion===t}));return a?Promise.resolve(a):(this.privateState.isLoadingSingle=!0,r["AjaxHelper"].fetch({idContainerVersion:t,idContainer:e,method:"TagManager.getContainerVersion",filter_limit:"-1"}).then((function(e){return n.privateState.versions=[].concat(cl(n.privateState.versions),[e]),Object(o["readonly"])(e)})).finally((function(){n.privateState.isLoadingSingle=!1})))}},{key:"deleteVersion",value:function(e,t){var n=this;return this.privateState.isUpdating=!0,this.privateState.versions=[],r["AjaxHelper"].fetch({idContainerVersion:t,idContainer:e,method:"TagManager.deleteContainerVersion"},{withTokenInUrl:!0}).finally((function(){n.privateState.isUpdating=!1}))}},{key:"publishVersion",value:function(e,t,n){var a=this;return this.privateState.isUpdating=!0,r["AjaxHelper"].fetch({idContainer:e,idContainerVersion:t,environment:n,method:"TagManager.publishContainerVersion"}).finally((function(){a.privateState.isUpdating=!1}))}},{key:"createOrUpdateVersion",value:function(e,t,n){var a=this;return this.privateState.isUpdating=!0,r["AjaxHelper"].post({method:t,idContainer:n,idContainerVersion:e.idcontainerversion},{name:e.name,description:e.description},{withTokenInUrl:!0}).finally((function(){a.privateState.isUpdating=!1}))}}]),e}(),jl=new hl,Ol={id:"versionNameHelpText",class:"inline-help-node"},Vl=Object(o["createElementVNode"])("br",null,null,-1),yl=Object(o["createElementVNode"])("br",null,null,-1),Tl=["innerHTML"];function Cl(e,t,n,a,i,r){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",Ol,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.translate("TagManager_VersionNameHelp"))+" ",1),Vl,yl,Object(o["withDirectives"])(Object(o["createElementVNode"])("span",{innerHTML:e.$sanitize(e.translate("TagManager_NameOfLatestVersion","<strong>".concat(e.lastVersion,"</strong>")))},null,8,Tl),[[o["vShow"],e.lastVersion]])])}var Nl=Object(o["defineComponent"])({props:{lastVersion:String}});Nl.render=Cl;var El=Nl,kl={id:"selectTagManagerEnvironmentHelp",class:"inline-help-node"};function Sl(e,t,n,a,i,r){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",kl,[Object(o["createElementVNode"])("div",null,Object(o["toDisplayString"])(e.translate("TagManager_VersionEnvironmentHelp")),1),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",{class:"alert alert-info",style:{"margin-bottom":"0","padding-bottom":"0"}},Object(o["toDisplayString"])(e.translate("TagManager_PublishLiveEnvironmentCapabilityRequired",e.translate("TagManager_CapabilityPublishLiveContainer"))),513),[[o["vShow"],!e.canPublishToLive]])])}var wl=Object(o["defineComponent"])({props:{canPublishToLive:Boolean}});wl.render=Sl;var Ml=wl;function _l(e){return Ul(e)||Bl(e)||Al(e)||Dl()}function Dl(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Al(e,t){if(e){if("string"===typeof e)return Ll(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ll(e,t):void 0}}function Bl(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Ul(e){if(Array.isArray(e))return Ll(e)}function Ll(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var xl="versiontagmanagement",Il=Object(o["defineComponent"])({props:{idContainerVersion:{type:Number,required:!0},idContainer:{type:String,required:!0},isEmbedded:{type:Boolean,default:!1}},components:{ContentBlock:r["ContentBlock"],Field:g["Field"],SaveButton:g["SaveButton"],ActivityIndicator:r["ActivityIndicator"]},directives:{ContentTable:r["ContentTable"]},data:function(){return{isDirty:!1,lastVersion:null,versionChanges:[],isLoadingVersionChanges:!1,isUpdatingVersion:!1,editTitle:"",version:{}}},emits:["changeVersion"],created:function(){et.init(),Ko.init(),this.initIdContainerVersion()},watch:{idContainerVersion:function(e){null!==e&&this.initIdContainerVersion()}},methods:{removeAnyVersionNotification:function(){r["NotificationsStore"].remove(xl),r["NotificationsStore"].remove("ajaxHelper")},showNotification:function(e,t){var n=r["NotificationsStore"].show({message:e,context:t,id:xl,type:"transient"});setTimeout((function(){r["NotificationsStore"].scrollToNotification(n)}),200)},showErrorFieldNotProvidedNotification:function(e){var t=Object(r["translate"])("TagManager_ErrorXNotProvided",[e]);this.showNotification(t,"error")},initIdContainerVersion:function(){var e=this;if(this.version={},this.lastVersion=null,this.versionChanges=[],this.isLoadingVersionChanges=!0,jl.fetchVersions(this.idContainer).then((function(){var t;e.isLoadingVersionChanges=!1,e.lastVersion=null;var n=_l(jl.versions.value);if(null!==n&&void 0!==n&&n.length){n.sort((function(e,t){return e.revision<t.revision?1:0}));var a=null;e.create&&null!==(t=n[0])&&void 0!==t&&t.name?(e.lastVersion=n[0].name,a=n[0].idcontainerversion):e.edit&&n.forEach((function(t,i){i>=n.length-1||t.idcontainerversion===e.idContainerVersion&&n[i+1]&&(e.lastVersion=n[i+1].name,a=n[i+1].idcontainerversion)})),e.lastVersion&&(e.isLoadingVersionChanges=!0,ll(e.idContainer,e.idContainerVersion,a).then((function(t){e.versionChanges=t,e.isLoadingVersionChanges=!1})),e.create&&!e.version.name&&/^\d+$/.test(e.lastVersion)&&(e.version.name="".concat(parseInt(e.lastVersion,10)+1),e.isDirty=!0))}})),r["Matomo"].helper.lazyScrollToContent(),this.edit&&this.idContainerVersion)return this.editTitle=Object(r["translate"])("TagManager_EditVersion"),void jl.findVersion(this.idContainer,this.idContainerVersion).then((function(t){t&&(e.version=Object(r["clone"])(t),e.isDirty=!1)}));this.create&&(this.editTitle=Object(r["translate"])("TagManager_CreateNewVersion"),this.version={idSite:r["Matomo"].idSite,idcontainer:this.idContainer,name:"",description:""},this.canPublishToLive?this.version.environments=["live"]:this.version.environments||(this.version.environments=[]),this.isDirty=!1)},cancel:function(){var e=Object.assign({},r["MatomoUrl"].hashParsed.value);delete e.idContainerVersion,r["MatomoUrl"].updateHash(e)},createVersion:function(){var e=this;this.removeAnyVersionNotification(),this.checkRequiredFieldsAreSet()&&(this.isUpdatingVersion=!0,jl.createOrUpdateVersion(this.version,"TagManager.createContainerVersion",this.idContainer).then((function(t){if(t){e.isDirty=!1;var n=t.value;if(e.isEmbedded)return e.version.idcontainerversion=n,void e.$emit("changeVersion",{version:e.version});jl.reload(e.idContainer).then((function(){r["MatomoUrl"].updateHash(Object.assign(Object.assign({},r["MatomoUrl"].hashParsed.value),{},{idContainerVersion:n})),setTimeout((function(){var t=Object(r["translate"])("TagManager_CreatedX",Object(r["translate"])("TagManager_Version")),n=Object(r["translate"])("TagManager_WantToDeployThisChangeCreateVersion",'<a class="createNewVersionLink">',"</a>");e.showNotification("".concat(t," ").concat(n),"success")}),200)}))}})).finally((function(){e.isUpdatingVersion=!1})))},createVersionAndPublish:function(){var e=this;this.removeAnyVersionNotification(),this.checkRequiredFieldsAreSet()&&(this.isUpdatingVersion=!0,jl.createOrUpdateVersion(this.version,"TagManager.createContainerVersion",this.idContainer).then((function(t){if(!t)return null;var n=t.value;return e.version.idcontainerversion=n,jl.publishVersion(e.idContainer,n,e.version.environments[0]).then((function(){e.isDirty=!1,e.isEmbedded?e.$emit("changeVersion",{version:e.version}):jl.reload(e.idContainer).then((function(){r["MatomoUrl"].updateHash(Object.assign(Object.assign({},r["MatomoUrl"].hashParsed.value),{},{idContainerVersion:n})),setTimeout((function(){e.showNotification(Object(r["translate"])("TagManager_VersionPublishSuccess"),"success")}),200)}))}))})).finally((function(){e.isUpdatingVersion=!1})))},setValueHasChanged:function(){this.isDirty=!0},updateVersion:function(){var e=this;this.removeAnyVersionNotification(),this.checkRequiredFieldsAreSet()&&(this.isUpdatingVersion=!0,jl.createOrUpdateVersion(this.version,"TagManager.updateContainerVersion",this.idContainer).then((function(t){t&&(e.isEmbedded?e.$emit("changeVersion",{version:e.version}):(e.isDirty=!1,e.version={},jl.reload(e.idContainer).then((function(){e.initIdContainerVersion()})),e.showNotification(Object(r["translate"])("TagManager_UpdatedX",Object(r["translate"])("TagManager_Version")),"success")))})).finally((function(){e.isUpdatingVersion=!1})))},checkRequiredFieldsAreSet:function(){if(!this.version.name){var e=Object(r["translate"])("General_Name");return this.showErrorFieldNotProvidedNotification(e),!1}return!0}},computed:{create:function(){return 0===this.idContainerVersion},edit:function(){return!this.create},isLoading:function(){return We.isLoading.value||et.isLoading.value},isUpdating:function(){return We.isUpdating.value||this.isUpdatingVersion},environments:function(){return Ko.environmentsWithPublishOptions.value},canPublishToLive:function(){return r["Matomo"].hasUserCapability("tagmanager_publish_live_container")},versionNameHelpText:function(){return Object(o["markRaw"])(El)},selectTagManagerEnvironmentHelp:function(){return Object(o["markRaw"])(Ml)}}});Il.render=Ro;var Pl=Il,Fl=(Object(r["createAngularJsAdapter"])({component:Pl,scope:{idContainerVersion:{angularJsBind:"="},idContainer:{angularJsBind:"="},onChangeVersion:{angularJsBind:"&?",vue:"changeVersion"}},directiveName:"piwikVersionEdit"}),{class:"tagManagerManageList tagManagerVersionList"}),Hl={class:"index"},$l={class:"name"},Gl={class:"description"},Rl={class:"environments"},Jl={class:"created"},ql={class:"action"},zl={colspan:"7"},Wl={class:"loadingPiwik"},Xl=Object(o["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Kl={colspan:"7"},Yl=["id"],Ql={class:"index"},Zl={class:"name"},ec=["title"],tc={class:"environments"},nc=["title"],ac={class:"created"},ic={class:"action"},rc=["onClick","title"],oc=["onClick","title"],lc=["onClick","href","title"],cc=["onClick","title"],sc=["onClick","title"],dc={class:"tableActionBar"},uc=Object(o["createElementVNode"])("span",{class:"icon-add"},null,-1),gc=["href"],bc=Object(o["createElementVNode"])("span",{class:"icon-export"},null,-1),mc=Object(o["createElementVNode"])("span",{class:"icon-upload"},null,-1),pc={class:"ui-confirm",id:"confirmDeleteVersion",ref:"confirmDeleteVersion"},vc=["value"],fc=["value"],hc={class:"ui-confirm",id:"confirmPublishVersion",ref:"confirmPublishVersion"},jc={key:0,class:"alert alert-info",style:{"margin-top":"16px"}},Oc=["value"],Vc=["value"];
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function yc(e,t,n,a,i,r){var l,c=Object(o["resolveComponent"])("ContentBlock"),s=Object(o["resolveComponent"])("Field"),d=Object(o["resolveDirective"])("content-table");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",Fl,[Object(o["createVNode"])(c,{feature:"Tag Manager","content-title":e.translate("TagManager_ManageX",e.translate("TagManager_Versions"))},{default:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("p",null,Object(o["toDisplayString"])(e.translate("TagManager_VersionUsageBenefits"))+" "+Object(o["toDisplayString"])(e.translate("TagManager_ConfigureEnvironmentsSuperUser")),1),Object(o["withDirectives"])(Object(o["createElementVNode"])("table",null,[Object(o["createElementVNode"])("thead",null,[Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("th",Hl,Object(o["toDisplayString"])(e.translate("TagManager_Revision")),1),Object(o["createElementVNode"])("th",$l,Object(o["toDisplayString"])(e.translate("General_Name")),1),Object(o["createElementVNode"])("th",Gl,Object(o["toDisplayString"])(e.translate("General_Description")),1),Object(o["createElementVNode"])("th",Rl,Object(o["toDisplayString"])(e.translate("TagManager_Environments")),1),Object(o["createElementVNode"])("th",Jl,Object(o["toDisplayString"])(e.translate("TagManager_Created")),1),Object(o["createElementVNode"])("th",ql,Object(o["toDisplayString"])(e.translate("General_Actions")),1)])]),Object(o["createElementVNode"])("tbody",null,[Object(o["withDirectives"])(Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("td",zl,[Object(o["createElementVNode"])("span",Wl,[Xl,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("General_LoadingData")),1)])])],512),[[o["vShow"],e.isLoading||e.isUpdating]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("td",Kl,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.translate("TagManager_NoVersionsFound"))+" ",1),Object(o["withDirectives"])(Object(o["createElementVNode"])("a",{class:"createContainerVersionNow",onClick:t[0]||(t[0]=function(t){return e.createVersion()})},Object(o["toDisplayString"])(e.translate("TagManager_CreateNewVersionNow")),513),[[o["vShow"],e.hasWriteAccess]])])],512),[[o["vShow"],!e.isLoading&&0===e.versions.length]]),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.sortedVersions,(function(t){return Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{id:"version".concat(t.idcontainerversion),class:"versions",key:t.revision},[Object(o["createElementVNode"])("td",Ql,Object(o["toDisplayString"])(t.revision),1),Object(o["createElementVNode"])("td",Zl,Object(o["toDisplayString"])(t.name),1),Object(o["createElementVNode"])("td",{class:"description",title:t.description},Object(o["toDisplayString"])(e.truncateText(t.description,30)),9,ec),Object(o["createElementVNode"])("td",tc,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(t.releases,(function(n,a){return Object(o["openBlock"])(),Object(o["createElementBlock"])("span",{key:a,title:e.translate("TagManager_ReleaseInfo",n.release_login,n.release_date_pretty)},[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.ucfirst(n.environment)),1),Object(o["withDirectives"])(Object(o["createElementVNode"])("span",null,", ",512),[[o["vShow"],a!==t.releases.length-1]])],8,nc)})),128))]),Object(o["createElementVNode"])("td",ac,[Object(o["createElementVNode"])("span",null,Object(o["toDisplayString"])(t.created_date_pretty),1)]),Object(o["createElementVNode"])("td",ic,[Object(o["withDirectives"])(Object(o["createElementVNode"])("a",{class:"table-action icon-rocket",onClick:function(n){return e.publishVersion(t)},title:e.translate("TagManager_PublishVersion",t.name)},null,8,rc),[[o["vShow"],e.hasWriteAccess]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("a",{class:"table-action icon-bug",onClick:function(n){return e.enableDebugMode(t.idcontainerversion)},title:e.translate("TagManager_EnablePreviewDebug")},null,8,oc),[[o["vShow"],e.hasWriteAccess]]),Object(o["createElementVNode"])("a",{target:"_blank",class:"table-action icon-export",onClick:Object(o["withModifiers"])((function(n){e.exportVersion(t.idcontainerversion,t.name)}),["prevent"]),href:e.getExportUrl(t),title:e.translate("TagManager_ExportX",e.translate("TagManager_Version"))},null,8,lc),Object(o["withDirectives"])(Object(o["createElementVNode"])("a",{class:"table-action icon-edit",onClick:function(n){return e.editVersion(t.idcontainerversion)},title:e.translate("TagManager_EditX",e.translate("TagManager_Version"))},null,8,cc),[[o["vShow"],e.hasWriteAccess]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("a",{class:"table-action icon-delete",onClick:function(n){return e.deleteVersion(t)},title:e.translate("TagManager_DeleteX",e.translate("TagManager_Version"))},null,8,sc),[[o["vShow"],0===t.releases.length&&e.hasWriteAccess]])])],8,Yl)})),128))])],512),[[d]]),Object(o["createElementVNode"])("div",dc,[Object(o["withDirectives"])(Object(o["createElementVNode"])("a",{class:"createNewVersion",onClick:t[1]||(t[1]=function(t){return e.createVersion()})},[uc,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("TagManager_CreateNewVersion")),1)],512),[[o["vShow"],e.hasWriteAccess]]),Object(o["createElementVNode"])("a",{class:"exportDraft",target:"_blank",onClick:t[2]||(t[2]=function(t){e.exportVersion(null,"draft"),t.preventDefault()}),href:e.getExportDraftUrl()},[bc,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("TagManager_ExportDraft")),1)],8,gc),Object(o["withDirectives"])(Object(o["createElementVNode"])("a",{class:"importVersion",onClick:t[3]||(t[3]=function(t){return e.importVersion()})},[mc,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("TagManager_Import")),1)],512),[[o["vShow"],e.hasWriteAccess]])])]})),_:1},8,["content-title"]),Object(o["createElementVNode"])("div",pc,[Object(o["createElementVNode"])("h2",null,Object(o["toDisplayString"])(e.translate("TagManager_DeleteVersionConfirm")),1),Object(o["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,vc),Object(o["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,fc)],512),Object(o["createElementVNode"])("div",hc,[Object(o["createElementVNode"])("h2",null,Object(o["toDisplayString"])(e.translate("TagManager_PublishVersion",null===(l=e.versionToBePublished)||void 0===l?void 0:l.name)),1),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",null,[Object(o["createElementVNode"])("div",null,[Object(o["createVNode"])(s,{uicontrol:"select",name:"environment",modelValue:e.availableEnvironmentsToPublish.deployEnvironment,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.availableEnvironmentsToPublish.deployEnvironment=t}),options:e.availableEnvironmentsToPublish.environnments,"full-width":!0,title:e.translate("TagManager_Environment")},null,8,["modelValue","options","title"])]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",{style:{"margin-bottom":"0"},class:"alert alert-info"},Object(o["toDisplayString"])(e.translate("TagManager_PublishLiveEnvironmentCapabilityRequired",e.translate("TagManager_CapabilityPublishLiveContainer"))),513),[[o["vShow"],!e.canPublishToLive]])],512),[[o["vShow"],e.availableEnvironmentsToPublish.environnments.length]]),e.availableEnvironmentsToPublish.environnments.length?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",jc,Object(o["toDisplayString"])(e.translate("TagManager_VersionAlreadyPublishedToAllEnvironments")),1)),Object(o["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("TagManager_PublishRelease")},null,8,Oc),Object(o["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_Cancel")},null,8,Vc)],512)])}function Tc(e){return kc(e)||Ec(e)||Nc(e)||Cc()}function Cc(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Nc(e,t){if(e){if("string"===typeof e)return Sc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Sc(e,t):void 0}}function Ec(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function kc(e){if(Array.isArray(e))return Sc(e)}function Sc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var wc=window,Mc=wc.tagManagerHelper,_c=Object(o["defineComponent"])({props:{idContainer:{type:String,required:!0}},components:{ContentBlock:r["ContentBlock"],Field:g["Field"]},directives:{ContentTable:r["ContentTable"]},data:function(){return{versionToBePublished:null}},created:function(){Ko.init(),jl.fetchVersions(this.idContainer)},methods:{createVersion:function(){this.editVersion(0)},truncateText:function(e,t){return e.length>t?"".concat(e.substr(0,t-3),"..."):e},publishVersion:function(e){var t=this;this.versionToBePublished=e,r["Matomo"].helper.modalConfirm(this.$refs.confirmPublishVersion,{yes:function(){var n=t.availableEnvironmentsToPublish.deployEnvironment;n&&jl.publishVersion(e.idcontainer,e.idcontainerversion,n).then((function(){jl.reload(t.idContainer)}))}})},enableDebugMode:function(e){Mc.enablePreviewMode(this.idContainer,e)},exportVersion:function(e,t){var n={module:"API",method:"TagManager.exportContainerVersion",format:"json",idContainer:this.idContainer,filter_limit:-1};e&&(n.idContainerVersion=e);var a="container_".concat(this.idContainer);t&&(a+="_".concat(t)),r["AjaxHelper"].fetch(n).then((function(e){r["Matomo"].helper.sendContentAsDownload("".concat(a,".json"),JSON.stringify(e))}))},editVersion:function(e){r["MatomoUrl"].updateHash(Object.assign(Object.assign({},r["MatomoUrl"].hashParsed.value),{},{idContainerVersion:e}))},importVersion:function(){Mc.importVersion(null,this.idContainer)},deleteVersion:function(e){var t=this,n=function(){jl.deleteVersion(t.idContainer,e.idcontainerversion).then((function(){jl.reload(t.idContainer)}))};r["Matomo"].helper.modalConfirm(this.$refs.confirmDeleteVersion,{yes:n})},ucfirst:function(e){return"".concat(e.substring(0,1).toUpperCase()).concat(e.substring(1))},getExportUrl:function(e){return"?module=TagManager&action=exportContainerVersion&idContainer=".concat(this.idContainer)+"&idContainerVersion=".concat(e.idcontainerversion,"&idSite=").concat(e.idsite)+"&period=day&date=yesterday"},getExportDraftUrl:function(){return"?module=TagManager&action=exportContainerVersion&idContainer=".concat(this.idContainer)+"&idSite=".concat(this.idSite,"&period=day&date=yesterday")}},computed:{environments:function(){return Ko.environmentsWithPublishOptions.value},availableEnvironmentsToPublish:function(){var e=this,t="",n=this.environments.filter((function(n){var a,i;if(null===(a=e.versionToBePublished)||void 0===a||!a.releases)return!0;var r=null===(i=e.versionToBePublished)||void 0===i?void 0:i.releases.some((function(e){return e.environment===(null===n||void 0===n?void 0:n.key)}));return r||t||(t=n.key),!r}));return{deployEnvironment:t,environnments:n}},idSite:function(){return r["Matomo"].idSite},isLoading:function(){return jl.isLoading.value},isUpdating:function(){return jl.isUpdating.value},versions:function(){return jl.versions.value},sortedVersions:function(){var e=Tc(this.versions);return e.sort((function(e,t){return e.revision<t.revision?1:e.revision>t.revision?0:1})),e},hasWriteAccess:function(){return r["Matomo"].hasUserCapability("tagmanager_write")},canPublishToLive:function(){return r["Matomo"].hasUserCapability("tagmanager_publish_live_container")}}});_c.render=yc;var Dc=_c,Ac=(Object(r["createAngularJsAdapter"])({component:Dc,scope:{idContainer:{angularJsBind:"="}},directiveName:"piwikVersionList"}),{class:"manageVersion"}),Bc={key:0},Uc={key:1};
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function Lc(e,t,n,a,i,r){var l=Object(o["resolveComponent"])("VersionList"),c=Object(o["resolveComponent"])("VersionEdit");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",Ac,[e.editMode?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",Bc,[Object(o["createVNode"])(l,{"id-container":e.idContainer},null,8,["id-container"])])),e.editMode?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",Uc,[Object(o["createVNode"])(c,{"id-container":e.idContainer,"id-container-version":e.idContainerVersion},null,8,["id-container","id-container-version"])])):Object(o["createCommentVNode"])("",!0)])}var xc=Object(o["defineComponent"])({props:{idContainer:String},components:{VersionList:Dc,VersionEdit:Pl},data:function(){return{isAddAllowed:!1}},created:function(){var e=this;Object(o["watch"])((function(){return r["MatomoUrl"].hashParsed.value.idContainerVersion}),(function(t){e.onIdContainerVersionParamChange(t)})),r["NotificationsStore"].remove("versiontagmanagement"),this.onIdContainerVersionParamChange(r["MatomoUrl"].hashParsed.value.idContainerVersion)},methods:{onIdContainerVersionParamChange:function(e){if("0"===e){var t={isAllowed:!0};r["Matomo"].postEvent("TagManager.initAddVersion",t),this.isAddAllowed=!!t.isAllowed}}},computed:{idContainerVersion:function(){var e=r["MatomoUrl"].hashParsed.value.idContainerVersion;return this.isAddAllowed||"0"!==e?e?parseInt(e,10):e:null},editMode:function(){return"number"===typeof this.idContainerVersion}}});xc.render=Lc;var Ic=xc,Pc=(Object(r["createAngularJsAdapter"])({component:Ic,scope:{idContainer:{angularJsBind:"@"}},directiveName:"piwikVersionManage"}),{class:"loadingPiwik"}),Fc=Object(o["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Hc={class:"loadingPiwik"},$c=Object(o["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Gc={class:"entityCancel"};
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function Rc(e,t,n,a,i,r){var l=Object(o["resolveComponent"])("Field"),c=Object(o["resolveComponent"])("SaveButton"),s=Object(o["resolveComponent"])("ContentBlock");return Object(o["openBlock"])(),Object(o["createBlock"])(s,{class:"editContainer tagManagerManageEdit",feature:"Tag Manager","content-title":e.editTitle},{default:Object(o["withCtx"])((function(){return[Object(o["withDirectives"])(Object(o["createElementVNode"])("p",null,[Object(o["createElementVNode"])("span",Pc,[Fc,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("General_LoadingData")),1)])],512),[[o["vShow"],e.isLoading]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("p",null,[Object(o["createElementVNode"])("span",Hc,[$c,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("TagManager_UpdatingData")),1)])],512),[[o["vShow"],e.isUpdating]]),Object(o["createElementVNode"])("form",{onSubmit:t[5]||(t[5]=function(t){return e.edit?e.updateContainer():e.createContainer()})},[Object(o["createElementVNode"])("div",null,[Object(o["createElementVNode"])("div",null,[Object(o["withDirectives"])(Object(o["createVNode"])(l,{uicontrol:"text",name:"idcontainer","model-value":e.container.idcontainer,disabled:!0,title:e.translate("General_Id")},null,8,["model-value","title"]),[[o["vShow"],e.edit]])]),Object(o["createElementVNode"])("div",null,[Object(o["createVNode"])(l,{uicontrol:"select",name:"context","model-value":e.container.context,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.container.context=t,e.setValueHasChanged()}),disabled:!0,options:e.contexts,title:e.translate("TagManager_Context"),"inline-help":e.translate("TagManager_ContainerContextHelp")},null,8,["model-value","options","title","inline-help"])]),Object(o["createElementVNode"])("div",null,[Object(o["createVNode"])(l,{uicontrol:"text",name:"name","model-value":e.container.name,"onUpdate:modelValue":t[1]||(t[1]=function(t){e.container.name=t,e.setValueHasChanged()}),maxlength:50,title:e.translate("General_Name"),"inline-help":e.translate("TagManager_ContainerNameHelp")},null,8,["model-value","title","inline-help"])]),Object(o["createElementVNode"])("div",null,[Object(o["createVNode"])(l,{uicontrol:"textarea",name:"description","model-value":e.container.description,"onUpdate:modelValue":t[2]||(t[2]=function(t){e.container.description=t,e.setValueHasChanged()}),title:e.translate("General_Description"),"inline-help":e.translate("TagManager_ContainerDescriptionHelp")},null,8,["model-value","title","inline-help"])]),Object(o["createVNode"])(c,{class:"createButton",onConfirm:t[3]||(t[3]=function(t){return e.edit?e.updateContainer():e.createContainer()}),disabled:e.isUpdating||!e.isDirty,saving:e.isUpdating,value:e.edit?e.translate("CoreUpdater_UpdateTitle"):e.translate("TagManager_CreateNewContainer")},null,8,["disabled","saving","value"]),Object(o["createElementVNode"])("div",Gc,[Object(o["createElementVNode"])("a",{onClick:t[4]||(t[4]=function(t){return e.cancel()})},Object(o["toDisplayString"])(e.translate("General_Cancel")),1)])])],32)]})),_:1},8,["content-title"])}function Jc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qc(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function zc(e,t,n){return t&&qc(e.prototype,t),n&&qc(e,n),e}function Wc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var Xc=function(){function e(){var t=this;Jc(this,e),Wc(this,"privateState",Object(o["reactive"])({contexts:[],isLoading:!1})),Wc(this,"state",Object(o["computed"])((function(){return Object(o["readonly"])(t.privateState)}))),Wc(this,"isLoading",Object(o["computed"])((function(){return t.state.value.isLoading}))),Wc(this,"contexts",Object(o["computed"])((function(){return t.state.value.contexts}))),Wc(this,"contextsOptions",Object(o["computed"])((function(){return t.contexts.value.map((function(e){var t=e.id,n=e.name;return{key:t,value:n}}))}))),Wc(this,"initializePromise",null)}return zc(e,[{key:"init",value:function(){return this.initializePromise||(this.initializePromise=this.fetchAvailableContexts()),this.initializePromise}},{key:"fetchAvailableContexts",value:function(){var e=this;return this.privateState.isLoading=!0,r["AjaxHelper"].fetch({method:"TagManager.getAvailableContexts",filter_limit:"-1"}).then((function(t){var n;n=Array.isArray(t)?t:Object.values(t),e.privateState.contexts=n})).finally((function(){e.privateState.isLoading=!1}))}}]),e}(),Kc=new Xc;function Yc(e){return ts(e)||es(e)||Zc(e)||Qc()}function Qc(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Zc(e,t){if(e){if("string"===typeof e)return ns(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ns(e,t):void 0}}function es(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function ts(e){if(Array.isArray(e))return ns(e)}function ns(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function as(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function is(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function rs(e,t,n){return t&&is(e.prototype,t),n&&is(e,n),e}function os(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */var ls=function(){function e(){var t=this;as(this,e),os(this,"privateState",Object(o["reactive"])({containers:[],isLoadingContainers:!1,isLoadingSingle:!1,isUpdating:!1})),os(this,"state",Object(o["computed"])((function(){return Object(o["readonly"])(t.privateState)}))),os(this,"isLoading",Object(o["computed"])((function(){var e=t.state.value;return e.isLoadingContainers||e.isLoadingSingle}))),os(this,"isUpdating",Object(o["computed"])((function(){return t.state.value.isUpdating}))),os(this,"containers",Object(o["computed"])((function(){return t.state.value.containers}))),os(this,"fetchPromise",null)}return rs(e,[{key:"reload",value:function(){return this.privateState.containers=[],this.fetchPromise=null,this.fetchContainers()}},{key:"fetchContainers",value:function(){var e=this;return this.privateState.isLoadingContainers=!0,this.privateState.containers=[],this.fetchPromise||(this.fetchPromise=r["AjaxHelper"].fetch({method:"TagManager.getContainers",filter_limit:"-1"})),Promise.resolve(this.fetchPromise).then((function(t){return e.privateState.containers=t,e.privateState.isLoadingContainers=!1,e.containers.value})).finally((function(){e.privateState.isLoadingContainers=!1}))}},{key:"findContainer",value:function(e){var t=this,n=this.containers.value.find((function(t){return t.idcontainer===e}));return n?Promise.resolve(n):(this.privateState.isLoadingSingle=!0,r["AjaxHelper"].fetch({idContainer:e,method:"TagManager.getContainer",filter_limit:"-1"}).then((function(e){return t.privateState.containers=[].concat(Yc(t.privateState.containers),[e]),Object(o["readonly"])(e)})).finally((function(){t.privateState.isLoadingSingle=!1})))}},{key:"deleteContainer",value:function(e){var t=this;return this.privateState.isUpdating=!0,this.privateState.containers=[],r["AjaxHelper"].fetch({idContainer:e,method:"TagManager.deleteContainer"},{withTokenInUrl:!0}).finally((function(){t.privateState.isUpdating=!1}))}},{key:"createOrUpdateContainer",value:function(e,t){var n=this;return this.privateState.isUpdating=!0,r["AjaxHelper"].post({method:t,idContainer:e.idcontainer},{name:e.name,description:e.description,context:e.context},{withTokenInUrl:!0}).finally((function(){n.privateState.isUpdating=!1}))}}]),e}(),cs=new ls,ss="containertagmanagement",ds=Object(o["defineComponent"])({props:{idContainer:String},components:{ContentBlock:r["ContentBlock"],Field:g["Field"],SaveButton:g["SaveButton"]},data:function(){return{isDirty:!1,editTitle:"",isUpdatingVersion:!1,container:{}}},created:function(){Kc.init(),et.init(),this.initIdContainer()},watch:{idContainer:function(e){null!==e&&this.initIdContainer()}},methods:{removeAnyContainerNotification:function(){r["NotificationsStore"].remove(ss),r["NotificationsStore"].remove("ajaxHelper")},showNotification:function(e,t){var n=r["NotificationsStore"].show({message:e,context:t,id:ss,type:"transient"});setTimeout((function(){r["NotificationsStore"].scrollToNotification(n)}),200)},showErrorFieldNotProvidedNotification:function(e){var t=Object(r["translate"])("TagManager_ErrorXNotProvided",[e]);this.showNotification(t,"error")},initIdContainer:function(){var e=this;this.container={},r["Matomo"].helper.lazyScrollToContent(),this.edit&&this.idContainer?(this.editTitle=Object(r["translate"])("TagManager_EditContainer"),cs.findContainer(this.idContainer).then((function(t){t&&(e.container=Object(r["clone"])(t),e.isDirty=!1)}))):this.create&&(this.editTitle=Object(r["translate"])("TagManager_CreateNewContainer"),this.container={idSite:r["Matomo"].idSite,name:"",context:"web",description:""},this.isDirty=!1)},cancel:function(){var e=Object.assign({},r["MatomoUrl"].hashParsed.value);delete e.idContainer,r["MatomoUrl"].updateHash(e)},createContainer:function(){var e=this;this.removeAnyContainerNotification(),this.checkRequiredFieldsAreSet()&&(this.isUpdatingVersion=!0,cs.createOrUpdateContainer(this.container,"TagManager.addContainer").then((function(t){if(e.isUpdatingVersion=!1,t){e.isDirty=!1;var n=t.value;e.showNotification(Object(r["translate"])("TagManager_CreatedX",Object(r["translate"])("TagManager_Container")),"success"),r["MatomoUrl"].updateUrl(Object.assign(Object.assign({},r["MatomoUrl"].urlParsed.value),{},{module:"TagManager",action:"dashboard",idContainer:n}))}})).finally((function(){e.isUpdatingVersion=!1})))},setValueHasChanged:function(){this.isDirty=!0},updateContainer:function(){var e=this;this.removeAnyContainerNotification(),this.checkRequiredFieldsAreSet()&&(this.isUpdating=!0,cs.createOrUpdateContainer(this.container,"TagManager.updateContainer").then((function(t){t&&(e.isDirty=!1,e.container={},cs.reload().then((function(){e.initIdContainer()})),e.showNotification(Object(r["translate"])("TagManager_UpdatedX",Object(r["translate"])("TagManager_Container")),"success"))})))},checkRequiredFieldsAreSet:function(){if(!this.container.name){var e=Object(r["translate"])("General_Name");return this.showErrorFieldNotProvidedNotification(e),!1}return!0}},computed:{contexts:function(){return Kc.contextsOptions.value},create:function(){return"0"===this.idContainer},edit:function(){return!this.create},isLoading:function(){return We.isLoading.value||et.isLoading.value},isUpdating:function(){return We.isUpdating.value||this.isUpdatingVersion}}});ds.render=Rc;var us=ds,gs=(Object(r["createAngularJsAdapter"])({component:us,scope:{idContainer:{angularJsBind:"="}},directiveName:"piwikContainerEdit"}),{class:"tagManagerManageList tagManagerContainerList"}),bs={class:"index"},ms={class:"name"},ps={class:"description"},vs={class:"created"},fs={class:"action"},hs={colspan:"5"},js={class:"loadingPiwik"},Os=Object(o["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),Vs={colspan:"5"},ys=["id"],Ts=["title"],Cs={class:"name"},Ns=["title"],Es={class:"created"},ks={class:"action"},Ss=["href","title"],ws=["onClick","title"],Ms=["onClick","title"],_s=["onClick","title"],Ds={class:"tableActionBar"},As=Object(o["createElementVNode"])("span",{class:"icon-add"},null,-1),Bs={class:"ui-confirm",id:"confirmDeleteContainer",ref:"confirmDeleteContainer"},Us=["value"],Ls=["value"];
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function xs(e,t,n,a,i,r){var l=Object(o["resolveComponent"])("ContentBlock"),c=Object(o["resolveDirective"])("content-table");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",gs,[Object(o["createVNode"])(l,{feature:"Tag Manager","content-title":e.translate("TagManager_ManageX",e.translate("TagManager_Containers"))},{default:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("p",null,Object(o["toDisplayString"])(e.translate("TagManager_ContainerUsageBenefits")),1),Object(o["withDirectives"])(Object(o["createElementVNode"])("table",null,[Object(o["createElementVNode"])("thead",null,[Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("th",bs,Object(o["toDisplayString"])(e.translate("General_Id")),1),Object(o["createElementVNode"])("th",ms,Object(o["toDisplayString"])(e.translate("General_Name")),1),Object(o["createElementVNode"])("th",ps,Object(o["toDisplayString"])(e.translate("General_Description")),1),Object(o["createElementVNode"])("th",vs,Object(o["toDisplayString"])(e.translate("TagManager_CreatedDate")),1),Object(o["createElementVNode"])("th",fs,Object(o["toDisplayString"])(e.translate("General_Actions")),1)])]),Object(o["createElementVNode"])("tbody",null,[Object(o["withDirectives"])(Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("td",hs,[Object(o["createElementVNode"])("span",js,[Os,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("General_LoadingData")),1)])])],512),[[o["vShow"],e.isLoading||e.isUpdating]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("td",Vs,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.translate("TagManager_NoContainersFound"))+" ",1),Object(o["withDirectives"])(Object(o["createElementVNode"])("a",{class:"createContainerNow",onClick:t[0]||(t[0]=function(t){return e.createContainer()})},Object(o["toDisplayString"])(e.translate("TagManager_CreateNewContainerNow")),513),[[o["vShow"],e.hasWriteAccess]])])],512),[[o["vShow"],!e.isLoading&&0===e.containers.length]]),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.sortedContainers,(function(t){return Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{id:"container".concat(t.idcontainer),class:"containers",key:t.idcontainer},[Object(o["createElementVNode"])("td",{class:"index",title:"".concat(e.translate("TagManager_Context"),": ")+e.contexts[t.context]},Object(o["toDisplayString"])(t.idcontainer),9,Ts),Object(o["createElementVNode"])("td",Cs,Object(o["toDisplayString"])(t.name),1),Object(o["createElementVNode"])("td",{class:"description",title:t.description},Object(o["toDisplayString"])(e.truncateText(t.description,50)),9,Ns),Object(o["createElementVNode"])("td",Es,[Object(o["createElementVNode"])("span",null,Object(o["toDisplayString"])(t.created_date_pretty),1)]),Object(o["createElementVNode"])("td",ks,[Object(o["createElementVNode"])("a",{class:"table-action icon-configure",href:"?module=TagManager&action="+e.containerDefaultAction+"&idContainer="+t.idcontainer+"&idSite="+t.idsite+"&period=day&date=yesterday",title:e.translate("TagManager_ConfigureX",e.translate("TagManager_Container"))},null,8,Ss),Object(o["createElementVNode"])("a",{class:"table-action installCode icon-embed",onClick:function(n){return e.installCode(t.idcontainer)},title:e.translate("TagManager_InstallCode")},null,8,ws),Object(o["withDirectives"])(Object(o["createElementVNode"])("a",{class:"table-action icon-edit",onClick:function(n){return e.editContainer(t.idcontainer)},title:e.translate("TagManager_EditX",e.translate("TagManager_Container"))},null,8,Ms),[[o["vShow"],e.hasWriteAccess]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("a",{class:"table-action icon-delete",onClick:function(n){return e.deleteContainer(t)},title:e.translate("TagManager_DeleteX",e.translate("TagManager_Container"))},null,8,_s),[[o["vShow"],e.hasWriteAccess]])])],8,ys)})),128))])],512),[[c]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",Ds,[Object(o["createElementVNode"])("a",{class:"createNewContainer",value:"",onClick:t[1]||(t[1]=function(t){return e.createContainer()})},[As,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("TagManager_CreateNewContainer")),1)])],512),[[o["vShow"],e.hasWriteAccess]])]})),_:1},8,["content-title"]),Object(o["createElementVNode"])("div",Bs,[Object(o["createElementVNode"])("h2",null,Object(o["toDisplayString"])(e.translate("TagManager_DeleteContainerConfirm")),1),Object(o["createElementVNode"])("input",{role:"yes",type:"button",value:e.translate("General_Yes")},null,8,Us),Object(o["createElementVNode"])("input",{role:"no",type:"button",value:e.translate("General_No")},null,8,Ls)],512)])}function Is(e){return $s(e)||Hs(e)||Fs(e)||Ps()}function Ps(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Fs(e,t){if(e){if("string"===typeof e)return Gs(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Gs(e,t):void 0}}function Hs(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function $s(e){if(Array.isArray(e))return Gs(e)}function Gs(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var Rs=window,Js=Rs.tagManagerHelper,qs=Object(o["defineComponent"])({components:{ContentBlock:r["ContentBlock"]},directives:{ContentTable:r["ContentTable"]},created:function(){Kc.init(),cs.fetchContainers()},computed:{contexts:function(){var e={};return Kc.contexts.value.forEach((function(t){var n=t.id,a=t.name;e[n]=a})),e},hasWriteAccess:function(){return r["Matomo"].hasUserCapability("tagmanager_write")},containerDefaultAction:function(){return this.hasWriteAccess?"dashboard":"manageTags"},isLoading:function(){return jl.isLoading.value},isUpdating:function(){return jl.isUpdating.value},containers:function(){return cs.containers.value},sortedContainers:function(){var e=Is(this.containers);return e.sort((function(e,t){return e.created_date<t.created_date?1:e.created_date>t.created_date?-1:0})),e}},methods:{createContainer:function(){this.editContainer("0")},editContainer:function(e){r["MatomoUrl"].updateHash(Object.assign(Object.assign({},r["MatomoUrl"].hashParsed.value),{},{idContainer:e}))},installCode:function(e){Js.showInstallCode(e)},deleteContainer:function(e){function t(){cs.deleteContainer(e.idcontainer).then((function(){cs.reload()}))}r["Matomo"].helper.modalConfirm(this.$refs.confirmDeleteContainer,{yes:t})},truncateText:function(e,t){return e.length>t?"".concat(e.substr(0,t-3),"..."):e}}});qs.render=xs;var zs=qs,Ws=(Object(r["createAngularJsAdapter"])({component:zs,directiveName:"piwikContainerList"}),{class:"manageContainer"});
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function Xs(e,t,n,a,i,r){var l=Object(o["resolveComponent"])("ContainerList"),c=Object(o["resolveComponent"])("ContainerEdit");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",Ws,[Object(o["withDirectives"])(Object(o["createElementVNode"])("div",null,[Object(o["createVNode"])(l)],512),[[o["vShow"],!e.editMode]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",null,[Object(o["createVNode"])(c,{"id-container":e.idContainer},null,8,["id-container"])],512),[[o["vShow"],e.editMode]])])}var Ks=Object(o["defineComponent"])({props:{},components:{ContainerList:zs,ContainerEdit:us},data:function(){return{isAddAllowed:!1}},created:function(){var e=this;Object(o["watch"])((function(){return r["MatomoUrl"].hashParsed.value.idContainer}),(function(t){e.onIdContainerParamChange(t)})),r["NotificationsStore"].remove("containertagmanagement"),this.onIdContainerParamChange(r["MatomoUrl"].hashParsed.value.idContainer)},computed:{idContainer:function(){var e=r["MatomoUrl"].hashParsed.value.idContainer;return this.isAddAllowed||""!==e?e:null},editMode:function(){return!!this.idContainer}},methods:{onIdContainerParamChange:function(e){if("0"===e){var t={isAllowed:!0};r["Matomo"].postEvent("TagManager.initAddVersion",t),this.isAddAllowed=!!t.isAllowed}}}});Ks.render=Xs;var Ys=Ks,Qs=(Object(r["createAngularJsAdapter"])({component:Ys,directiveName:"piwikContainerManage"}),{class:"containerDashboard.containerDashboard"}),Zs={key:0},ed={class:"dashboardCreationDate"},td={key:0},nd=Object(o["createElementVNode"])("br",null,null,-1),ad={class:"row",style:{"margin-left":"-0.75rem"}},id={class:"col m6 s12"},rd={key:0},od=["href","title"],ld={key:0},cd=Object(o["createElementVNode"])("hr",null,null,-1),sd=["href"],dd=Object(o["createElementVNode"])("span",{class:"icon-edit"},null,-1),ud=["href"],gd=Object(o["createElementVNode"])("span",{class:"icon-add"},null,-1),bd={class:"col m6 s12"},md={key:0},pd=["href","title"],vd=Object(o["createElementVNode"])("hr",null,null,-1),fd=["href"],hd=Object(o["createElementVNode"])("span",{class:"icon-edit"},null,-1),jd=["href"],Od=Object(o["createElementVNode"])("span",{class:"icon-add"},null,-1),Vd={class:"row",style:{"margin-left":"-0.75rem"}},yd={class:"col m6 s12"},Td=["href","title"],Cd={key:0},Nd=Object(o["createElementVNode"])("hr",null,null,-1),Ed=["href"],kd=Object(o["createElementVNode"])("span",{class:"icon-edit"},null,-1),Sd=["href"],wd=Object(o["createElementVNode"])("span",{class:"icon-add"},null,-1),Md={class:"col m6 s12"},_d=["title","href"],Dd={key:0},Ad=Object(o["createElementVNode"])("br",null,null,-1),Bd=["title"],Ud={key:0},Ld=Object(o["createElementVNode"])("hr",null,null,-1),xd=["href"],Id=Object(o["createElementVNode"])("span",{class:"icon-edit"},null,-1),Pd=["href"],Fd=Object(o["createElementVNode"])("span",{class:"icon-add"},null,-1);
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function Hd(e,t,n,a,i,r){var l,c,s=Object(o["resolveComponent"])("ActivityIndicator"),d=Object(o["resolveComponent"])("EnrichedHeadline"),u=Object(o["resolveComponent"])("ContentBlock"),g=Object(o["resolveDirective"])("content-intro");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",Qs,[Object(o["createVNode"])(s,{loading:e.isLoading},null,8,["loading"]),e.isLoading?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",Zs,[Object(o["withDirectives"])(Object(o["createElementVNode"])("div",null,[Object(o["createElementVNode"])("h2",null,[Object(o["createVNode"])(d,{"feature-name":"Tag Manager","inline-help":e.translate("TagManager_GettingStartedNotice")},{default:Object(o["withCtx"])((function(){var t;return[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.translate("TagManager_ContainerX",null===(t=e.container)||void 0===t?void 0:t.name)),1)]})),_:1},8,["inline-help"])]),Object(o["createElementVNode"])("p",ed,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.containerMetaInformation)+" ",1),null!==(l=e.containerVersion)&&void 0!==l&&l.description?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",td,[nd,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("General_Description"))+": "+Object(o["toDisplayString"])(null===(c=e.containerVersion)||void 0===c?void 0:c.description),1)])):Object(o["createCommentVNode"])("",!0)])],512),[[g]]),Object(o["createElementVNode"])("div",ad,[Object(o["createElementVNode"])("div",id,[Object(o["createVNode"])(u,{"content-title":"".concat(e.tagCount," ").concat(e.translate("TagManager_Tags"))},{default:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("p",null,[e.tagCount?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",rd,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.translate("TagManager_Names"))+": ",1),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.sortedContainerVersionTags,(function(t,n){return Object(o["openBlock"])(),Object(o["createElementBlock"])("span",{key:n},[Object(o["createElementVNode"])("a",{href:e.linkTo("manageTags",{idTag:t.idtag}),title:e.translate("TagManager_EntityDateTypeMetaInformation",t.created_date_pretty,t.updated_date_pretty,t.type)},Object(o["toDisplayString"])(t.name),9,od),n!==e.sortedContainerVersionTags.length-1?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",ld,", ")):Object(o["createCommentVNode"])("",!0)])})),128))])):Object(o["createCommentVNode"])("",!0)]),cd,Object(o["createElementVNode"])("a",{class:"btn-flat",href:e.linkTo("manageTags")},[dd,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("TagManager_EditTags")),1)],8,sd),Object(o["createElementVNode"])("a",{class:"btn-flat",href:e.linkTo("manageTags",{idTag:0})},[gd,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("TagManager_CreateNewTag")),1)],8,ud)]})),_:1},8,["content-title"])]),Object(o["createElementVNode"])("div",bd,[Object(o["createVNode"])(u,{"content-title":"".concat(e.triggerCount," ").concat(e.translate("TagManager_Triggers"))},{default:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("p",null,[e.triggerCount?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",md,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.translate("TagManager_Names"))+": ",1),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.sortedTriggers,(function(t,n){return Object(o["openBlock"])(),Object(o["createElementBlock"])("span",{key:n},[Object(o["createElementVNode"])("a",{href:e.linkTo("manageTriggers",{idTrigger:t.idtrigger}),title:e.translate("TagManager_EntityDateTypeMetaInformation",t.created_date_pretty,t.updated_date_pretty,t.type)},Object(o["toDisplayString"])(t.name),9,pd),Object(o["withDirectives"])(Object(o["createElementVNode"])("span",null,", ",512),[[o["vShow"],n!==e.sortedTriggers.length-1]])])})),128))])):Object(o["createCommentVNode"])("",!0)]),vd,Object(o["createElementVNode"])("a",{class:"btn-flat",href:e.linkTo("manageTriggers")},[hd,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("TagManager_EditTriggers")),1)],8,fd),Object(o["createElementVNode"])("a",{class:"btn-flat",href:e.linkTo("manageTriggers",{idTrigger:0})},[Od,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("TagManager_CreateNewTrigger")),1)],8,jd)]})),_:1},8,["content-title"])])]),Object(o["createElementVNode"])("div",Vd,[Object(o["createElementVNode"])("div",yd,[Object(o["createVNode"])(u,{"content-title":"".concat(e.variableCount," ").concat(e.translate("TagManager_Variables"))},{default:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("p",null,[Object(o["withDirectives"])(Object(o["createElementVNode"])("span",null,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.translate("TagManager_Names"))+": ",1),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.sortedVariables,(function(t,n){return Object(o["openBlock"])(),Object(o["createElementBlock"])("span",{key:n},[Object(o["createElementVNode"])("a",{href:e.linkTo("manageVariables",{idVariable:t.idvariable}),title:e.translate("TagManager_EntityDateTypeMetaInformation",t.created_date_pretty,t.updated_date_pretty,t.type)},Object(o["toDisplayString"])(t.name),9,Td),n!==e.sortedVariables.length-1?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",Cd,", ")):Object(o["createCommentVNode"])("",!0)])})),128))],512),[[o["vShow"],e.variableCount]])]),Nd,Object(o["createElementVNode"])("a",{class:"btn-flat",href:e.linkTo("manageVariables")},[kd,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("TagManager_EditVariables")),1)],8,Ed),Object(o["createElementVNode"])("a",{class:"btn-flat",href:e.linkTo("manageVariables",{idVariable:0})},[wd,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("TagManager_CreateNewVariable")),1)],8,Sd)]})),_:1},8,["content-title"])]),Object(o["createElementVNode"])("div",Md,[Object(o["createVNode"])(u,{"content-title":"".concat(e.versionCount," ").concat(e.translate("TagManager_Versions"))},{default:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("p",null,[Object(o["withDirectives"])(Object(o["createElementVNode"])("span",null,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.translate("TagManager_LastVersions"))+": ",1),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.lastVersions,(function(t,n){return Object(o["openBlock"])(),Object(o["createElementBlock"])("span",{key:n},[Object(o["createElementVNode"])("a",{title:e.lastVersionLinkTitle(t),href:e.linkTo("manageVersions",{idContainerVersion:t.idcontainerversion})},Object(o["toDisplayString"])(t.name),9,_d),n!==e.lastVersions.length-1?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",Dd,", ")):Object(o["createCommentVNode"])("",!0)])})),128))],512),[[o["vShow"],e.lastVersions.length]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("span",null,[Ad,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("TagManager_Environments"))+": ",1),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.container.releases,(function(t,n){return Object(o["openBlock"])(),Object(o["createElementBlock"])("span",{key:n},[Object(o["createElementVNode"])("span",{title:e.releaseTooltip(t)},Object(o["toDisplayString"])(e.ucfirst(t.environment)),9,Bd),n!==e.container.releases.length-1?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",Ud,", ")):Object(o["createCommentVNode"])("",!0)])})),128))],512),[[o["vShow"],e.container.releases.length]])]),Ld,Object(o["createElementVNode"])("a",{class:"btn-flat",href:e.linkTo("manageVersions")},[Id,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("TagManager_EditVersions")),1)],8,xd),Object(o["createElementVNode"])("a",{class:"btn-flat",href:e.linkTo("manageVersions",{idContainerVersion:0})},[Fd,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("TagManager_CreateNewVersion")),1)],8,Pd)]})),_:1},8,["content-title"])])])]))])}function $d(e){e.sort((function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}))}var Gd=Object(o["defineComponent"])({props:{idContainer:String},components:{ActivityIndicator:r["ActivityIndicator"],EnrichedHeadline:r["EnrichedHeadline"],ContentBlock:r["ContentBlock"]},directives:{ContentIntro:r["ContentIntro"]},data:function(){return{container:null,containerVersion:null,isLoading:!1}},created:function(){var e=this;Kc.init(),this.isLoading=!0;var t=r["AjaxHelper"].fetch({method:"TagManager.getContainer",idContainer:this.idContainer}).then((function(t){e.container=t})),n=r["AjaxHelper"].fetch({method:"TagManager.exportContainerVersion",idContainer:this.idContainer}).then((function(t){e.containerVersion=t}));Promise.all([t,n]).finally((function(){e.isLoading=!1}))},methods:{linkTo:function(e,t){var n=r["MatomoUrl"].stringify(Object.assign(Object.assign({},r["MatomoUrl"].urlParsed.value),{},{module:"TagManager",action:e}));return t&&(n+="#?".concat(r["MatomoUrl"].stringify(t))),"?".concat(n)},lastVersionLinkTitle:function(e){return"Created on ".concat(e.created_date_pretty)+", description: '".concat(e.description,"'")},releaseTooltip:function(e){var t=Object(r["translate"])("TagManager_ReleaseInfo",e.release_login,e.release_date_pretty),n=Object(r["translate"])("TagManager_ReleaseVersionInfo",e.version_name);return"".concat(t," ").concat(n)},ucfirst:function(e){return"".concat(e.substr(0,1).toUpperCase()).concat(e.substr(1))}},computed:{lastVersions:function(){var e,t;return null!==(e=this.container)&&void 0!==e&&null!==(t=e.versions)&&void 0!==t&&t.length?this.container.versions.slice(-5):[]},contexts:function(){var e={};return Kc.contexts.value.forEach((function(t){var n=t.id,a=t.name;e[n]=a})),e},containerMetaInformation:function(){var e,t,n;return Object(r["translate"])("TagManager_ContainerMetaInformation",(null===(e=this.containerVersion)||void 0===e?void 0:e.idcontainer)||"",this.contexts[(null===(t=this.container)||void 0===t?void 0:t.context)||""]||"",(null===(n=this.containerVersion)||void 0===n?void 0:n.created_date_pretty)||"")},sortedContainerVersionTags:function(){var e,t=(null===(e=this.containerVersion)||void 0===e?void 0:e.tags)||[];return $d(t),t},sortedTriggers:function(){var e,t=(null===(e=this.containerVersion)||void 0===e?void 0:e.triggers)||[];return $d(t),t},sortedVariables:function(){var e,t=(null===(e=this.containerVersion)||void 0===e?void 0:e.variables)||[];return $d(t),t},tagCount:function(){var e;return null===(e=this.containerVersion)||void 0===e?void 0:e.tags.length},triggerCount:function(){var e;return null===(e=this.containerVersion)||void 0===e?void 0:e.triggers.length},versionCount:function(){var e;return null===(e=this.container)||void 0===e?void 0:e.versions.length},variableCount:function(){var e;return null===(e=this.containerVersion)||void 0===e?void 0:e.variables.length}}});Gd.render=Hd;var Rd=Gd,Jd=(Object(r["createAngularJsAdapter"])({component:Rd,scope:{idContainer:{angularJsBind:"@"}},directiveName:"piwikContainerDashboard"}),["title"]),qd={class:"title"},zd=Object(o["createElementVNode"])("span",{class:"icon icon-arrow-bottom"},null,-1),Wd={class:"dropdown positionInViewport"},Xd={class:"custom_select_container"},Kd={class:"custom_select_ul_list"},Yd=["title"],Qd=["href"];
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function Zd(e,t,n,a,i,r){var l=Object(o["resolveComponent"])("ActivityIndicator"),c=Object(o["resolveDirective"])("focus-anywhere-but-here");return Object(o["withDirectives"])((Object(o["openBlock"])(),Object(o["createElementBlock"])("div",{class:Object(o["normalizeClass"])(["tagContainerSelector piwikSelector borderedControl",{expanded:e.showContainerList}]),onClick:t[1]||(t[1]=function(t){e.fetchContainers(),e.showContainerList=!e.showContainerList}),title:e.translate("TagManager_ChooseContainer")},[Object(o["createElementVNode"])("a",qd,[zd,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.actualContainerName),1)]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",Wd,[Object(o["createVNode"])(l,{loading:e.isLoading},null,8,["loading"]),Object(o["createElementVNode"])("div",Xd,[Object(o["createElementVNode"])("ul",Kd,[Object(o["withDirectives"])(Object(o["createElementVNode"])("li",null,[Object(o["createElementVNode"])("a",{tabindex:"-1",onClick:t[0]||(t[0]=Object(o["withModifiers"])((function(){}),["prevent","stop"]))},Object(o["toDisplayString"])(e.translate("TagManager_NoContainersFound")),1)],512),[[o["vShow"],!e.isLoading&&0===e.containers.length]]),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.containers,(function(t){return Object(o["openBlock"])(),Object(o["createElementBlock"])("li",{title:"".concat(t.name," (").concat(t.idcontainer,")"),key:t.idcontainer},[Object(o["createElementVNode"])("a",{href:e.linkTo(t.idcontainer)},Object(o["toDisplayString"])(t.name)+" ("+Object(o["toDisplayString"])(t.idcontainer)+") ",9,Qd)],8,Yd)})),128))])])],512),[[o["vShow"],e.showContainerList]])],10,Jd)),[[c,{blur:e.onBlur}]])}var eu=Object(o["defineComponent"])({props:{containerName:String},components:{ActivityIndicator:r["ActivityIndicator"]},directives:{FocusAnywhereButHere:r["FocusAnywhereButHere"]},data:function(){return{containers:[],isLoading:!1,showContainerList:!1}},created:function(){setTimeout((function(){window.initTopControls()}))},methods:{fetchContainers:function(){var e=this;this.isLoading=!0,this.containers=[],r["AjaxHelper"].fetch({method:"TagManager.getContainers"}).then((function(t){e.containers=t})).finally((function(){e.isLoading=!1}))},linkTo:function(e){var t=r["MatomoUrl"].urlParsed.value.action;t&&"manageContainers"!==t||(t=this.hasWriteAccess?"dashboard":"manageTags");var n=r["MatomoUrl"].stringify(Object.assign(Object.assign({},r["MatomoUrl"].urlParsed.value),{},{idContainer:e,action:t}));return"".concat(window.location.pathname,"?").concat(n)},onBlur:function(){this.showContainerList=!1}},computed:{actualContainerName:function(){return this.containerName?Object(r["translate"])("TagManager_ContainerX",this.containerName):Object(r["translate"])("TagManager_ChooseContainer")},hasWriteAccess:function(){return r["Matomo"].hasUserCapability("tagmanager_write")}}});eu.render=Zd;var tu=eu,nu=(Object(r["createAngularJsAdapter"])({component:tu,scope:{containerName:{angularJsBind:"@?"}},directiveName:"piwikContainerSelector"}),{style:{"margin-left":"-0.75rem"}}),au=Object(o["createElementVNode"])("br",null,null,-1),iu=["href"],ru=["textContent"],ou={class:"environment"},lu={class:"name"},cu={class:"name"},su={class:"released_by"},du={class:"released_on"},uu={key:0},gu={colspan:"7"},bu={class:"loadingPiwik"},mu=Object(o["createElementVNode"])("img",{src:"plugins/Morpheus/images/loading-blue.gif"},null,-1),pu={key:1},vu={colspan:"7"},fu={class:"environment"},hu={class:"name"},ju={class:"revision"},Ou={class:"released_by"},Vu={class:"released_on"},yu={class:"date"};
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function Tu(e,t,n,a,i,r){var l=Object(o["resolveComponent"])("Field"),c=Object(o["resolveComponent"])("ActivityIndicator"),s=Object(o["resolveComponent"])("ContentBlock"),d=Object(o["resolveDirective"])("select-on-focus"),u=Object(o["resolveDirective"])("content-table");return Object(o["openBlock"])(),Object(o["createBlock"])(s,{class:"manageInstallTagCode",feature:"Tag Manager","content-title":"Install Code"},{default:Object(o["withCtx"])((function(){var n,a;return[Object(o["createElementVNode"])("div",nu,[Object(o["createVNode"])(l,{uicontrol:"select",name:"environment","model-value":e.environment,"onUpdate:modelValue":t[0]||(t[0]=function(t){e.environment=t,e.fetchInstallInstructions(e.environment)}),options:e.environments,title:e.translate("TagManager_Environment")},null,8,["model-value","options","title"])]),Object(o["createVNode"])(c,{loading:e.isLoading},null,8,["loading"]),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.installInstructions,(function(t,n){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",{key:n},[Object(o["createElementVNode"])("p",null,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(t.description)+" ",1),au,t.helpUrl?(Object(o["openBlock"])(),Object(o["createElementBlock"])("a",{key:0,target:"_blank",href:t.helpUrl},Object(o["toDisplayString"])(e.translate("TagManager_LearnMore")),9,iu)):Object(o["createCommentVNode"])("",!0)]),t.embedCode?Object(o["withDirectives"])((Object(o["openBlock"])(),Object(o["createElementBlock"])("pre",{key:0,class:"codeblock",textContent:Object(o["toDisplayString"])(t.embedCode),ref:"codeblock"},null,8,ru)),[[d,{}]]):Object(o["createCommentVNode"])("",!0)])})),128)),Object(o["createElementVNode"])("p",null,Object(o["toDisplayString"])(e.translate("TagManager_InstallCodePublishEnvironmentNote","preview"))+" "+Object(o["toDisplayString"])(e.translate("TagManager_ConfigureEnvironmentsSuperUser")),1),Object(o["createElementVNode"])("h2",null,Object(o["toDisplayString"])(e.translate("TagManager_ReleasesOverview")),1),Object(o["withDirectives"])(Object(o["createElementVNode"])("table",null,[Object(o["createElementVNode"])("thead",null,[Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("th",ou,Object(o["toDisplayString"])(e.translate("TagManager_Environment")),1),Object(o["createElementVNode"])("th",lu,Object(o["toDisplayString"])(e.translate("TagManager_VersionName")),1),Object(o["createElementVNode"])("th",cu,Object(o["toDisplayString"])(e.translate("TagManager_VersionRevision")),1),Object(o["createElementVNode"])("th",su,Object(o["toDisplayString"])(e.translate("TagManager_ReleasedBy")),1),Object(o["createElementVNode"])("th",du,Object(o["toDisplayString"])(e.translate("TagManager_ReleasedOn")),1)])]),Object(o["createElementVNode"])("tbody",null,[e.isLoading?(Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",uu,[Object(o["createElementVNode"])("td",gu,[Object(o["createElementVNode"])("span",bu,[mu,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("General_LoadingData")),1)])])])):Object(o["createCommentVNode"])("",!0),e.isLoading||0!==(null===(n=e.container)||void 0===n||null===(a=n.releases)||void 0===a?void 0:a.length)?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",pu,[Object(o["createElementVNode"])("td",vu,Object(o["toDisplayString"])(e.translate("TagManager_NoReleasesFound")),1)])),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.sortedReleases,(function(t){var n,a;return Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{key:t.idcontainerrelease},[Object(o["createElementVNode"])("td",fu,Object(o["toDisplayString"])(e.ucfirst(t.environment)),1),Object(o["createElementVNode"])("td",hu,Object(o["toDisplayString"])(null===(n=e.releaseVersions[t.idcontainerrelease])||void 0===n?void 0:n.name),1),Object(o["createElementVNode"])("td",ju,Object(o["toDisplayString"])(null===(a=e.releaseVersions[t.idcontainerrelease])||void 0===a?void 0:a.revision),1),Object(o["createElementVNode"])("td",Ou,Object(o["toDisplayString"])(t.release_login),1),Object(o["createElementVNode"])("td",Vu,[Object(o["createElementVNode"])("span",yu,Object(o["toDisplayString"])(t.release_date_pretty),1)])])})),128))])],512),[[u]])]})),_:1})}function Cu(e){return ku(e)||Eu(e)||Mu(e)||Nu()}function Nu(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Eu(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function ku(e){if(Array.isArray(e))return _u(e)}function Su(e,t){return Au(e)||Du(e,t)||Mu(e,t)||wu()}function wu(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Mu(e,t){if(e){if("string"===typeof e)return _u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_u(e,t):void 0}}function _u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function Du(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,i,r=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(a=n.next()).done);o=!0)if(r.push(a.value),t&&r.length===t)break}catch(c){l=!0,i=c}finally{try{o||null==n["return"]||n["return"]()}finally{if(l)throw i}}return r}}function Au(e){if(Array.isArray(e))return e}var Bu=window,Uu=Bu.$,Lu=Object(o["defineComponent"])({props:{idContainer:{type:String,required:!0}},components:{ContentBlock:r["ContentBlock"],Field:g["Field"],ActivityIndicator:r["ActivityIndicator"]},directives:{SelectOnFocus:r["SelectOnFocus"],ContentTable:r["ContentTable"]},data:function(){return{container:null,environments:[],environment:"live",installInstructions:[],isLoading:!1,isLoadingInstructions:!1}},created:function(){var e=this;this.isLoading=!0,this.fetchReleases().finally((function(){e.isLoading=!1}))},methods:{fetchInstallInstructions:function(e){var t=this;return this.installInstructions=[],this.isLoadingInstructions=!0,r["AjaxHelper"].fetch({method:"TagManager.getContainerInstallInstructions",filter_limit:"-1",idContainer:this.idContainer,environment:e}).then((function(e){t.installInstructions=e,Object(o["nextTick"])((function(){var e=Array.isArray(t.$refs.codeblock)?t.$refs.codeblock:[t.$refs.codeblock];e.forEach((function(e){Uu(e).effect("highlight",{},1500)}))}))})).finally((function(){t.isLoadingInstructions=!1}))},fetchReleases:function(){var e=this;return r["AjaxHelper"].fetch([{method:"TagManager.getAvailableEnvironments",filter_limit:"-1"},{method:"TagManager.getContainer",idContainer:this.idContainer,filter_limit:"-1"}]).then((function(t){var n,a,i=Su(t,2),r=i[0],o=i[1];e.environments=r.map((function(e){return{key:e.id,value:e.name}})),e.container=o;var l=o.releases.some((function(e){return"live"===e.environment}));if(!l&&null!==(n=e.environments)&&void 0!==n&&null!==(a=n[0])&&void 0!==a&&a.key?e.environment=e.environments[0].key:l||(e.environment=""),e.environment)return e.fetchInstallInstructions(e.environment)}))},ucfirst:function(e){return"".concat(e.substr(0,1).toUpperCase()).concat(e.substr(1))}},computed:{releaseVersions:function(){var e,t=this,n={};return((null===(e=this.container)||void 0===e?void 0:e.releases)||[]).forEach((function(e){n[e.idcontainerrelease]=t.container.versions.find((function(t){return t.idcontainerversion===e.idcontainerversion}))})),n},sortedReleases:function(){var e,t=Cu(((null===(e=this.container)||void 0===e?void 0:e.releases)||[]).map((function(e,t){return Object.assign(Object.assign({},e),{},{index:t})})));return t.sort((function(e,t){return e.release_date<t.release_date?1:e.release_date>t.release_date?-1:t.index-e.index})),t}}});Lu.render=Tu;var xu=Lu,Iu=(Object(r["createAngularJsAdapter"])({component:xu,scope:{idContainer:{angularJsBind:"@"}},directiveName:"piwikManageInstallTagCode"}),{class:"tagManagerTrackingCode"}),Pu={class:"row"},Fu={class:"col s12 m4 "},Hu={class:"form-group row"},$u={class:"col s12 input-field"},Gu={for:"tagManagerTrackingCodeSite",class:"siteSelectorLabel"},Ru={class:"sites_autocomplete"},Ju={class:"col s12 m4"},qu={class:"col s12 m4"},zu={key:0,class:"alert alert-info"},Wu={href:""},Xu=Object(o["createElementVNode"])("br",null,null,-1),Ku=["href"],Yu=["textContent"],Qu={key:1},Zu={key:2},eg={key:3},tg={key:0},ng=["href"],ag=Object(o["createElementVNode"])("span",{class:"icon-edit"},null,-1),ig={key:4},rg=Object(o["createElementVNode"])("br",null,null,-1),og=["href"],lg=Object(o["createElementVNode"])("span",{class:"icon-show"},null,-1);
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function cg(e,t,n,a,i,r){var l=Object(o["resolveComponent"])("ActivityIndicator"),c=Object(o["resolveComponent"])("SiteSelector"),s=Object(o["resolveComponent"])("Field"),d=Object(o["resolveDirective"])("select-on-focus");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",Iu,[Object(o["createVNode"])(l,{style:Object(o["normalizeStyle"])({opacity:e.isLoading?1:0}),loading:!0},null,8,["style"]),Object(o["createElementVNode"])("div",Pu,[Object(o["createElementVNode"])("div",Fu,[Object(o["createElementVNode"])("div",Hu,[Object(o["createElementVNode"])("div",$u,[Object(o["createElementVNode"])("label",Gu,Object(o["toDisplayString"])(e.translate("General_Website")),1),Object(o["createElementVNode"])("div",Ru,[Object(o["createVNode"])(c,{id:"tagManagerTrackingCodeSite",modelValue:e.site,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.site=t}),"show-all-sites-item":!1,"switch-site-on-select":!1,"show-selected-site":!0},null,8,["modelValue"])])])])]),Object(o["createElementVNode"])("div",Ju,[Object(o["createElementVNode"])("div",null,[Object(o["createVNode"])(s,{uicontrol:"select",name:"containers","model-value":e.idContainer,"onUpdate:modelValue":t[1]||(t[1]=function(t){e.idContainer=t,e.onContainerChange()}),options:e.containerOptions,disabled:e.containerOptions.length<=1,"full-width":!0,title:e.translate("TagManager_Container")},null,8,["model-value","options","disabled","title"])])]),Object(o["createElementVNode"])("div",qu,[Object(o["createElementVNode"])("div",null,[Object(o["createVNode"])(s,{uicontrol:"select",name:"environment","model-value":e.environment,"onUpdate:modelValue":t[2]||(t[2]=function(t){e.environment=t,e.fetchInstallInstructions()}),options:e.environments,disabled:e.environments.length<=1,"full-width":!0,title:e.translate("TagManager_Environment")},null,8,["model-value","options","disabled","title"])])])]),e.idContainer&&e.noReleaseFound?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",zu,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.translate("TagManager_NoReleasesFoundForContainer"))+" ",1),Object(o["createElementVNode"])("a",Wu,Object(o["toDisplayString"])(e.translate("TagManager_PublishVersionToEnvironmentToViewEmbedCode")),1)])):Object(o["createCommentVNode"])("",!0),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.installInstructions,(function(t,n){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",{key:n},[Object(o["createElementVNode"])("p",null,[Object(o["createTextVNode"])(Object(o["toDisplayString"])(t.description)+" ",1),Xu,t.helpUrl?(Object(o["openBlock"])(),Object(o["createElementBlock"])("a",{key:0,target:"_blank",href:t.helpUrl},Object(o["toDisplayString"])(e.translate("TagManager_LearnMore")),9,Ku)):Object(o["createCommentVNode"])("",!0)]),Object(o["withDirectives"])(Object(o["createElementVNode"])("pre",{class:"codeblock",textContent:Object(o["toDisplayString"])(t.embedCode),ref:"codeblock"},null,8,Yu),[[d,{}]])])})),128)),e.idContainer?(Object(o["openBlock"])(),Object(o["createElementBlock"])("h3",Qu,Object(o["toDisplayString"])(e.translate("TagManager_CustomizeTracking")),1)):Object(o["createCommentVNode"])("",!0),e.idContainer?(Object(o["openBlock"])(),Object(o["createElementBlock"])("p",Zu,Object(o["toDisplayString"])(e.translate("TagManager_CustomizeTrackingTeaser")),1)):Object(o["createCommentVNode"])("",!0),e.idContainer?(Object(o["openBlock"])(),Object(o["createElementBlock"])("ul",eg,[e.matomoConfigs.length?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createElementBlock"])("li",tg,Object(o["toDisplayString"])(e.translate("TagManager_NoMatomoConfigFoundForContainer")),1)),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.matomoConfigs,(function(t){return Object(o["openBlock"])(),Object(o["createElementBlock"])("li",{key:t.idvariable},[Object(o["createElementVNode"])("a",{href:e.linkTo("manageVariables",e.idContainer,{idVariable:t.idvariable})},[ag,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(t.name),1)],8,ng)])})),128))])):Object(o["createCommentVNode"])("",!0),e.idContainer?(Object(o["openBlock"])(),Object(o["createElementBlock"])("p",ig,[rg,Object(o["createElementVNode"])("a",{href:e.linkTo("dashboard",e.idContainer)},[lg,Object(o["createTextVNode"])(" "+Object(o["toDisplayString"])(e.translate("TagManager_ViewContainerDashboard")),1)],8,og)])):Object(o["createCommentVNode"])("",!0)])}function sg(e){return"".concat(e.substr(0,1).toUpperCase()).concat(e.substr(1))}var dg=Object(o["defineComponent"])({props:{},components:{ActivityIndicator:r["ActivityIndicator"],SiteSelector:r["SiteSelector"],Field:g["Field"]},directives:{SelectOnFocus:r["SelectOnFocus"]},data:function(){return{containerVariables:[],isLoading:!1,idContainer:"",environment:"",environments:[],environmentNameMap:{},containerMap:{},containerOptions:[],site:{id:r["Matomo"].idSite,name:r["Matomo"].helper.htmlDecode(r["Matomo"].siteName)},matomoConfigs:[],releases:[],installInstructions:[],noReleaseFound:!1}},created:function(){var e=this;r["AjaxHelper"].fetch({method:"TagManager.getAvailableEnvironments",filter_limit:"-1"}).then((function(t){var n;n=Array.isArray(t)?t:Object.values(t),e.environmentNameMap=Object.fromEntries(n.map((function(e){var t=e.id,n=e.name;return[t,n]})))})),this.onSiteChange()},watch:{site:function(){this.onSiteChange()}},methods:{onSiteChange:function(){var e,t=this;this.installInstructions=[],this.containerOptions=[],this.containerMap={},this.environments=[],this.matomoConfigs=[],this.idContainer="",null!==(e=this.site)&&void 0!==e&&e.id&&(this.isLoading=!0,r["AjaxHelper"].fetch({method:"TagManager.getContainers",filter_limit:"-1",idSite:this.site.id}).then((function(e){if(t.containerOptions=[],null===e||void 0===e||!e.length)return t.idContainer="",void t.containerOptions.push({key:"",value:t.translate("TagManager_NoContainersFound")});e.forEach((function(e){t.idContainer||(t.idContainer=e.idcontainer),t.containerMap[e.idcontainer]=e,t.containerOptions.push({key:e.idcontainer,value:e.name})})),t.onContainerChange()})).finally((function(){t.isLoading=!1})))},onContainerChange:function(){var e=this;if(this.noReleaseFound=!1,this.idContainer){this.installInstructions=[];var t=this.containerMap[this.idContainer],n=t.draft.idcontainerversion;this.environment="",this.environments=[];var a=t.releases||[];a.find((function(e){return"live"===e.environment}))&&(this.environment="live"),a.forEach((function(t){if("preview"!==t.environment){e.environment||(e.environment=t.environment);var n=sg(t.environment);t.environment in e.environmentNameMap&&(n=e.environmentNameMap[t.environment]),e.environments.push({key:t.environment,value:n})}})),this.environments.length||(this.noReleaseFound=!0,this.environments.push({key:"",value:this.translate("TagManager_NoReleasesFound")})),this.fetchInstallInstructions(),this.fetchVariables(n)}},linkTo:function(e,t,n){var a=r["MatomoUrl"].stringify(Object.assign(Object.assign({},r["MatomoUrl"].urlParsed.value),{},{module:"TagManager",action:e,idContainer:t})),i="".concat(window.location.pathname,"?").concat(a);return n&&(i+="#?".concat(r["MatomoUrl"].stringify(n))),i},fetchInstallInstructions:function(){var e,t=this;this.installInstructions=[],this.idContainer&&this.environment&&null!==(e=this.site)&&void 0!==e&&e.id&&(this.isLoading=!0,r["AjaxHelper"].fetch({method:"TagManager.getContainerInstallInstructions",filter_limit:"-1",idContainer:this.idContainer,environment:this.environment,idSite:this.site.id}).then((function(e){t.installInstructions=e,Object(o["nextTick"])((function(){var e=Array.isArray(t.$refs.codeblock)?t.$refs.codeblock:[t.$refs.codeblock];e.forEach((function(e){$(e).effect("highlight",{},1500)}))}))})).finally((function(){t.isLoading=!1})))},fetchVariables:function(e){var t,n=this;this.matomoConfigs=[],this.idContainer&&null!==(t=this.site)&&void 0!==t&&t.id&&e&&r["AjaxHelper"].fetch({method:"TagManager.getContainerVariables",filter_limit:"-1",idContainer:this.idContainer,idContainerVersion:e,idSite:this.site.id}).then((function(e){n.matomoConfigs=e.filter((function(e){return"MatomoConfiguration"===e.type}))})).finally((function(){n.isLoading=!1}))}}});dg.render=cg;var ug=dg,gg=(Object(r["createAngularJsAdapter"])({component:ug,directiveName:"matomoTagmanagerTrackingCode"}),{class:"fieldVariableTemplate"}),bg=["type","id","name","value"],mg=["title"],pg=["for","innerHTML"];
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */function vg(e,t,n,a,i,r){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",gg,[Object(o["createElementVNode"])("textarea",Object(o["mergeProps"])({class:"control_".concat(e.uiControl," materialize-textarea"),type:e.uiControl,id:e.name,name:e.name,value:e.modelValue,onKeydown:t[0]||(t[0]=function(t){return e.onKeydown(t)}),onChange:t[1]||(t[1]=function(t){return e.onKeydown(t)}),placeholder:"",style:{width:"calc(100% - 40px)"}},e.uiControlAttributes,{ref:"textarea"}),null,16,bg),Object(o["createElementVNode"])("span",{class:"icon-code",style:{"margin-top":"14px",position:"absolute"},title:e.translate("TagManager_ChooseVariable"),onClick:t[2]||(t[2]=function(t){return e.selectVariable()})},null,8,mg),Object(o["createElementVNode"])("label",{for:e.name,innerHTML:e.$sanitize(e.title)},null,8,pg)])}var fg=window,hg=fg.tagManagerHelper,jg=Object(o["defineComponent"])({props:{name:String,uiControlAttributes:Object,modelValue:String,title:String,uiControl:{type:String,required:!0}},inheritAttrs:!1,emits:["update:modelValue"],created:function(){this.onKeydown=Object(r["debounce"])(this.onKeydown.bind(this),50)},methods:{onKeydown:function(e){this.$emit("update:modelValue",e.target.value)},selectVariable:function(){var e=this;hg.selectVariable((function(t){hg.insertTextSnippetAtElement(e.$refs.textarea,"{{".concat(t.id,"}}"))}))}},watch:{modelValue:function(){var e=this,t=window,n=t.Materialize;setTimeout((function(){n.textareaAutoResize(e.$refs.textarea),n.updateTextFields()}))}},mounted:function(){var e=this,t=window,n=t.Materialize;setTimeout((function(){n.textareaAutoResize(e.$refs.textarea),n.updateTextFields()}))}});jg.render=vg;var Og=jg,Vg={class:"fieldVariableTemplate"},yg=["type","id","name","value"],Tg=["title"],Cg=Object(o["createElementVNode"])("br",null,null,-1),Ng=["for","innerHTML"];function Eg(e,t,n,a,i,r){return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",Vg,[Object(o["createElementVNode"])("input",Object(o["mergeProps"])({class:"control_".concat(e.uiControl),type:e.uiControl,id:e.name,name:e.name,value:e.modelValueText,onKeydown:t[0]||(t[0]=function(t){return e.onKeydown(t)}),onChange:t[1]||(t[1]=function(t){return e.onKeydown(t)}),placeholder:"",style:{width:"calc(100% - 40px)"}},e.uiControlAttributes,{ref:"input"}),null,16,yg),Object(o["createElementVNode"])("span",{class:"icon-code",title:e.translate("TagManager_ChooseVariable"),onClick:t[2]||(t[2]=function(t){return e.selectVariable()})},null,8,Tg),Cg,Object(o["createElementVNode"])("label",{for:e.name,innerHTML:e.$sanitize(e.title)},null,8,Ng)])}var kg=window,Sg=kg.tagManagerHelper,wg=Object(o["defineComponent"])({props:{uiControl:{type:String,required:!0},uiControlAttributes:Object,name:String,title:String,modelValue:null},inheritAttrs:!1,emits:["update:modelValue"],computed:{modelValueText:function(){return"undefined"===typeof this.modelValue||null===this.modelValue?"":this.modelValue.toString()}},created:function(){this.onKeydown=Object(r["debounce"])(this.onKeydown.bind(this),50)},mounted:function(){setTimeout((function(){window.Materialize.updateTextFields()}))},watch:{modelValue:function(){setTimeout((function(){window.Materialize.updateTextFields()}))}},methods:{onKeydown:function(e){this.$emit("update:modelValue",e.target.value)},selectVariable:function(){var e=this;Sg.selectVariable((function(t){Sg.insertTextSnippetAtElement(e.$refs.input,"{{".concat(t.id,"}}"))}))}}});wg.render=Eg;var Mg=wg,_g=["for","innerHTML"];function Dg(e,t,n,a,i,r){var l=Object(o["resolveComponent"])("VariableSelectType");return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",null,[Object(o["createVNode"])(l,{"model-value":e.modelValue,id:e.name,name:e.name,"variable-type-name":e.title,"variable-type":e.uiControlAttributes.variableType,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.$emit("update:modelValue",t)})},null,8,["model-value","id","name","variable-type-name","variable-type"]),Object(o["createElementVNode"])("label",{for:e.name,style:{"font-size":"0.8rem"},innerHTML:e.$sanitize(e.title)},null,8,_g)])}var Ag=Object(o["defineComponent"])({props:{uiControlAttributes:{type:Object,required:!0},name:String,title:String,modelValue:String},components:{VariableSelectType:ne},emits:["update:modelValue"]});Ag.render=Dg;var Bg,Ug,Lg=Ag,xg={class:"nav-wrapper"},Ig={class:"pull-right"},Pg=Object(o["createElementVNode"])("svg",{"aria-hidden":"true",style:{position:"absolute",width:"0",height:"0",overflow:"hidden"},version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink"},[Object(o["createElementVNode"])("defs",null,[Object(o["createElementVNode"])("symbol",{id:"tm-icon-checkmark",viewBox:"0 0 32 32"},[Object(o["createElementVNode"])("path",{d:"M27 4l-15 15-7-7-5 5 12 12 20-20z"})])])],-1),Fg={class:"page",style:{clear:"both"}},Hg={key:0,id:"secondNavBar",class:"Menu--dashboard z-depth-1"},$g={class:"navbar",role:"menu",style:{padding:"0"}},Gg={class:"menuTab",role:"menuitem"},Rg={class:"item",style:{"font-weight":"normal"}},Jg=Object(o["createTextVNode"])(" Events "),qg={key:0},zg=Object(o["createElementVNode"])("br",null,null,-1),Wg=Object(o["createElementVNode"])("br",null,null,-1),Xg=Object(o["createElementVNode"])("label",{for:"onlyfiredTags",class:"lbl-onlyfiredTags"},"Only fired tags",-1),Kg={key:0,style:{padding:"0 0 1rem 1.2rem"}},Yg=["onClick","title"],Qg={title:"This tag was fired"},Zg=Object(o["createElementVNode"])("svg",{class:"tm-icon tm-icon-checkmark"},[Object(o["createElementVNode"])("use",{"xlink:href":"#tm-icon-checkmark"})],-1),eb=[Zg],tb={class:"pageWrap"},nb={class:"home",id:"content"},ab=Object(o["createElementVNode"])("h3",null,"Fired Tags",-1),ib={class:"entityTable"},rb=Object(o["createElementVNode"])("thead",null,[Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("th",null,"Action"),Object(o["createElementVNode"])("th",null,"Name"),Object(o["createElementVNode"])("th",null,"Type"),Object(o["createElementVNode"])("th",null,"Fired count")])],-1),ob={key:0},lb=Object(o["createElementVNode"])("td",{colspan:"4"},"No tags",-1),cb=[lb],sb=Object(o["createElementVNode"])("h3",{style:{"margin-top":"30px"}},"Not Yet Fired Tags",-1),db={class:"entityTable"},ub=Object(o["createElementVNode"])("thead",null,[Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("th",null,"Name"),Object(o["createElementVNode"])("th",null,"Type")])],-1),gb=Object(o["createElementVNode"])("td",{colspan:"4"},"No tags",-1),bb=[gb],mb=Object(o["createElementVNode"])("h3",null,"Triggers",-1),pb={class:"entityTable"},vb=Object(o["createElementVNode"])("thead",null,[Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("th",null,"Name"),Object(o["createElementVNode"])("th",null,"Type")])],-1),fb={key:0},hb=Object(o["createElementVNode"])("td",{colspan:"4"},"No trigger",-1),jb=[hb],Ob={key:1},Vb=Object(o["createElementVNode"])("h3",null,"Pushed data by this event",-1),yb={class:"entityTable"},Tb={style:{"word-break":"break-all"}},Cb=Object(o["createElementVNode"])("br",null,null,-1),Nb=Object(o["createElementVNode"])("h3",null,"Content after this event",-1),Eb={class:"entityTable"},kb={style:{"word-break":"break-all"}},Sb={class:"entityTable"},wb=Object(o["createElementVNode"])("thead",null,[Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("th",null,"Name"),Object(o["createElementVNode"])("th",null,"Type"),Object(o["createElementVNode"])("th",null,"Value")])],-1),Mb={key:0},_b=Object(o["createElementVNode"])("td",{colspan:"3"},"No variables",-1),Db=[_b],Ab={style:{"word-break":"break-all"}},Bb={class:"entityTable"},Ub=Object(o["createElementVNode"])("thead",null,[Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("th",null,"Time"),Object(o["createElementVNode"])("th",null,"Message")])],-1),Lb={style:{"word-break":"break-all"}},xb=Object(o["createElementVNode"])("br",null,null,-1);function Ib(e,t,n,a,i,r){var l,c,s,d,u,g,b,m,p,v;return Object(o["openBlock"])(),Object(o["createElementBlock"])("div",null,[Object(o["createElementVNode"])("nav",null,[Object(o["createElementVNode"])("div",xg,[Object(o["createElementVNode"])("ul",null,[Object(o["createElementVNode"])("li",null,[Object(o["renderSlot"])(e.$slots,"logo")]),Object(o["createElementVNode"])("li",{class:Object(o["normalizeClass"])({active:"tags"===e.contentTab||!e.contentTab})},[Object(o["createElementVNode"])("a",{onClick:t[0]||(t[0]=function(t){return e.contentTab="tags"})},"Tags")],2),Object(o["createElementVNode"])("li",{class:Object(o["normalizeClass"])({active:"triggers"===e.contentTab})},[Object(o["createElementVNode"])("a",{onClick:t[1]||(t[1]=function(t){return e.contentTab="triggers"})},"Triggers")],2),Object(o["createElementVNode"])("li",{class:Object(o["normalizeClass"])({active:"variables"===e.contentTab})},[Object(o["createElementVNode"])("a",{onClick:t[2]||(t[2]=function(t){return e.contentTab="variables"})},"Variables")],2),Object(o["createElementVNode"])("li",{class:Object(o["normalizeClass"])({active:"dataLayer"===e.contentTab})},[Object(o["createElementVNode"])("a",{onClick:t[3]||(t[3]=function(t){return e.contentTab="dataLayer"})},"Data Layer")],2),Object(o["createElementVNode"])("li",{class:Object(o["normalizeClass"])({active:"logs"===e.contentTab})},[Object(o["createElementVNode"])("a",{onClick:t[4]||(t[4]=function(t){return e.contentTab="logs"})},"Logs")],2),Object(o["createElementVNode"])("li",Ig,[Object(o["createElementVNode"])("a",{id:"mtmUpdateDebugPosition",onClick:t[5]||(t[5]=function(t){return e.mtmUpdateDebugPosition()})},Object(o["toDisplayString"])(e.positionText),1)])])])]),Pg,Object(o["createElementVNode"])("div",Fg,["logs"!==e.contentTab?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",Hg,[Object(o["createElementVNode"])("ul",$g,[Object(o["createElementVNode"])("li",Gg,[Object(o["createElementVNode"])("span",Rg,[Jg,e.mtmEvents.length>0?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",qg,[zg,Wg,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"checkbox",class:"onlyFiredTags-chk",name:"onlyfiredTags",id:"onlyfiredTags",value:"1","onUpdate:modelValue":t[6]||(t[6]=function(t){return e.onlyfiredTags=t}),style:{"margin-right":"3.5px"}},null,512),[[o["vModelCheckbox"],e.onlyfiredTags]]),Xg])):Object(o["createCommentVNode"])("",!0)])]),0===e.mtmEvents.length?(Object(o["openBlock"])(),Object(o["createElementBlock"])("li",Kg,"No event executed")):Object(o["createCommentVNode"])("",!0),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.mtmEventsReversed,(function(t,n){var a,i;return Object(o["openBlock"])(),Object(o["createElementBlock"])("li",{class:Object(o["normalizeClass"])(["menuTab",{active:n===e.selectedEventIndex}]),role:"menuitem",key:n},[(t.tags||[]).length||!e.onlyfiredTags?(Object(o["openBlock"])(),Object(o["createElementBlock"])("a",{key:0,class:"item",onClick:function(n){return e.selectEvent(t.index0)},title:"Time: ".concat(t.time,". Trigger: ").concat(null===(a=t.metTrigger)||void 0===a?void 0:a.name)},[Object(o["createTextVNode"])(Object(o["toDisplayString"])(t.index)+": "+Object(o["toDisplayString"])(t.name)+" ",1),Object(o["withDirectives"])(Object(o["createElementVNode"])("span",Qg,eb,512),[[o["vShow"],null===(i=t.tags)||void 0===i?void 0:i.length]])],8,Yg)):Object(o["createCommentVNode"])("",!0)],2)})),128))])])):Object(o["createCommentVNode"])("",!0),Object(o["createElementVNode"])("div",tb,[Object(o["createElementVNode"])("div",nb,[Object(o["withDirectives"])(Object(o["createElementVNode"])("h2",null,Object(o["toDisplayString"])(e.homeTabTitle),513),[[o["vShow"],"logs"!==e.contentTab]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",null,[ab,Object(o["createElementVNode"])("table",ib,[rb,Object(o["createElementVNode"])("tbody",null,[null!==(l=e.selectedEvent)&&void 0!==l&&null!==(c=l.tags)&&void 0!==c&&c.length?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",ob,cb)),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])((null===(s=e.selectedEvent)||void 0===s?void 0:s.tags)||[],(function(e,t){return Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{key:t},[Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.action),1),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.name),1),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.type),1),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.numExecuted),1)])})),128))])]),sb,Object(o["createElementVNode"])("table",db,[ub,Object(o["createElementVNode"])("tbody",null,[Object(o["withDirectives"])(Object(o["createElementVNode"])("tr",null,bb,512),[[o["vShow"],0===e.notFiredTags.length]]),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.notFiredTags,(function(e,t){return Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{key:t},[Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.name),1),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.type),1)])})),128))])])],512),[[o["vShow"],"tags"===e.contentTab||!e.contentTab]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",null,[mb,Object(o["createElementVNode"])("table",pb,[vb,Object(o["createElementVNode"])("tbody",null,[null!==(d=e.selectedEvent)&&void 0!==d&&d.metTrigger?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",fb,jb)),null!==(u=e.selectedEvent)&&void 0!==u&&u.metTrigger?(Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",Ob,[Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.selectedEvent.metTrigger.name),1),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.selectedEvent.metTrigger.type),1)])):Object(o["createCommentVNode"])("",!0)])])],512),[[o["vShow"],"triggers"===e.contentTab]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",null,[Vb,Object(o["createElementVNode"])("table",yb,[Object(o["createElementVNode"])("tbody",null,[Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("td",Tb,Object(o["toDisplayString"])(e.selectedEventData),1)])])]),Cb,Nb,Object(o["createElementVNode"])("table",Eb,[Object(o["createElementVNode"])("tbody",null,[Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("td",kb,Object(o["toDisplayString"])(e.selectedEventContainerDataLayer),1)])])])],512),[[o["vShow"],"dataLayer"===e.contentTab]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",null,[Object(o["createElementVNode"])("table",Sb,[wb,Object(o["createElementVNode"])("tbody",null,[null!==(g=e.selectedEvent)&&void 0!==g&&null!==(b=g.container)&&void 0!==b&&null!==(m=b.variables)&&void 0!==m&&m.length?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",Mb,Db)),(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])((null===(p=e.selectedEvent)||void 0===p||null===(v=p.container)||void 0===v?void 0:v.variables)||[],(function(t,n){return Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{key:n},[Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(t.name),1),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(t.type),1),Object(o["createElementVNode"])("td",Ab,Object(o["toDisplayString"])(e.stringifySelectedVariable(t)),1)])})),128))])])],512),[[o["vShow"],"variables"===e.contentTab]]),Object(o["withDirectives"])(Object(o["createElementVNode"])("div",null,[Object(o["createElementVNode"])("table",Bb,[Ub,Object(o["createElementVNode"])("tbody",null,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.mtmLogs,(function(e,t){return Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{key:t},[Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.time),1),Object(o["createElementVNode"])("td",Lb,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(e.messages,(function(e,t){return Object(o["openBlock"])(),Object(o["createElementBlock"])("span",{key:t},[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e),1),xb])})),128))])])})),128))])])],512),[[o["vShow"],"logs"===e.contentTab]])])])])])}function Pb(e){return Gb(e)||$b(e)||Hb(e)||Fb()}function Fb(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Hb(e,t){if(e){if("string"===typeof e)return Rb(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Rb(e,t):void 0}}function $b(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function Gb(e){if(Array.isArray(e))return Rb(e)}function Rb(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function Jb(e){return Jb="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jb(e)}window.mtmDbgData=Object(o["reactive"])({mtmEvents:(null===(Bg=window.mtmDbgData)||void 0===Bg?void 0:Bg.mtmEvents)||[],mtmLogs:(null===(Ug=window.mtmDbgData)||void 0===Ug?void 0:Ug.mtmLogs)||[]});var qb="mtmPreviewPosition",zb="Stick to Top",Wb="Stick to Bottom";function Xb(){var e=new WeakSet;function t(t,n){if("object"===Jb(n)&&null!==n){if(e.has(n))return"";e.add(n)}return n}return t}var Kb=Object(o["defineComponent"])({data:function(){return{contentTab:"tags",selectedEventIndex:0,onlyfiredTags:!1,positionText:"top"===Object(r["getCookie"])(qb)?Wb:zb}},methods:{mtmUpdateDebugPosition:function(){var e=6048e5,t=Object(r["getCookie"])(qb),n="top"===t?"bottom":"top";Object(r["setCookie"])(qb,n,e);var a=window.parent.document.getElementById("mtmDebugFrame");"top"===n?(this.positionText=Wb,a.classList.remove("mtmStickyBottom"),a.classList.add("mtmStickyTop")):(this.positionText=zb,a.classList.remove("mtmStickyTop"),a.classList.add("mtmStickyBottom"))},selectEvent:function(e){this.mtmEvents[e]&&(this.selectedEventIndex=e)},stringifySelectedVariable:function(e){return JSON.stringify(e.value,Xb())}},computed:{homeTabTitle:function(){var e;if(null===(e=this.selectedEvent)||void 0===e||!e.container)return"";var t=this.selectedEvent.container.versionName||"Draft version",n=this.selectedEvent.container.id,a=this.selectedEventIndex+1;return"Event ".concat(a,": ").concat(this.selectedEvent.name," (").concat(n," - ").concat(t,")")},notFiredTags:function(){var e;if(null===(e=this.selectedEvent)||void 0===e||!e.container)return[];var t=this.selectedEventIndex,n=[];this.mtmEvents.forEach((function(e,a){a>t||n.push.apply(n,Pb(e.tags.map((function(e){return e.name}))))}));var a=[];return this.selectedEvent.container.tags.forEach((function(e){-1===n.indexOf(e.name)&&a.push(e)})),a},selectedEvent:function(){return this.mtmEvents[this.selectedEventIndex]},mtmEvents:function(){return window.mtmDbgData.mtmEvents},mtmEventsReversed:function(){var e=Pb(this.mtmEvents);return e.reverse(),e},mtmLogs:function(){return window.mtmDbgData.mtmLogs},selectedEventData:function(){var e;return(null===(e=this.selectedEvent)||void 0===e?void 0:e.eventData)&&JSON.stringify(this.selectedEvent.eventData,Xb())},selectedEventContainerDataLayer:function(){var e,t;return(null===(e=this.selectedEvent)||void 0===e||null===(t=e.container)||void 0===t?void 0:t.dataLayer)&&JSON.stringify(this.selectedEvent.container.dataLayer,Xb())}}});Kb.render=Ib;var Yb=Kb;
/*!
 * Matomo - free/libre analytics platform
 *
 * @link https://matomo.org
 * @license http://www.gnu.org/licenses/gpl-3.0.html GPL v3 or later
 */}})}));
//# 